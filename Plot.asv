data_temp = load('temp.mat');

X = data_temp.VF_GenWT7;
Y = data_temp.VF_GenWT10;
Z = data_temp.VF_GenASL;
clear('data_temp')

Data1 = load('VF_GenWT7(Beforepassingkernelres32makima).mat');
VF_GenWT7 = Data1.VF_GenWT7;
clear('Data1')

Data2 = load('VF_PIVWT7.mat');
VF_PIVWT7 = Data2.VF_PIVWT7;
clear('Data2')

Data3 = load('VF_HotWT7.mat');
VF_HotWT7 = Data3.VF_HotWT7;
clear('Data3')

Data4 = load('VF_GenWT10(Beforepassingkernelres25makima).mat');
VF_GenWT10 = Data4.VF_GenWT10;
clear('Data4')

Data5 = load('VF_PIVWT10.mat');
VF_PIVWT10 = Data5.VF_PIVWT10;
clear('Data5')

Data6 = load('VF_HotWT10.mat');
VF_HotWT10 = Data6.VF_HotWT10;
clear('Data6')

Data7 = load('VF_GenASL(Beforepassingkernelres20makima).mat');
VF_GenASL = Data7.VF_GenASL;
clear('Data7')

Data8 = load('VF_SLPIVASL.mat');
VF_SLPIVASL = Data8.VF_SLPIVASL;
clear('Data8')

Data9 = load('VF_SonicASL.mat');
VF_SonicASL = Data9.VF_SonicASL;
clear('Data9')

% Data10 = load('VF_GenASL(Stogen).mat');
% VF_GenASL = Data10.VF_GenASL;
% clear('Data10')


%% Calculating lambda_T WT & ASL
lambda_T_WT7 = zeros(size(VF_HotWT7.uprime, 1), 1);
eta_WT7 = zeros(size(VF_HotWT7.uprime, 1), 1);

for i = 1:size(VF_HotWT7.uprime, 1)

    current_row_epsilon = mean([VF_HotWT7.epsilon_str{i, :}{:}],2);
    
    lambda_T_WT7(i) = rms(VF_HotWT7.uprime(i,:),2)*sqrt(15*VF_HotWT7.nu/current_row_epsilon);
    eta_WT7(i)= (VF_HotWT7.nu^3/current_row_epsilon)^0.25;
end

% plot(lambda_T_WT7,VF_HotWT7.z)

lambda_T_WT10 = zeros(size(VF_HotWT10.uprime, 1), 1);
eta_WT10 = zeros(size(VF_HotWT10.uprime, 1), 1);

for i = 1:size(VF_HotWT10.uprime, 1)

    current_row_epsilon = mean([VF_HotWT10.epsilon_str{i, :}{:}],2);
    
    lambda_T_WT10(i) = rms(VF_HotWT10.uprime(i,:),2)*sqrt(15*VF_HotWT10.nu/current_row_epsilon);
    eta_WT10(i)= (VF_HotWT10.nu^3/current_row_epsilon)^0.25;
end


% current_row_epsilon_SonicASL = mean([VF_SonicASL.epsilon_str{1, :}{:}],2);
current_row_epsilon_SonicASL = VF_SonicASL.epsilon_spec;
lambda_T_ASL = rms(VF_SonicASL.uprime(:,1),1)*sqrt(15*VF_SonicASL.nu/current_row_epsilon_SonicASL);
eta_ASL = (VF_SonicASL.nu^3/current_row_epsilon_SonicASL)^0.25;

%% Calculating lambda_T(Gen). 
lambda_T_WT7Gen = zeros(size(VF_GenWT7.z, 1), 1);
eta_WT7Gen = zeros(size(VF_GenWT7.z, 1), 1);

for i = 1:size(VF_GenWT7.z, 1)

    current_row_epsilon = mean(VF_GenWT7.epsilon_str(i,:),2);
%     current_row_epsilon = VF_GenWT7.epsilon_spec(1,i); 
    lambda_T_WT7Gen(i) = mean(rms(VF_GenWT7.uprime(i,:,:),3),2)*sqrt(15*VF_GenWT7.nu/current_row_epsilon);
    eta_WT7Gen(i)= (VF_GenWT7.nu^3/current_row_epsilon)^0.25;
end


lambda_T_WT10Gen = zeros(size(VF_GenWT10.z, 1), 1);
eta_WT10Gen = zeros(size(VF_GenWT10.z, 1), 1);

for i = 1:size(VF_GenWT10.z, 1)

%     current_row_epsilon = mean(VF_GenWT10.epsilon_str(i,:),2);
    current_row_epsilon = VF_GenWT10.epsilon_spec(1,i);
    lambda_T_WT10Gen(i) = mean(rms(VF_GenWT10.uprime(i,:,:),3),2)*sqrt(15*VF_GenWT10.nu/current_row_epsilon);
    eta_WT10Gen(i)= (VF_GenWT10.nu^3/current_row_epsilon)^0.25;
end


lambda_T_ASLGen = zeros(size(VF_GenASL.z, 1), 1);
eta_ASLGen = zeros(size(VF_GenASL.z, 1), 1);

for i = 1:size(VF_GenASL.z, 1)

%     current_row_epsilon = mean(VF_GenASL.epsilon_str(i,:),2);
    current_row_epsilon = VF_GenASL.epsilon_spec(1,i);
    lambda_T_ASLGen(i) = mean(rms(VF_GenASL.uprime(i,:,:),3),2)*sqrt(15*VF_GenASL.nu/current_row_epsilon);
    eta_ASLGen(i)= (VF_GenASL.nu^3/current_row_epsilon)^0.25;
end
%% Contour plot VF(LRGen)
concat_u = reshape(VF_GenWT7.HRVFu,size(VF_GenWT7.HRVFu, 1), []);
res = VF_GenWT7.HRVFx(2)-VF_GenWT7.HRVFx(1);
concat_x = res*(0:1:size(concat_u,2));
figure
set(gcf,'Position',[745,754,969,388])
axes('Position',[0.06811145510836,0.12975944636204,0.87203302373581,0.800652924771981])
% Snshot = 10;
% Convvel = 3.0;
index_min = find(concat_x/VF_GenWT7.delta >= 1, 1);
index_max = find(concat_x/VF_GenWT7.delta >= 11, 1);
contourf((concat_x(1,index_min:index_max+1)-concat_x(1,index_min))/VF_GenWT7.delta,...
    VF_GenWT7.z/VF_GenWT7.delta...
    ,concat_u(:,index_min:index_max+1)/VF_GenWT7.u_tau,...10000:11539%%17001:18540
    50,'LineStyle','none',...
    'LineColor','none','EdgeColor','none');
% hold on
% quiver(VF_GenWT7.HRVFx(1:7:index)/VF_GenWT7.delta,...
%     VF_GenWT7.z(1:7:end)/VF_GenWT7.delta...
%     ,VF_GenWT7.HRVFu(1:7:end,1:7:index,Snshot)-Convvel,...
%     VF_GenWT7.HRVFw(1:7:end,1:7:index,Snshot),3,'color',[1.00,0.00,0.00],...
%     'MaxHeadSize',0.2,'LineWidth',1.5);

% 
% contourf(VF_GenWT7.HRVFx(:,1:index)/VF_GenWT7.Delx,...
%     VF_GenWT7.z/VF_GenWT7.delta...
%     ,VF_GenWT7.HRVFuprime(:,1:index,Snshot),...10000:11539%%17001:18540
%     50,'LineStyle','none',...
%     'LineColor','none','EdgeColor','none');
% hold on
% quiver(VF_GenWT7.HRVFx(1:7:index)/VF_GenWT7.Delx,...
%     VF_GenWT7.z(1:7:end)/VF_GenWT7.delta...
%     ,VF_GenWT7.HRVFu(1:7:end,1:7:index,Snshot)-Convvel,...
%     VF_GenWT7.HRVFw(1:7:end,1:7:index,Snshot),3,'color',[1.00,0.00,0.00],...
%     'MaxHeadSize',0.2,'LineWidth',1.5);


cmap2 = plasma(10);
% cmap2 = crameri('turku',100);
% cmap2 = getPyPlot_cMap('inferno_r', [], [],...
%     '"C:\Users\ehsan010\Anaconda3\envs\Matlabpy\python.exe"');
cmap2 = flip(cmap2);
% colormap(gca,cmap2)
C2=cmap2;
% C3=[0,0,0;C2;1,1,1];
C3=[1,1,1;C2;0,0,0];
caxis([7.5 18])
% C3 = flip(C3);
colormap(gca,C3)
hcb2=colorbar;
hcb2.Position=[0.956312362101529,0.128865979381443,0.022015823873409,0.801546391752577];
title(hcb2,'u$_{m}$','Interpreter','Latex','FontSize',15)...,'Position',...
%     [4.999994333833513,142.5300008152491,0]);
hcb2.TickLabelInterpreter = 'latex';
hcb2.TickLength = 0;
hcb2.Label.Interpreter = 'latex';
hcb2.AxisLocation='out';
set(gca,'TickLabelInterpreter','latex','FontSize',13)
% xlabel('x/$\delta$','Interpreter','Latex','FontSize',14);
xlabel('x/$\delta$','Interpreter','Latex','FontSize',14);
ylabel('z/$\delta$','Interpreter','Latex','FontSize',14);
% axis equal
% xlim([0.0 0.3])
% xlim([15 25])
ylim([VF_GenWT7.z(1)/VF_GenWT7.delta VF_GenWT7.z(end)/VF_GenWT7.delta])

%% Contour plot VF(Gen)

figure
set(gcf,'Position',[745,754,969,388])
axes('Position',[0.06811145510836,0.12975944636204,0.87203302373581,0.800652924771981])
Snshot = 10;
Convvel = 3.0;
index = find(VF_GenWT7.HRVFx/VF_GenWT7.delta >= 1.0, 1);
contourf(VF_GenWT7.HRVFx(:,1:index)/VF_GenWT7.delta,...
    VF_GenWT7.z/VF_GenWT7.delta...
    ,VF_GenWT7.HRVFu(:,1:index,Snshot),...10000:11539%%17001:18540
    50,'LineStyle','none',...
    'LineColor','none','EdgeColor','none');
hold on
quiver(VF_GenWT7.HRVFx(1:7:index)/VF_GenWT7.delta,...
    VF_GenWT7.z(1:7:end)/VF_GenWT7.delta...
    ,VF_GenWT7.HRVFu(1:7:end,1:7:index,Snshot)-Convvel,...
    VF_GenWT7.HRVFw(1:7:end,1:7:index,Snshot),3,'color',[1.00,0.00,0.00],...
    'MaxHeadSize',0.2,'LineWidth',1.5);

% 
% contourf(VF_GenWT7.HRVFx(:,1:index)/VF_GenWT7.Delx,...
%     VF_GenWT7.z/VF_GenWT7.delta...
%     ,VF_GenWT7.HRVFuprime(:,1:index,Snshot),...10000:11539%%17001:18540
%     50,'LineStyle','none',...
%     'LineColor','none','EdgeColor','none');
% hold on
% quiver(VF_GenWT7.HRVFx(1:7:index)/VF_GenWT7.Delx,...
%     VF_GenWT7.z(1:7:end)/VF_GenWT7.delta...
%     ,VF_GenWT7.HRVFu(1:7:end,1:7:index,Snshot)-Convvel,...
%     VF_GenWT7.HRVFw(1:7:end,1:7:index,Snshot),3,'color',[1.00,0.00,0.00],...
%     'MaxHeadSize',0.2,'LineWidth',1.5);


% cmap2 = plasma(100);
cmap2 = crameri('turku',100);
% cmap2 = getPyPlot_cMap('ocean', [], [],...
%     '"C:\Users\ehsan010\Anaconda3\envs\Matlabpy\python.exe"');
cmap2 = flip(cmap2);
colormap(gca,cmap2)
% C2=cmap2;
% C3=[0,0,0;C2;1,1,1];
caxis([1 6])
% C3 = flip(C3);
% colormap(gca,C3)
hcb2=colorbar;
hcb2.Position=[0.956312362101529,0.128865979381443,0.022015823873409,0.801546391752577];
title(hcb2,'u$_{m}$','Interpreter','Latex','FontSize',15)...,'Position',...
%     [4.999994333833513,142.5300008152491,0]);
hcb2.TickLabelInterpreter = 'latex';
hcb2.TickLength = 0;
hcb2.Label.Interpreter = 'latex';
hcb2.AxisLocation='out';
set(gca,'TickLabelInterpreter','latex','FontSize',13)
% xlabel('x/$\delta$','Interpreter','Latex','FontSize',14);
xlabel('x/$\lambda_{T}$','Interpreter','Latex','FontSize',14);
ylabel('z/$\delta$','Interpreter','Latex','FontSize',14);
% axis equal
% xlim([0.0 0.3])
% xlim([15 25])
ylim([VF_GenWT7.z(1)/VF_GenWT7.delta VF_GenWT7.z(end)/VF_GenWT7.delta])

%% Contour plot Lambda_ci(WT7Gen)
Snshot = 10;

VF_GenWT7_Lambda_ci_temp = VF_GenWT7.Lambda_ci;
% for r = 1:size(VF_GenWT7.Lambda_ci, 1)
%     VF_GenWT7_Lambda_ci_temp(r, :, :) = VF_GenWT7.Lambda_ci(r, :, :) .* (abs(VF_GenWT7.Lambda_ci(r, :, :)) >= 1.0*VF_GenWT7.Lambda_cirms(r));
% end
figure
set(gcf,'Position',[639,449,806,503])
axes('Position',[0.058312655086849,0.574011175552839,0.846153858744033,0.417965188116731])
index = find(VF_GenWT7.HRVFx/VF_GenWT7.delta >= 0.6, 1);

contourf(VF_GenWT7.HRVFx(index:end)/VF_GenWT7.delta-VF_GenWT7.HRVFx(index)/VF_GenWT7.delta,...
    VF_GenWT7.z/VF_GenWT7.delta...
    ,VF_GenWT7_Lambda_ci_temp(:,index:end,Snshot)/max(max(VF_GenWT7_Lambda_ci_temp(:,index:end,Snshot))),'LevelStep',0.01,...10000:11539%%17001:18540
    'LineStyle','none',...
    'LineColor','none','EdgeColor','none');
hold on
% quiver(VF_GenWT7.HRVFx(1:7:end)/VF_GenWT7.delta,...
%     VF_GenWT7.z(1:7:end)/VF_GenWT7.delta...
%     ,VF_GenWT7.HRVFu(1:7:end,1:7:end,Snshot)-3.5,...
%     VF_GenWT7.HRVFw(1:7:end,1:7:end,Snshot),1,'color',[0,0,0],...
%     'MaxHeadSize',0.2,'LineWidth',1.5);
% cmap2 = plasma(100);
% cmap2 = crameri('vik',100);
cmap2 = getPyPlot_cMap('seismic', [], [],...
    '"C:\Users\ehsan010\Anaconda3\envs\Matlabpy\python.exe"');
% cmNames = getPyPlot_cMap('!GetNames');
% fprintf([repmat('%-12s\t',1,5) '%-12s\n'],cmNames{:});
% cmap2 = crameri('berlin',100);
cmap2 = flip(cmap2);
colormap(gca,cmap2);
% C2=cmap2;
% C3=[0,0,0;C2;1,1,1];
caxis([-1 1])
% C3 = flip(C3);
% colormap(gca,C3)
hcb2=colorbar;
hcb2.Position=[0.92884294413975,0.576540755467197,0.022015823873409,0.353871615666818];
title(hcb2,'$\lambda_{\mathrm{ci}}$','Interpreter','Latex','FontSize',15)...,'Position',...
%     [4.999994333833513,142.5300008152491,0]);
hcb2.TickLabelInterpreter = 'latex';
hcb2.TickLength = 0;
hcb2.Label.Interpreter = 'latex';
hcb2.AxisLocation='out';
set(gca,'TickLabelInterpreter','latex','FontSize',15,'XGrid','on','YGrid','on','XMinorGrid','on','YMinorGrid','on',...
    'YTick',[0.04,0.06,0.08,0.1,0.12,0.14],'YTickLabel',[{'0.04'},{''},{''},{''},{'0.12'},{''}])
% xlabel('x/$\delta$','Interpreter','Latex','FontSize',14);
ylabel('z/$\delta$','Interpreter','Latex','FontSize',18,'position',[-0.009671794216931,0.084689392831734,1]);
axis equal
xlim([0.0 0.4])
ylim([VF_GenWT7.z(1)/VF_GenWT7.delta VF_GenWT7.z(end)/VF_GenWT7.delta])

%% Contour plot Vorticity(WT7Gen)
Snshot = 10;
DelxGen = VF_GenWT7.HRVFx(2)-VF_GenWT7.HRVFx(1);
DelzGen = VF_GenWT7.z(2)-VF_GenWT7.z(1);


omega_WT7_Total = zeros(size(VF_GenWT7.Lambda_ci));
for S= 1:size(VF_GenWT7.Lambda_ci,3)

    [dudx, dudz] = gradient(VF_GenWT7.HRVFu(:,:, S),DelxGen,DelzGen);
    [dwdx, dwdz] = gradient(VF_GenWT7.HRVFw(:,:, S),DelxGen,DelzGen);
    %                     Obj.omega(:,:,S) = dwdx - dudz;
    omega_WT7_Total(:,:,S) = dwdx - dudz;

end
omega_WT7_rms = mean(rms(omega_WT7_Total,3),2);

% for r = 1:size(omega_WT7_Total, 1)
%     omega_WT7_Total(r, :, :) = omega_WT7_Total(r, :, :) .* (abs(omega_WT7_Total(r, :, :)) >= 1.0*omega_WT7_rms(r));
% end

axes('Position',[0.058312655086849,0.078981354479272,0.846153858744033,0.41796518811673])

contourf(VF_GenWT7.HRVFx(index:end)/VF_GenWT7.delta-VF_GenWT7.HRVFx(index)/VF_GenWT7.delta,...
    VF_GenWT7.z/VF_GenWT7.delta...
    ,omega_WT7_Total(:,index:end,Snshot)/max(max(omega_WT7_Total(:,index:end,Snshot))),'LevelStep',0.01,...10000:11539%%17001:18540
    'LineStyle','none',...
    'LineColor','none','EdgeColor','none');
% hold on
% quiver(VF_GenWT7.HRVFx(1:7:end)/VF_GenWT7.delta,...
%     VF_GenWT7.z(1:7:end)/VF_GenWT7.delta...
%     ,VF_GenWT7.HRVFu(1:7:end,1:7:end,Snshot)-3.5,...
%     VF_GenWT7.HRVFw(1:7:end,1:7:end,Snshot),1,'color',[0,0,0],...
%     'MaxHeadSize',0.2,'LineWidth',1.5);
% cmap2 = plasma(100);
% cmap2 = crameri('vik',100);
cmap2 = getPyPlot_cMap('seismic', [], [],...
    '"C:\Users\ehsan010\Anaconda3\envs\Matlabpy\python.exe"');
% cmNames = getPyPlot_cMap('!GetNames');
% fprintf([repmat('%-12s\t',1,5) '%-12s\n'],cmNames{:});
% cmap2 = crameri('berlin',100);
cmap2 = flip(cmap2);
colormap(gca,cmap2);
% C2=cmap2;
% C3=[0,0,0;C2;1,1,1];
caxis([-1 1])
% C3 = flip(C3);
% colormap(gca,C3)
hcb2=colorbar;
hcb2.Position=[0.92884294413975,0.081510934393638,0.022015823873409,0.383697813121272];
title(hcb2,'$\omega_{\mathrm{y}}$','Interpreter','Latex','FontSize',15)...,'Position',...
%     [4.999994333833513,142.5300008152491,0]);
hcb2.TickLabelInterpreter = 'latex';
hcb2.TickLength = 0;
hcb2.Label.Interpreter = 'latex';
hcb2.AxisLocation='out';
set(gca,'TickLabelInterpreter','latex','FontSize',15,'XGrid','on','YGrid','on','XMinorGrid','on','YMinorGrid','on',...
    'YTick',[0.04,0.06,0.08,0.1,0.12,0.14],'YTickLabel',[{'0.04'},{''},{''},{''},{'0.12'},{''}],'XTick',[0,0.05,0.1,0.15,0.25,0.3,0.35,0.4])
xlabel('x/$\delta$','Interpreter','Latex','FontSize',18,'position',[0.200000193715098,0.01775186912777,1]);
ylabel('z/$\delta$','Interpreter','Latex','FontSize',18,'position',[-0.009671794216931,0.084689392831734,1]);
axis equal
xlim([0 0.4])
ylim([VF_GenWT7.z(1)/VF_GenWT7.delta VF_GenWT7.z(end)/VF_GenWT7.delta])

%% Contour plot VF(ASL Gen)

figure
set(gcf,'Position',[745,754,969,388])
axes('Position',[0.06811145510836,0.12975944636204,0.87203302373581,0.800652924771981])
Snshot = 20;
Convvel = 7.0;
index = find(VF_GenASL.HRVFx/VF_GenASL.delta >= 0.9, 1);
contourf(VF_GenASL.HRVFx(:,1:index)/VF_GenASL.delta,...
    VF_GenASL.z/VF_GenASL.delta...
    ,VF_GenASL.HRVFu(:,1:index,Snshot),...10000:11539%%17001:18540
    50,'LineStyle','none',...
    'LineColor','none','EdgeColor','none');
hold on
quiver(VF_GenASL.HRVFx(1:12:index)/VF_GenASL.delta,...
    VF_GenASL.z(1:12:end)/VF_GenASL.delta...
    ,VF_GenASL.HRVFu(1:12:end,1:12:index,Snshot)-Convvel,...
    VF_GenASL.HRVFw(1:12:end,1:12:index,Snshot),1,'color',[1.00,0.00,0.00],...
    'MaxHeadSize',0.2,'LineWidth',1.5);


% contourf(VF_GenWT7.HRVFx/VF_GenWT7.Delx,...
%     VF_GenWT7.z/VF_GenWT7.delta...
%     ,VF_GenWT7.HRVFu(:,:,Snshot),...10000:11539%%17001:18540
%     50,'LineStyle','none',...
%     'LineColor','none','EdgeColor','none');
% hold on
% quiver(VF_GenWT7.HRVFx(1:2:end)/VF_GenWT7.Delx,...
%     VF_GenWT7.z(1:2:end)/VF_GenWT7.delta...
%     ,VF_GenWT7.HRVFu(1:2:end,1:2:end,Snshot)-Convvel,...
%     VF_GenWT7.HRVFw(1:2:end,1:2:end,Snshot),1,'color',[1.00,0.00,0.00],...
%     'MaxHeadSize',0.2,'LineWidth',1.5);

% cmap2 = plasma(100);
cmap2 = crameri('grayC',100);
% cmap2 = getPyPlot_cMap('ocean', [], [],...
%     '"C:\Users\ehsan010\Anaconda3\envs\Matlabpy\python.exe"');
% cmap2 = flip(cmap2);
colormap(gca,cmap2)
% C2=cmap2;
% C3=[0,0,0;C2;1,1,1];
% caxis([1 6])
% C3 = flip(C3);
% colormap(gca,C3)
hcb2=colorbar;
hcb2.Position=[0.898874954148657,0.128865979381443,0.022015823873409,0.801546391752577];
title(hcb2,'u$_{m}$','Interpreter','Latex','FontSize',15)...,'Position',...
%     [4.999994333833513,142.5300008152491,0]);
hcb2.TickLabelInterpreter = 'latex';
hcb2.TickLength = 0;
hcb2.Label.Interpreter = 'latex';
hcb2.AxisLocation='out';
set(gca,'TickLabelInterpreter','latex','FontSize',13)
% xlabel('x/$\delta$','Interpreter','Latex','FontSize',14);
xlabel('x/$\lambda_{T}$','Interpreter','Latex','FontSize',14);
ylabel('z/$\delta$','Interpreter','Latex','FontSize',14);
axis equal
xlim([0.0 0.05])
% xlim([15 25])
% ylim([VF_GenWT7.z(1)/VF_GenWT7.delta VF_GenWT7.z(end)/VF_GenWT7.delta])

%% Contour plot Lambda_ci(ASLGen)
Snshot = 20;
VF_GenASL_Lambda_ci_temp = VF_GenASL.Lambda_ci;
% for r = 1:size(VF_GenASL.Lambda_ci, 1)
%     VF_GenASL_Lambda_ci_temp(r, :, :) = VF_GenASL.Lambda_ci(r, :, :) .* (abs(VF_GenASL.Lambda_ci(r, :, :)) >= 1.0*VF_GenASL.Lambda_cirms(r));
% end
figure
set(gcf,'Position',[639,449,806,503])
axes('Position',[0.058312655086849,0.574011175552839,0.846153858744033,0.417965188116731])
index = find(VF_GenASL.HRVFx/VF_GenASL.delta >= 0.1, 1);

contourf(VF_GenASL.HRVFx(index:end)/VF_GenASL.delta-VF_GenASL.HRVFx(index)/VF_GenASL.delta,...
    VF_GenASL.z/VF_GenASL.delta...
    ,VF_GenASL_Lambda_ci_temp(:,index:end,Snshot)/max(max(VF_GenASL.Lambda_ci(:,index:end,Snshot))),'LevelStep',0.01,...10000:11539%%17001:18540
    'LineStyle','none',...
    'LineColor','none','EdgeColor','none');
hold on
% quiver(VF_GenASL.HRVFx(1:7:end)/VF_GenASL.delta,...
%     VF_GenASL.z(1:7:end)/VF_GenASL.delta...
%     ,VF_GenASL.HRVFu(1:7:end,1:7:end,Snshot)-3.5,...
%     VF_GenASL.HRVFw(1:7:end,1:7:end,Snshot),1,'color',[0,0,0],...
%     'MaxHeadSize',0.2,'LineWidth',1.5);
% cmap2 = plasma(100);
% cmap2 = crameri('vik',100);
cmap2 = getPyPlot_cMap('seismic', [], [],...
    '"C:\Users\ehsan010\Anaconda3\envs\Matlabpy\python.exe"');
% cmNames = getPyPlot_cMap('!GetNames');
% fprintf([repmat('%-12s\t',1,5) '%-12s\n'],cmNames{:});
% cmap2 = crameri('berlin',100);
cmap2 = flip(cmap2);
colormap(gca,cmap2);
% C2=cmap2;
% C3=[0,0,0;C2;1,1,1];
caxis([-1 1])
% C3 = flip(C3);
% colormap(gca,C3)
hcb2=colorbar;
hcb2.Position=[0.92884294413975,0.576540755467197,0.022015823873409,0.353871615666818];
title(hcb2,'$\lambda_{\mathrm{ci}}$','Interpreter','Latex','FontSize',15)...,'Position',...
%     [4.999994333833513,142.5300008152491,0]);
hcb2.TickLabelInterpreter = 'latex';
hcb2.TickLength = 0;
hcb2.Label.Interpreter = 'latex';
hcb2.AxisLocation='out';
set(gca,'TickLabelInterpreter','latex','FontSize',15,'XGrid','on','YGrid','on','XMinorGrid','on','YMinorGrid','on',...
    'YTick',[0.02,0.04,0.06,0.08,0.1,0.12,0.14],'YTickLabel',[{'0.02'},{'0.04'},{''},{''},{''},{'0.12'},{''}])
% xlabel('x/$\delta$','Interpreter','Latex','FontSize',14);
ylabel('z/$\delta$','Interpreter','Latex','FontSize',18,'position',[-0.005625954952796,0.08359660363964,1]);
axis equal
xlim([0.0 0.4])
ylim([VF_GenASL.z(1)/VF_GenASL.delta VF_GenWT7.z(end)/VF_GenWT7.delta])

%% Contour plot Vorticity(ASLGen)
Snshot = 20;
DelxGen = VF_GenASL.HRVFx(2)-VF_GenASL.HRVFx(1);
DelzGen = VF_GenASL.z(2)-VF_GenASL.z(1);


omega_ASL_Total = zeros(size(VF_GenASL.Lambda_ci));
for S= 1:size(VF_GenASL.Lambda_ci,3)

    [dudx, dudz] = gradient(VF_GenASL.HRVFu(:,:, S),DelxGen,DelzGen);
    [dwdx, dwdz] = gradient(VF_GenASL.HRVFw(:,:, S),DelxGen,DelzGen);
    %                     Obj.omega(:,:,S) = dwdx - dudz;
    omega_ASL_Total(:,:,S) = dwdx - dudz;

end
omega_ASL_rms = mean(rms(omega_ASL_Total,3),2);

for r = 1:size(omega_ASL_Total, 1)
    omega_ASL_Total(r, :, :) = omega_ASL_Total(r, :, :) .* (abs(omega_ASL_Total(r, :, :)) >= 1.0*omega_ASL_rms(r));
end
axes('Position',[0.058312655086849,0.078981354479272,0.846153858744033,0.41796518811673])

contourf(VF_GenASL.HRVFx(index:end)/VF_GenASL.delta-VF_GenASL.HRVFx(index)/VF_GenASL.delta,...
    VF_GenASL.z/VF_GenASL.delta...
    ,omega_ASL_Total(:,index:end,Snshot)/max(max(omega_ASL_Total(:,index:end,Snshot))),'LevelStep',0.01,...10000:11539%%17001:18540
    'LineStyle','none',...
    'LineColor','none','EdgeColor','none');
% hold on
% quiver(VF_GenASL.HRVFx(1:7:end)/VF_GenASL.delta,...
%     VF_GenASL.z(1:7:end)/VF_GenASL.delta...
%     ,VF_GenASL.HRVFu(1:7:end,1:7:end,Snshot)-3.5,...
%     VF_GenASL.HRVFw(1:7:end,1:7:end,Snshot),1,'color',[0,0,0],...
%     'MaxHeadSize',0.2,'LineWidth',1.5);
% cmap2 = plasma(100);
% cmap2 = crameri('vik',100);
cmap2 = getPyPlot_cMap('seismic', [], [],...
    '"C:\Users\ehsan010\Anaconda3\envs\Matlabpy\python.exe"');
% cmNames = getPyPlot_cMap('!GetNames');
% fprintf([repmat('%-12s\t',1,5) '%-12s\n'],cmNames{:});
% cmap2 = crameri('berlin',100);
cmap2 = flip(cmap2);
colormap(gca,cmap2);
% C2=cmap2;
% C3=[0,0,0;C2;1,1,1];
caxis([-1 1])
% C3 = flip(C3);
% colormap(gca,C3)
hcb2=colorbar;
hcb2.Position=[0.92884294413975,0.081510934393638,0.022015823873409,0.383697813121272];
title(hcb2,'$\omega_{\mathrm{y}}$','Interpreter','Latex','FontSize',15)...,'Position',...
%     [4.999994333833513,142.5300008152491,0]);
hcb2.TickLabelInterpreter = 'latex';
hcb2.TickLength = 0;
hcb2.Label.Interpreter = 'latex';
hcb2.AxisLocation='out';
set(gca,'TickLabelInterpreter','latex','FontSize',15,'XGrid','on','YGrid','on','XMinorGrid','on','YMinorGrid','on',...
    'YTick',[0.02,0.04,0.06,0.08,0.1,0.12,0.14],'YTickLabel',[{'0.02'},{'0.04'},{''},{''},{''},{'0.12'},{''}],'XTick',[0,0.05,0.1,0.15,0.25,0.3,0.35,0.4])
xlabel('x/$\delta$','Interpreter','Latex','FontSize',18,'position',[0.200000193715098,0.009253817613221,1]);
ylabel('z/$\delta$','Interpreter','Latex','FontSize',18,'position',[-0.009671794216931,0.084689392831734,1]);
axis equal
xlim([0 0.4])
ylim([VF_GenASL.z(1)/VF_GenASL.delta VF_GenWT7.z(end)/VF_GenWT7.delta])


%% Contour plot Lambda_ci(ASLGen)

figure
set(gcf,'Position',[745,754,969,388])
axes('Position',[0.077399380804954,0.12975944636204,0.854489164086687,0.800652924771981])


contourf(VF_GenASL.HRVFx/VF_GenASL.delta,...
    VF_GenASL.z/VF_GenASL.delta...
    ,VF_GenASL.Lambda_ci(:,:,20),...10000:11539%%17001:18540
    'LevelStep',0.01,'LineStyle','none',...
    'LineColor','none','EdgeColor','none');
hold on
% quiver(VF_GenASL.HRVFx(1:7:end)/VF_GenASL.delta,...
%     VF_GenASL.z(1:7:end)/VF_GenASL.delta...
%     ,VF_GenASL.HRVFu(1:7:end,1:7:end,20)-3.5,...
%     VF_GenASL.HRVFw(1:7:end,1:7:end,20),1,'color',[0,0,0],...
%     'MaxHeadSize',0.2,'LineWidth',1.5);
% cmap2 = plasma(100);
% cmap2 = crameri('vik',100);
cmap2 = getPyPlot_cMap('seismic', [], [],...
    '"C:\Users\ehsan010\Anaconda3\envs\Matlabpy\python.exe"');
% cmNames = getPyPlot_cMap('!GetNames');
% fprintf([repmat('%-12s\t',1,5) '%-12s\n'],cmNames{:});
% cmap2 = crameri('berlin',100);
cmap2 = flip(cmap2);
colormap(gca,cmap2);
% C2=cmap2;
% C3=[0,0,0;C2;1,1,1];
caxis([-1 1])
% C3 = flip(C3);
% colormap(gca,C3)
hcb2=colorbar;
hcb2.Position=[0.938768502452405,0.128865979381443,0.022015823873409,0.801546391752577];
title(hcb2,'$\lambda_{\mathrm{ci}}$','Interpreter','Latex','FontSize',15)...,'Position',...
%     [4.999994333833513,142.5300008152491,0]);
hcb2.TickLabelInterpreter = 'latex';
hcb2.TickLength = 0;
hcb2.Label.Interpreter = 'latex';
hcb2.AxisLocation='out';
set(gca,'TickLabelInterpreter','latex','FontSize',13)
xlabel('x/$\delta$','Interpreter','Latex','FontSize',14);
ylabel('z/$\delta$','Interpreter','Latex','FontSize',14);
axis equal
xlim([0.1 0.2])
ylim([VF_GenASL.z(1)/VF_GenASL.delta VF_GenASL.z(end)/VF_GenASL.delta])
%% Contour plot VF(PIV)

figure
set(gcf,'Position',[745,754,969,388])
axes('Position',[0.077399380804954,0.12975944636204,0.87203302373581,0.800652924771981])


contourf(VF_PIVWT7.x/VF_PIVWT7.delta,...
    VF_PIVWT7.z/VF_PIVWT7.delta...
    ,VF_PIVWT7.u(:,:,20),...10000:11539%%17001:18540
    50,'LineStyle','none',...
    'LineColor','none','EdgeColor','none');
hold on
quiver(VF_PIVWT7.x(1:2:end)/VF_PIVWT7.delta,...
    VF_PIVWT7.z(1:2:end)/VF_PIVWT7.delta...
    ,VF_PIVWT7.u(1:2:end,1:2:end,20)-3,...
    VF_PIVWT7.w(1:2:end,1:2:end,20),3,'color',[1.00,0.00,0.00],...
    'MaxHeadSize',0.2,'LineWidth',1.5);

% cmap2 = plasma(100);
cmap2 = crameri('turku',100);
% cmap2 = getPyPlot_cMap('ocean', [], [],...
%     '"C:\Users\ehsan010\Anaconda3\envs\Matlabpy\python.exe"');
cmap2 = flip(cmap2);
colormap(gca,cmap2)
% C2=cmap2;
% C3=[0,0,0;C2;1,1,1];
caxis([1 6])
% C3 = flip(C3);
% colormap(gca,C3)
hcb2=colorbar;
hcb2.Position=[0.956312362101529,0.128865979381443,0.022015823873409,0.801546391752577];
title(hcb2,'u$_{m}$','Interpreter','Latex','FontSize',15)...,'Position',...
%     [4.999994333833513,142.5300008152491,0]);
hcb2.TickLabelInterpreter = 'latex';
hcb2.TickLength = 0;
hcb2.Label.Interpreter = 'latex';
hcb2.AxisLocation='out';
set(gca,'TickLabelInterpreter','latex','FontSize',13)
xlabel('x/$\delta$','Interpreter','Latex','FontSize',14);
ylabel('z/$\delta$','Interpreter','Latex','FontSize',14);
axis equal
xlim([VF_PIVWT7.x(1)/VF_PIVWT7.delta VF_PIVWT7.x(end)/VF_PIVWT7.delta])
ylim([VF_PIVWT7.z(1)/VF_PIVWT7.delta 0.1])


%% Contour plot Lambda_ci(PIV)

figure
set(gcf,'Position',[745,754,969,388])
axes('Position',[0.077399380804954,0.12975944636204,0.854489164086687,0.800652924771981])


contourf(VF_PIVWT7.x/VF_PIVWT7.delta,...
    VF_PIVWT7.z/VF_PIVWT7.delta...
    ,VF_PIVWT7.Lambda_ci(:,:,4),...20
    501,'LineStyle','none',...
    'LineColor','none','EdgeColor','none');
% hold on
% quiver(VF_PIVWT7.x(1:2:end)/VF_PIVWT7.delta,...
%     VF_PIVWT7.z(1:2:end)/VF_PIVWT7.delta...
%     ,VF_PIVWT7.u(1:2:end,1:2:end,20)-3,...
%     VF_PIVWT7.w(1:2:end,1:2:end,20),3,'color',[0,0,0],...
%     'MaxHeadSize',0.2,'LineWidth',1.5);
% cmap2 = plasma(100);
cmap2 = getPyPlot_cMap('seismic', 51, false,...
    '"C:\Users\ehsan010\Anaconda3\envs\Matlabpy\python.exe"');
% cmNames = getPyPlot_cMap('!GetNames');
% fprintf([repmat('%-12s\t',1,5) '%-12s\n'],cmNames{:});
% cmap2 = crameri('berlin',100);
cmap2 = flip(cmap2);
colormap(gca,cmap2)
% C2=cmap2;
% C3=[0,0,0;C2;1,1,1];
caxis([-200 200])
% C3 = flip(C3);
% colormap(gca,C3)
hcb2=colorbar;
hcb2.Position=[0.938768502452405,0.128865979381443,0.022015823873409,0.801546391752577];
title(hcb2,'$\lambda_{ci}$','Interpreter','Latex','FontSize',15)...,'Position',...
%     [4.999994333833513,142.5300008152491,0]);
hcb2.TickLabelInterpreter = 'latex';
hcb2.TickLength = 0;
hcb2.Label.Interpreter = 'latex';
hcb2.AxisLocation='out';
set(gca,'TickLabelInterpreter','latex','FontSize',13)
xlabel('x/$\delta$','Interpreter','Latex','FontSize',14);
ylabel('z/$\delta$','Interpreter','Latex','FontSize',14);
axis equal
xlim([VF_PIVWT7.x(1)/VF_PIVWT7.delta VF_PIVWT7.x(end)/VF_PIVWT7.delta])
ylim([VF_PIVWT7.z(1)/VF_PIVWT7.delta 0.1])

%% Contour plot VF(SLPIV)

figure
set(gcf,'Position',[745,754,969,388])
axes('Position',[0.077399380804954,0.12975944636204,0.87203302373581,0.800652924771981])


contourf(VF_SLPIVASL.x/VF_SLPIVASL.delta,...
    VF_SLPIVASL.z/VF_SLPIVASL.delta...
    ,VF_SLPIVASL.u(:,:,20),...10000:11539%%17001:18540
    50,'LineStyle','none',...
    'LineColor','none','EdgeColor','none');
hold on
quiver(VF_SLPIVASL.x(1:2:end)/VF_SLPIVASL.delta,...
    VF_SLPIVASL.z(1:2:end)/VF_SLPIVASL.delta...
    ,VF_SLPIVASL.u(1:2:end,1:2:end,20)-3,...
    VF_SLPIVASL.w(1:2:end,1:2:end,20),3,'color',[1.00,0.00,0.00],...
    'MaxHeadSize',0.2,'LineWidth',1.5);

% cmap2 = plasma(100);
cmap2 = crameri('turku',100);
% cmap2 = getPyPlot_cMap('ocean', [], [],...
%     '"C:\Users\ehsan010\Anaconda3\envs\Matlabpy\python.exe"');
cmap2 = flip(cmap2);
colormap(gca,cmap2)
% C2=cmap2;
% C3=[0,0,0;C2;1,1,1];
% caxis([1 6])
% C3 = flip(C3);
% colormap(gca,C3)
hcb2=colorbar;
hcb2.Position=[0.956312362101529,0.128865979381443,0.022015823873409,0.801546391752577];
title(hcb2,'u$_{m}$','Interpreter','Latex','FontSize',15)...,'Position',...
%     [4.999994333833513,142.5300008152491,0]);
hcb2.TickLabelInterpreter = 'latex';
hcb2.TickLength = 0;
hcb2.Label.Interpreter = 'latex';
hcb2.AxisLocation='out';
set(gca,'TickLabelInterpreter','latex','FontSize',13)
xlabel('x/$\delta$','Interpreter','Latex','FontSize',14);
ylabel('z/$\delta$','Interpreter','Latex','FontSize',14);
axis equal
% xlim([VF_SLPIVASL.x(1)/VF_SLPIVASL.delta VF_SLPIVASL.x(end)/VF_SLPIVASL.delta])
% ylim([VF_SLPIVASL.z(1)/VF_SLPIVASL.delta 0.1])


%% Contour plot Lambda_ci(SLPIV)

figure
set(gcf,'Position',[745,754,969,388])
axes('Position',[0.077399380804954,0.12975944636204,0.854489164086687,0.800652924771981])


contourf(VF_SLPIVASL.x/VF_SLPIVASL.delta,...
    VF_SLPIVASL.z/VF_SLPIVASL.delta...
    ,VF_SLPIVASL.Lambda_ci(:,:,4),...20
    501,'LineStyle','none',...
    'LineColor','none','EdgeColor','none');
% hold on
% quiver(VF_PIVWT7.x(1:2:end)/VF_PIVWT7.delta,...
%     VF_PIVWT7.z(1:2:end)/VF_PIVWT7.delta...
%     ,VF_PIVWT7.u(1:2:end,1:2:end,20)-3,...
%     VF_PIVWT7.w(1:2:end,1:2:end,20),3,'color',[0,0,0],...
%     'MaxHeadSize',0.2,'LineWidth',1.5);
% cmap2 = plasma(100);
cmap2 = getPyPlot_cMap('seismic', 51, false,...
    '"C:\Users\ehsan010\Anaconda3\envs\Matlabpy\python.exe"');
% cmNames = getPyPlot_cMap('!GetNames');
% fprintf([repmat('%-12s\t',1,5) '%-12s\n'],cmNames{:});
% cmap2 = crameri('berlin',100);
cmap2 = flip(cmap2);
colormap(gca,cmap2)
% C2=cmap2;
% C3=[0,0,0;C2;1,1,1];
caxis([-1 1])
% C3 = flip(C3);
% colormap(gca,C3)
hcb2=colorbar;
hcb2.Position=[0.938768502452405,0.128865979381443,0.022015823873409,0.801546391752577];
title(hcb2,'$\lambda_{ci}$','Interpreter','Latex','FontSize',15)...,'Position',...
%     [4.999994333833513,142.5300008152491,0]);
hcb2.TickLabelInterpreter = 'latex';
hcb2.TickLength = 0;
hcb2.Label.Interpreter = 'latex';
hcb2.AxisLocation='out';
set(gca,'TickLabelInterpreter','latex','FontSize',13)
xlabel('x/$\delta$','Interpreter','Latex','FontSize',14);
ylabel('z/$\delta$','Interpreter','Latex','FontSize',14);
axis equal
% xlim([VF_SLPIVASL.x(1)/VF_SLPIVASL.delta VF_SLPIVASL.x(end)/VF_SLPIVASL.delta])
% ylim([VF_SLPIVASL.z(1)/VF_SLPIVASL.delta 0.1])

%% u'-w' for vortex cores:

Lambda_ci_pos_uprime = VF_PIVWT7.uprime(find(VF_PIVWT7.Lambda_ci>0));
Lambda_ci_neg_uprime = VF_PIVWT7.uprime(find(VF_PIVWT7.Lambda_ci<0));

Lambda_ci_pos_wprime = VF_PIVWT7.w(find(VF_PIVWT7.Lambda_ci>0));
Lambda_ci_neg_wprime = VF_PIVWT7.w(find(VF_PIVWT7.Lambda_ci<0));

F = 10;
G = size(VF_PIVWT7.Lambda_ci,3)/F;
corrcoef_pos = zeros(1,G);
corrcoef_neg = zeros(1,G);
for i=1:G
    corrcoef_pos_mat = corrcoef(VF_PIVWT7.uprime(find(VF_PIVWT7.Lambda_ci(:,:,F*(i-1)+1:F*i)>0)),...
        VF_PIVWT7.w(find(VF_PIVWT7.Lambda_ci(:,:,F*(i-1)+1:F*i)>0)));
    corrcoef_pos (i) = corrcoef_pos_mat(1,2);
end

for i=1:G
    corrcoef_neg_mat = corrcoef(VF_PIVWT7.uprime(find(VF_PIVWT7.Lambda_ci(:,:,F*(i-1)+1:F*i)<0)),...
        VF_PIVWT7.w(find(VF_PIVWT7.Lambda_ci(:,:,F*(i-1)+1:F*i)<0)));
    corrcoef_neg (i) = corrcoef_neg_mat(1,2);
end

figure
set(gcf,'Position',[745,754,969,388])
axes('Position',[0.048503611971104,0.12975944636204,0.435500515995872,0.800652924771981])
plot(VF_PIVWT7.uprime(find(VF_PIVWT7.Lambda_ci(:,:,F*(i-1)+1:F*i)>0)),...
    VF_PIVWT7.w(find(VF_PIVWT7.Lambda_ci(:,:,F*(i-1)+1:F*i)>0)),'r.')
set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on')
xlabel('u$^{\prime}$','Interpreter','Latex','FontSize',14);
ylabel('w$^{\prime}$','Interpreter','Latex','FontSize',14);
legend('Retrograde','Interpreter','Latex')
xlim([-4 4])
ylim([-4 4])
axes('Position',[0.557275541795659,0.12975944636204,0.435500515995871,0.800652924771981])
plot(Lambda_ci_neg_uprime,Lambda_ci_neg_wprime,'b.')
set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on')
xlabel('u$^{\prime}$','Interpreter','Latex','FontSize',14);
ylabel('w$^{\prime}$','Interpreter','Latex','FontSize',14);
xlim([-4 4])
ylim([-4 4])
legend('Prograde','Interpreter','Latex')
%% twopoint-corr

figure
set(gcf,'Position',[802,353,768,543])

axes('Position',[0.08984375,0.592833178111178,0.895833333333333,0.366287466117704])
contour([-flip(VF_PIVWT7.x(2:131)'),0,VF_PIVWT7.x(2:131)']./VF_PIVWT7.delta,...
    VF_PIVWT7.z./VF_PIVWT7.delta, ...
    fliplr(mean(VF_PIVWT7.Rij(:,25:285,:),3)),10,'color',[0.17,0.72,1.00],...
    'ShowText','on','LineWidth',1.5,'LevelList',[0.4,0.5,0.6,0.7,0.8,0.9]);
set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on')
xlabel('r$_{x}/\delta$','Interpreter','latex','FontSize',15)
ylabel('z/$\delta$','Interpreter','latex','FontSize',15)
axis equal
ylim([0 0.15])
% xlim([-0.15 0.15])
legend(sprintf('PIV(m1) $z_{ref}/\\delta$ = %.2f',VF_PIVWT7.z(18)/VF_PIVWT7.delta),...
   'Interpreter','latex','FontSize',9,...
    'Numcolumns',1,'Orientation','Horizontal','Position',...
    [0.759002620483748,0.964921445486315,0.231014753442749,0.033885818906471]);
hold on

Mid = ceil(size(VF_GenWT7.Rij,2) / 2);
axes('Position',[0.08984375,0.099278850302709,0.895833333333333,0.366287466117705])
contour([-flip(VF_GenWT7.HRVFx(2:551)),0,VF_GenWT7.HRVFx(2:551)]./VF_GenWT7.delta,...
    VF_GenWT7.HRVFz./VF_GenWT7.delta, ...
    fliplr(mean(VF_GenWT7.Rij(:,Mid-550:Mid+550),3)),10,'color',[0.17,1.00,0.72],...
    'ShowText','on','LineWidth',1.5,'LevelList',[0.4,0.5,0.6,0.7,0.8,0.9]);
set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on')
xlabel('r$_{x}/\delta$','Interpreter','latex','FontSize',15)
ylabel('z/$\delta$','Interpreter','latex','FontSize',15)
axis equal
ylim([0.0 0.15])
% xlim([-0.5 0.5])
legend(sprintf('Gen(m1) $z_{ref}/\\delta$ = %.2f',VF_GenWT7.HRVFz(56)/VF_GenWT7.delta),...
   'Interpreter','latex','FontSize',9,...
    'Numcolumns',1,'Orientation','Horizontal','Position',...
    [0.752600733937874,0.47473110950928,0.230906223321955,0.033885818906471]);

%% Statistics
kappa = 0.39;
figure
set(gcf,'Position',[634,494,756,302])
axes('Position',[0.079365079365079,0.188741721854305,0.902116402116402,0.771523178807947])

semilogy(1/kappa*log(linspace(10,300,100)),...
    linspace(10,300,100),'LineStyle','-','LineWidth',2,'color',...
    [1.00,0.74,0.17])
hold on
semilogy(mean(mean(VF_PIVWT7.u(1:10:end,:,:),3),2)/VF_PIVWT7.u_tau,...
    VF_PIVWT7.z(1:10:end,:)./VF_PIVWT7.z0,'LineStyle','none','LineWidth',1.5,'color',...
    [0.17,0.72,1.00],'Marker','^','MarkerSize',6,'MarkerFaceColor',[0.17,0.72,1.00])

% semilogy(mean(mean(VF_GenWT7.HRVFu(1:10:end,:,:),3),2)/VF_GenWT7.u_tau,...
%     VF_GenWT7.HRVFz(1:10:end,:)./VF_GenWT7.z0,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','^','MarkerSize',6,'MarkerFaceColor',[0.17,1.00,0.72])

scatter(mean(mean(VF_GenWT7.HRVFu(1:22:end,:,:),3),2)/VF_GenWT7.u_tau,...
    VF_GenWT7.HRVFz(1:22:end,:)./VF_GenWT7.z0,64, [0.17, 1.00, 0.72], 'filled', '^', ...
    'MarkerFaceAlpha', 1, 'MarkerEdgeAlpha', 1,'MarkerEdgecolor',[0,0,0])

% xlim([1e-2 4e-1])
ylim([7e0 4e2])
set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
    'XGrid','on','YGrid','on')
ylabel('z/z$_{0}$','Interpreter','latex','FontSize',15)
xlabel('$\overline{U}/u_{\tau}$','Interpreter','latex','FontSize',15)
legend('Log-Law','PIV(m1)','Gen(m1)-LR',... 
   'Interpreter','latex','FontSize',9,'Position',...
    [0.093828323706079,0.769125543944975,0.156195047549649,0.159602645690867],...
    'Numcolumns',1,'Orientation','Horizontal');
% legend boxoff


%% Stats normalized by data
Norm_uu = zeros();
Norm_ww = zeros();
Norm_uw = zeros();

for i = 1:size(VF_GenWT7.HRVFz,1)-1
    lower_bound = VF_GenWT7.HRVFz(i);
    upper_bound = VF_GenWT7.HRVFz(i + 1);
    indices = find(VF_PIVWT7.z > lower_bound & VF_PIVWT7.z <= upper_bound);
    Norm_uu(i,1) = mean(mean(rms(VF_GenWT7.HRVFuprime(i:i+1,:,:),3),2),1).^2/...
        mean(mean(rms(VF_PIVWT7.uprime(indices,:,:),3),2),1).^2;
    Norm_ww(i,1) = mean(mean(rms(VF_GenWT7.HRVFw(i:i+1,:,:),3),2),1).^2/...
        mean(mean(rms(VF_PIVWT7.w(indices,:,:),3),2),1).^2;
    Norm_uw(i,1) = mean(mean(mean(VF_GenWT7.HRVFuprime(i:i+1,:,:).*VF_GenWT7.HRVFw(i:i+1,:,:),3),2),1)/...
        mean(mean(mean(VF_PIVWT7.uprime(indices,:,:).*VF_PIVWT7.w(indices,:,:),3),2),1);
end
nonnanind = find(~isnan(Norm_uu));
Norm_uu = Norm_uu(nonnanind);
Norm_ww = Norm_ww(nonnanind);
Norm_uw = Norm_uw(nonnanind);
%%
figure
set(gcf,'Position',[687,374,768,630])
axes('Position',[0.087239583333333,0.733333333333333,0.888020833333334,0.260667204735006])
plot((VF_GenWT7.HRVFz(nonnanind(1:1:end))+VF_GenWT7.HRVFz(nonnanind(1:1:end)+1))*0.5./VF_GenWT7.delta,...
    Norm_uu(1:1:end),'LineStyle','-',...
    'LineWidth',1.5,'color',...
    [0.61,1.00,0.87],'MarkerSize',8)
% scatter((VF_GenWT7.HRVFz(nonnanind(1:4:end))+VF_GenWT7.HRVFz(nonnanind(1:4:end)+1))*0.5./VF_GenWT7.delta,...
%     Norm_uu(1:4:end),64, [0.17, 1.00, 0.72], 'filled', '^', ...
%     'MarkerFaceAlpha', 0.5, 'MarkerEdgeAlpha', 0.5,...
%     'MarkerEdgecolor',[0.17,0.72,1.00])


set(gca,'TickLabelInterpreter','latex','FontSize',13,'Box','on',...
    'XGrid','on','YGrid','on')
% xlabel('z/$\delta$','Interpreter','latex','FontSize',15)
ylabel('$\langle u^{\prime}_{m}u^{\prime}_{m}\rangle/\langle u^{\prime}u^{\prime} \rangle$',...
    'Interpreter','latex','FontSize',14)
legend('Gen(m1)-LR',... 
   'Interpreter','latex','FontSize',9,'Position',...
    [0.80311324698596,0.949984223405356,0.153754499931686,0.02920634867653],...
    'Numcolumns',1,'Orientation','Horizontal');
ylim([0.5 1.75])


axes('Position',[0.087239583333333,0.407936507936508,0.888020833333334,0.260667204735006])
plot((VF_GenWT7.HRVFz(nonnanind(1:1:end))+VF_GenWT7.HRVFz(nonnanind(1:1:end)+1))*0.5./VF_GenWT7.delta,...
    Norm_ww(1:1:end),'LineStyle','-',...
    'LineWidth',1.5,'color',...
    [0.61,1.00,0.87],'MarkerSize',8)

% scatter((VF_GenWT7.HRVFz(nonnanind(1:4:end))+VF_GenWT7.HRVFz(nonnanind(1:4:end)+1))*0.5./VF_GenWT7.delta,...
%     Norm_ww(1:4:end),64, [0.17, 1.00, 0.72], 'filled', '^', ...
%     'MarkerFaceAlpha', 0.5, 'MarkerEdgeAlpha', 0.5,...
%     'MarkerEdgecolor',[0.17,0.72,1.00])

set(gca,'TickLabelInterpreter','latex','FontSize',13,'Box','on',...
    'XGrid','on','YGrid','on')
% xlabel('z/$\delta$','Interpreter','latex','FontSize',12)
ylabel('$\langle w^{\prime}_{m}w^{\prime}_{m}\rangle/\langle w^{\prime}w^{\prime} \rangle$',...
    'Interpreter','latex','FontSize',14)
legend('Gen(m1)-LR',... 
   'Interpreter','latex','FontSize',9,'Position',...
    [0.803113246985961,0.618238191659325,0.153754499931686,0.02920634867653],...
    'Numcolumns',1,'Orientation','Horizontal');
ylim([0 1.5])

axes('Position',[0.087239583333333,0.087301587301588,0.888020833333334,0.260667204735006])
plot(VF_PIVWT7.z./VF_PIVWT7.delta,...
    -mean(mean(VF_PIVWT7.w.*VF_PIVWT7.uprime,3),2)...
    /VF_PIVWT7.u_tau^2,'LineWidth',1.5,'color',...
    [0.17,0.72,1.00],'LineStyle','-')
% hold on
% scatter(VF_PIVWT7.z(1:10:end,1)./VF_PIVWT7.delta,...
%     -mean(mean(VF_PIVWT7.w(1:10:end,:,:).*VF_PIVWT7.uprime(1:10:end,:,:),3),2)/VF_PIVWT7.u_tau^2,...
%     64, [0.17,0.72,1.00], 'filled', '^', ...
%     'MarkerFaceAlpha', 1, 'MarkerEdgeAlpha', 1,...
%     'MarkerEdgecolor',[0.17,0.72,1.00])
hold on


% scatter(VF_GenWT7.HRVFz(1:22:end)./VF_GenWT7.delta,...
%     -mean(mean(VF_GenWT7.HRVFw(1:22:end,:,:).*VF_GenWT7.HRVFuprime(1:22:end,:,:),3),2)...
%     /VF_GenWT7.u_tau^2,...
%     64, [0.17,1.00,0.72], 'filled', '^', ...
%     'MarkerFaceAlpha', 0.5, 'MarkerEdgeAlpha', 0.5,...
%     'MarkerEdgecolor',[0, 0, 0])

plot(VF_GenWT7.HRVFz./VF_GenWT7.delta,...
    -mean(mean(VF_GenWT7.HRVFw.*VF_GenWT7.HRVFuprime,3),2)...
    /VF_GenWT7.u_tau^2,'LineWidth',1.5,'color',...
    [0.61,1.00,0.87],'LineStyle','-')

ylim([0.5 1.2])
set(gca,'TickLabelInterpreter','latex','FontSize',13,'Box','on',...
    'XGrid','on','YGrid','on')
xlabel('z/$\delta$','Interpreter','latex','FontSize',14)
ylabel('$-\langle u^{\prime}w^{\prime} \rangle/u_{\tau}^2$','Interpreter','latex','FontSize',14)
legend('PIV(m1)','Gen(m1)-LR',... 
   'Interpreter','latex','FontSize',9,'Position',...
    [0.801820666700823,0.276321429101247,0.153754499931685,0.052857141797505],...
    'Numcolumns',1,'Orientation','Horizontal');
% legend boxoff

%% VF_Gen
Snshot = 1;
concat_u = reshape(VF_GenWT7.HRVFu,size(VF_GenWT7.HRVFu, 1), []);
concat_w = reshape(VF_GenWT7.HRVFw,size(VF_GenWT7.HRVFw, 1), []);
index = find(VF_GenWT7.HRVFx/VF_GenWT7.delta >= 0.3, 1);
Convvel = 3.0;
res=1;%1680
figure
set(gcf,'Position',[537,599,930,388])
axes('Position',[0.070405139466523,0.126242255632001,0.879057226124875,0.866025785605113])

% Plot contour and quiver
contourf(VF_GenWT7.HRVFx(1:index)/VF_GenWT7.delta, ...
    VF_GenWT7.z/VF_GenWT7.delta, ...
    (concat_u(:,res:index+res-1)), ...
    50, 'LineStyle', 'none', ...
    'LineColor', 'none', 'EdgeColor', 'none');
hold on
quiver(VF_GenWT7.HRVFx(1:7:index)/VF_GenWT7.delta, ...
    VF_GenWT7.z(1:7:end)/VF_GenWT7.delta, ...
    (concat_u(1:7:end,res:7:index+res-1)-Convvel), ...
    (concat_w(1:7:end,res:7:index+res-1)), 2, 'color', [1.00,0.00,0.00], ...
    'MaxHeadSize', 0.2, 'LineWidth', 1.5);

% Configure color map and colorbar
cmap2 = crameri('turku', 100);
cmap2 = flip(cmap2);
colormap(gca, cmap2)
caxis([1 6])
hcb2 = colorbar;
hcb2.Position = [0.956312362101529, 0.128865979381443, 0.022015823873409, 0.801546391752577];
title(hcb2, 'u$_{m}$', 'Interpreter', 'Latex', 'FontSize', 15)
hcb2.TickLabelInterpreter = 'latex';
hcb2.TickLength = 0;
hcb2.Label.Interpreter = 'latex';
hcb2.AxisLocation = 'out';
set(gca, 'TickLabelInterpreter', 'latex', 'FontSize', 13)
xlabel('x/$\delta$', 'Interpreter', 'Latex', 'FontSize', 14);
ylabel('z/$\delta$', 'Interpreter', 'Latex', 'FontSize', 14);
axis equal
xlim([0.0 0.3])
ylim([VF_GenWT7.z(1)/VF_GenWT7.delta VF_GenWT7.z(end)/VF_GenWT7.delta])
%% Statistics Mean streamwise and vertical and var and co-var(in active)
% kappa = 0.39;
% numPoints = 15; % Adjust as needed
% logIndices = round(logspace(0, log10(size(VF_PIVWT7.z, 1)), numPoints));
% figure
% set(gcf,'Position',[768,789,797,300])
% axes('Position',[0.079427083333333,0.186666666666667,0.899739583333334,0.803333333333333])
% semilogy(1/kappa*log(linspace(6,10000,100)),...
%     linspace(6,10000,100),'LineStyle','-','LineWidth',2,'color',...
%     [1.00,0.74,0.17])
% hold on
% semilogy(mean(mean(VF_PIVWT7.u(1:10:end,:,:),3),2)/VF_PIVWT7.u_tau,...
%     VF_PIVWT7.z(1:10:end,1)./VF_PIVWT7.z0,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,0.72,1.00],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
%     'MarkerFaceColor',[0.17,0.72,1.00])
% 
% 
% semilogy(mean(mean(VF_GenWT7.HRVFu(1:10:end,:,:),3),2)/VF_GenWT7.u_tau,...
%     VF_GenWT7.HRVFz(1:10:end,1)./VF_GenWT7.z0,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
%     'MarkerFaceColor',[1.00,0.40,0.00])
% 
% semilogy(mean(mean(VF_PIVWT10.u(1:15:end,:,:),3),2)/VF_PIVWT10.u_tau,...
%     VF_PIVWT10.z(1:15:end,:)./VF_PIVWT10.z0,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','v','MarkerSize',8,'MarkerEdgeColor',[1.00,0.87,0.13],...
%     'MarkerFaceColor',[1.00,0.06,0.94])
% 
% semilogy(mean(mean(VF_GenWT10.HRVFu(1:30:end,:,:),3),2)/VF_GenWT10.u_tau,...
%     VF_GenWT10.HRVFz(1:30:end,:)./VF_GenWT10.z0,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','v','MarkerSize',8,'MarkerEdgeColor',[1.00,0.87,0.13],...
%     'MarkerFaceColor',[0.00,0.49,0.02])
% 
% 
% semilogy(mean(mean(VF_SLPIVASL.u(1:4:end,:,:),3),2)/VF_SLPIVASL.u_tau,...
%     VF_SLPIVASL.z(1:4:end,:)./VF_SLPIVASL.z0,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','o','MarkerSize',8,'MarkerEdgeColor',[1.00,0.09,0.09],...
%     'MarkerFaceColor',[0,0,0])
% 
% semilogy(mean(mean(VF_GenASL.HRVFu(1:35:end,:,:),3),2)/VF_GenASL.u_tau,...
%     VF_GenASL.HRVFz(1:35:end,:)./VF_GenASL.z0,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','o','MarkerSize',8,'MarkerEdgeColor',[1.00,0.09,0.09],...
%     'MarkerFaceColor',[0.22,1.00,0.08])
% 
% % scatter(mean(mean(VF_GenWT7.HRVFu(1:10:end,:,:),3),2)/VF_GenWT7.u_tau,...
% %     VF_GenWT7.HRVFz(1:10:end,:)./VF_GenWT7.z0,64, [0.17, 1.00, 0.72], 'filled', '^', ...
% %     'MarkerFaceAlpha', 0.5, 'MarkerEdgeAlpha', 0.5)
% xlim([4 20])
% ylim([0.5e1 5e5])
% set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
%     'XGrid','on','YGrid','on')
% ylabel('z/z$_{0}$','Interpreter','latex','FontSize',15)
% xlabel('$\overline{\mathrm{U}}/u_{\tau}$','Interpreter','latex','FontSize',15)
% legend('','PIV(m1)','Gen(m1)','PIV(m2)','Gen(m2)','SLPIV(ASL)','Gen(ASL)',... 
%    'Interpreter','latex','FontSize',12,'Position',...
%     [0.504670694345381,0.199004329908093,0.462708057103135,0.142999998092651],...
%     'Numcolumns',3,'Orientation','vertical','color',[0.94,0.94,0.94]);
% 
% axes('Position',[0.170639899623586,0.633333333333335,0.624843161856962,0.317550644567226])
% semilogx(VF_PIVWT7.z(1:10:end,1)./VF_PIVWT7.z0,mean(mean(VF_PIVWT7.w(1:10:end,:,:),3),2)/VF_PIVWT7.u_tau,...
%     'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,0.72,1.00],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
%     'MarkerFaceColor',[0.17,0.72,1.00])
% 
% hold on
% semilogx(VF_GenWT7.HRVFz(1:10:end,1)./VF_GenWT7.z0,mean(mean(VF_GenWT7.HRVFw(1:10:end,:,:),3),2)/VF_GenWT7.u_tau,...
%     'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
%     'MarkerFaceColor',[1.00,0.40,0.00])
% 
% semilogx(VF_PIVWT10.z(1:15:end,:)./VF_PIVWT10.z0,mean(mean(VF_PIVWT10.w(1:15:end,:,:),3),2)/VF_PIVWT10.u_tau,...
%     'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','v','MarkerSize',8,'MarkerEdgeColor',[1.00,0.87,0.13],...
%     'MarkerFaceColor',[1.00,0.06,0.94])
% 
% semilogx(VF_GenWT10.HRVFz(1:30:end,:)./VF_GenWT10.z0,mean(mean(VF_GenWT10.HRVFw(1:30:end,:,:),3),2)/VF_GenWT10.u_tau,...
%     'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','v','MarkerSize',8,'MarkerEdgeColor',[1.00,0.87,0.13],...
%     'MarkerFaceColor',[0.00,0.49,0.02])
% 
% 
% semilogx(VF_SLPIVASL.z(1:4:end,:)./VF_SLPIVASL.z0,mean(mean(VF_SLPIVASL.w(1:4:end,:,:),3),2)/VF_SLPIVASL.u_tau,...
%     'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','o','MarkerSize',8,'MarkerEdgeColor',[1.00,0.09,0.09],...
%     'MarkerFaceColor',[0,0,0])
% 
% semilogx(VF_GenASL.HRVFz(1:35:end,:)./VF_GenASL.z0,mean(mean(VF_GenASL.HRVFw(1:35:end,:,:),3),2)/VF_GenASL.u_tau,...
%     'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','o','MarkerSize',8,'MarkerEdgeColor',[1.00,0.09,0.09],...
%     'MarkerFaceColor',[0.22,1.00,0.08])
% 
% % scatter(mean(mean(VF_GenWT7.HRVFu(1:10:end,:,:),3),2)/VF_GenWT7.u_tau,...
% %     VF_GenWT7.HRVFz(1:10:end,:)./VF_GenWT7.z0,64, [0.17, 1.00, 0.72], 'filled', '^', ...
% %     'MarkerFaceAlpha', 0.5, 'MarkerEdgeAlpha', 0.5)
% ylim([-0.2 0.2])
% xlim([0.5e1 1e4])
% set(gca,'TickLabelInterpreter','latex','FontSize',14,'Box','on',...
%     'XGrid','on','YGrid','on')
% xlabel('z/z$_{0}$','Interpreter','latex','FontSize',14)
% ylabel('$\overline{\mathrm{W}}/u_{\tau}$','Interpreter','latex','FontSize',14)
% % legend('PIV(m1)','Gen(m1)','PIV(m2)','Gen(m2)','SLPIV(ASL)','Gen(ASL)',... 
% %    'Interpreter','latex','FontSize',9,'Position',...
% %     [0.817423406779439,0.226941218914142,0.14951924412557,0.309666659990946],...
% %     'Numcolumns',1,'Orientation','Horizontal');

%%% TKE
% figure% TKE
% axes('Position',[0.712732707769759,0.400525731408774,0.264724460850617,0.243542065201398])
% plot(VF_PIVWT7.z./VF_PIVWT7.delta,...
%     0.5*(mean(rms(VF_PIVWT7.w,3),2).^2+mean(rms(VF_PIVWT7.uprime,3),2).^2)...
%     /VF_PIVWT7.u_tau^2,'LineWidth',1.5,'color',...
%     [0.17,0.72,1.00],'LineStyle','-.')
% hold on
% plot(VF_PIVWT10.z./VF_PIVWT10.delta,...
%     0.5*(mean(rms(VF_PIVWT10.w,3),2).^2+mean(rms(VF_PIVWT10.uprime,3),2).^2)...
%     /VF_PIVWT10.u_tau^2,'LineWidth',1.5,'color',...
%     [1,0.0,0.00],'LineStyle','-.')
% 
% plot(VF_SLPIVASL.z./VF_SLPIVASL.delta,...
%     0.5*(mean(rms(VF_SLPIVASL.w,3),2).^2+mean(rms(VF_SLPIVASL.uprime,3),2).^2)...
%     /VF_SLPIVASL.u_tau^2,'LineWidth',1.5,'color',...
%     [0.0,0.0,0.0],'LineStyle','-.')
% 
% plot(VF_GenWT7.HRVFz./VF_GenWT7.delta,...
%     0.5*(mean(rms(VF_GenWT7.HRVFw,3),2).^2+mean(rms(VF_GenWT7.HRVFuprime,3),2).^2)...
%     /VF_GenWT7.u_tau^2,'LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'LineStyle','-.')
% 
% plot(VF_GenWT10.HRVFz./VF_GenWT10.delta,...
%     0.5*(mean(rms(VF_GenWT10.HRVFw,3),2).^2+mean(rms(VF_GenWT10.HRVFuprime,3),2).^2)...
%     /VF_GenWT10.u_tau^2,'LineWidth',1.5,'color',...
%     [1.00,0.17,0.72],'LineStyle','-.')
% 
% plot(VF_GenASL.HRVFz./VF_GenASL.delta,...
%     0.5*(mean(rms(VF_GenASL.HRVFw,3),2).^2+mean(rms(VF_GenASL.HRVFuprime,3),2).^2)...
%     /VF_GenASL.u_tau^2,'LineWidth',1.5,'color',...
%     [0.5,0.5,0.5],'LineStyle','-.')
% 
% xlabel('z/$\delta$','Interpreter','latex','FontSize',15)
% ylabel('$k/u_{\tau}^2$','Interpreter','latex','FontSize',15)
% set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
%     'XGrid','on','YGrid','on')
% ylim([2.2 3.4])
%%% u'u', w'w',u'w'
% figure
% set(gcf,'Position',[801,262,797,830])
% axes('Position',[0.081936493621915,0.683914792203862,0.899739583333334,0.247162673392175])
% semilogx(VF_PIVWT7.z(1:10:end,:)./VF_PIVWT7.z0,...
%     mean(rms(VF_PIVWT7.uprime(1:10:end,:,:),3),2).^2/VF_PIVWT7.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,0.72,1.00],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
%     'MarkerFaceColor',[0.17,0.72,1.00])
% hold on
% 
% semilogx(VF_GenWT7.HRVFz(1:10:end,:)./VF_GenWT7.z0,...
%     mean(rms(VF_GenWT7.HRVFuprime(1:10:end,:,:),3),2).^2/VF_GenWT7.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
%     'MarkerFaceColor',[1.00,0.40,0.00])
% 
% semilogx(VF_PIVWT10.z(1:15:end,:)./VF_PIVWT10.z0,...
%     mean(rms(VF_PIVWT10.uprime(1:15:end,:,:),3),2).^2/VF_PIVWT10.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','v','MarkerSize',8,'MarkerEdgeColor',[1.00,0.87,0.13],...
%     'MarkerFaceColor',[1.00,0.06,0.94])
% 
% semilogx(VF_GenWT10.HRVFz(1:30:end,:)./VF_GenWT10.z0,...
%     mean(rms(VF_GenWT10.HRVFuprime(1:30:end,:,:),3),2).^2/VF_GenWT10.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','v','MarkerSize',8,'MarkerEdgeColor',[1.00,0.87,0.13],...
%     'MarkerFaceColor',[0.00,0.49,0.02])
% 
% semilogx(VF_SLPIVASL.z(1:4:end,:)./VF_SLPIVASL.z0,...
%     mean(rms(VF_SLPIVASL.uprime(1:4:end,:,:),3),2).^2/VF_SLPIVASL.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','o','MarkerSize',8,'MarkerEdgeColor',[1.00,0.09,0.09],...
%     'MarkerFaceColor',[0,0,0])
% 
% 
% semilogx(VF_GenASL.HRVFz(1:35:end,:)./VF_GenASL.z0,...
%     mean(rms(VF_GenASL.HRVFuprime(1:35:end,:,:),3),2).^2/VF_GenASL.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','o','MarkerSize',8,'MarkerEdgeColor',[1.00,0.09,0.09],...
%     'MarkerFaceColor',[0.22,1.00,0.08])
% text(0.00976290097629,0.907317073170732,0,'(a)',...
%     'Units','Normalized','Interpreter','LaTex','FontSize',15);
% set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
%     'XGrid','on','YGrid','on')
% ylim([2 10])
% xlim([1e1 3e3])
% set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
%     'XGrid','on','YGrid','on')
% % xlabel('z/z$_{0}$','Interpreter','latex','FontSize',15)
% ylabel('$\overline{\mathrm{u^{\prime^{2}}}}/u_{\tau}^{2}$','Interpreter','latex','FontSize',15)
% legend('PIV(m1)','Gen(m1)','PIV(m2)','Gen(m2)','SLPIV(ASL)','Gen(ASL)',... 
%    'Interpreter','latex','FontSize',12,'Position',...
%     [0.275659576670274,0.943335654600331,0.462708057103134,0.051686746298549],...
%     'Numcolumns',3,'Orientation','vertical','color',[1,1,1]);
% 
% 
% axes('Position',[0.081936493621915,0.37661645673652,0.899739583333334,0.247162673392176])
% semilogx(VF_PIVWT7.z(1:10:end,:)./VF_PIVWT7.z0,...
%     mean(rms(VF_PIVWT7.w(1:10:end,:,:),3),2).^2/VF_PIVWT7.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,0.72,1.00],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
%     'MarkerFaceColor',[0.17,0.72,1.00])
% hold on
% 
% semilogx(VF_GenWT7.HRVFz(1:10:end,:)./VF_GenWT7.z0,...
%     mean(rms(VF_GenWT7.HRVFw(1:10:end,:,:),3),2).^2/VF_GenWT7.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
%     'MarkerFaceColor',[1.00,0.40,0.00])
% 
% semilogx(VF_PIVWT10.z(1:15:end,:)./VF_PIVWT10.z0,...
%     mean(rms(VF_PIVWT10.w(1:15:end,:,:),3),2).^2/VF_PIVWT10.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','v','MarkerSize',8,'MarkerEdgeColor',[1.00,0.87,0.13],...
%     'MarkerFaceColor',[1.00,0.06,0.94])
% 
% semilogx(VF_GenWT10.HRVFz(1:30:end,:)./VF_GenWT10.z0,...
%     mean(rms(VF_GenWT10.HRVFw(1:30:end,:,:),3),2).^2/VF_GenWT10.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','v','MarkerSize',8,'MarkerEdgeColor',[1.00,0.87,0.13],...
%     'MarkerFaceColor',[0.00,0.49,0.02])
% 
% semilogx(VF_SLPIVASL.z(1:4:end,:)./VF_SLPIVASL.z0,...
%     mean(rms(VF_SLPIVASL.w(1:4:end,:,:),3),2).^2/VF_SLPIVASL.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','o','MarkerSize',8,'MarkerEdgeColor',[1.00,0.09,0.09],...
%     'MarkerFaceColor',[0,0,0])
% 
% 
% semilogx(VF_GenASL.HRVFz(1:35:end,:)./VF_GenASL.z0,...
%     mean(rms(VF_GenASL.HRVFw(1:35:end,:,:),3),2).^2/VF_GenASL.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','o','MarkerSize',8,'MarkerEdgeColor',[1.00,0.09,0.09],...
%     'MarkerFaceColor',[0.22,1.00,0.08])
% text(0.00976290097629,0.907317073170732,0,'(b)',...
%     'Units','Normalized','Interpreter','LaTex','FontSize',15);
% set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
%     'XGrid','on','YGrid','on')
% ylim([0 3])
% xlim([1e1 3e3])
% set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
%     'XGrid','on','YGrid','on')
% % xlabel('z/z$_{0}$','Interpreter','latex','FontSize',15)
% ylabel('$\overline{\mathrm{w^{\prime^{2}}}}/u_{\tau}^{2}$','Interpreter','latex','FontSize',15)
% 
% 
% 
% axes('Position',[0.081936493621915,0.0718789407314,0.899739583333334,0.247162673392178])
% semilogx(VF_PIVWT7.z(1:10:end,:)./VF_PIVWT7.z0,...
%     -mean(mean(VF_PIVWT7.w(1:10:end,:,:).*VF_PIVWT7.uprime(1:10:end,:,:),3),2)...
%     /VF_PIVWT7.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,0.72,1.00],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
%     'MarkerFaceColor',[0.17,0.72,1.00])
% hold on
% 
% semilogx(VF_GenWT7.HRVFz(1:10:end,:)./VF_GenWT7.z0,...
%     -mean(mean(VF_GenWT7.HRVFw(1:10:end,:).*VF_GenWT7.HRVFuprime(1:10:end,:),3),2)...
%     /VF_GenWT7.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
%     'MarkerFaceColor',[1.00,0.40,0.00])
% 
% semilogx(VF_PIVWT10.z(1:15:end,:)./VF_PIVWT10.z0,...
%     -mean(mean(VF_PIVWT10.w(1:15:end,:,:).*VF_PIVWT10.uprime(1:15:end,:,:),3),2)...
%     /VF_PIVWT10.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','v','MarkerSize',8,'MarkerEdgeColor',[1.00,0.87,0.13],...
%     'MarkerFaceColor',[1.00,0.06,0.94])
% 
% semilogx(VF_GenWT10.HRVFz(1:30:end,:)./VF_GenWT10.z0,...
%     -mean(mean(VF_GenWT10.HRVFw(1:30:end,:,:).*VF_GenWT10.HRVFuprime(1:30:end,:,:),3),2)...
%     /VF_GenWT10.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','v','MarkerSize',8,'MarkerEdgeColor',[1.00,0.87,0.13],...
%     'MarkerFaceColor',[0.00,0.49,0.02])
% 
% 
% semilogx(VF_SLPIVASL.z(1:4:end,:)./VF_SLPIVASL.z0,...
%     -mean(mean(VF_SLPIVASL.w(1:4:end,:,:).*VF_SLPIVASL.uprime(1:4:end,:,:),3),2)...
%     /VF_SLPIVASL.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','o','MarkerSize',8,'MarkerEdgeColor',[1.00,0.09,0.09],...
%     'MarkerFaceColor',[0,0,0])
% 
% 
% semilogx(VF_GenASL.HRVFz(1:35:end,:)./VF_GenASL.z0,...
%     -mean(mean(VF_GenASL.HRVFw(1:35:end,:,:).*VF_GenASL.HRVFuprime(1:35:end,:,:),3),2)...
%     /VF_GenASL.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
%     [0.17,1.00,0.72],'Marker','o','MarkerSize',8,'MarkerEdgeColor',[1.00,0.09,0.09],...
%     'MarkerFaceColor',[0.22,1.00,0.08])
% text(0.00976290097629,0.907317073170732,0,'(c)',...
%     'Units','Normalized','Interpreter','LaTex','FontSize',15);
% ylim([0 1.5])
% xlim([1e1 3e3])
% set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
%     'XGrid','on','YGrid','on')
% xlabel('z/z$_{0}$','Interpreter','latex','FontSize',15)
% ylabel('$-\overline{\mathrm{u^{\prime}w^{\prime}}}/u_{\tau}^{2}$','Interpreter','latex','FontSize',15)

%% Statistics Mean streamwise and vertical
kappa = 0.39;
numPoints = 15; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_PIVWT7.z, 1)), numPoints));
figure
set(gcf,'Position',[768,789,797,300])
axes('Position',[0.079427083333333,0.186666666666667,0.899739583333334,0.803333333333333])
semilogy(1/kappa*log(linspace(6,10000,100)),...
    linspace(6,10000,100),'LineStyle','-','LineWidth',2,'color',...
    [0.93,0.69,0.13])
hold on
semilogy(mean(mean(VF_PIVWT7.u(1:10:end,:,:),3),2)/VF_PIVWT7.u_tau,...
    VF_PIVWT7.z(1:10:end,1)./VF_PIVWT7.z0,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,0.00,1.00],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
    'MarkerFaceColor',[0.00,0.00,1.00])

semilogy(mean(mean(X.HRVFu(1:10:end,:,:),3),2)/X.u_tau,...
    X.HRVFz(1:10:end,1)./X.z0,'LineStyle','-','LineWidth',2,'color',...
    [0.50,0.50,1.00],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[0.00,0.00,1.00],...
    'MarkerFaceColor','none')

semilogy(mean(mean(VF_GenWT7.HRVFu(1:10:end,:,:),3),2)/VF_GenWT7.u_tau,...
    VF_GenWT7.HRVFz(1:10:end,1)./VF_GenWT7.z0,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,0.00,1.00],'Marker','^','MarkerSize',10,'MarkerEdgeColor',[0.00,0.00,1.00],...
    'MarkerFaceColor','none')

semilogy(mean(mean(VF_PIVWT10.u(1:15:end,:,:),3),2)/VF_PIVWT10.u_tau,...
    VF_PIVWT10.z(1:15:end,:)./VF_PIVWT10.z0,'LineStyle','none','LineWidth',1.5,'color',...
    [1.00,0.00,0.00],'Marker','O','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
    'MarkerFaceColor',[1.00,0.00,0.00])

semilogy(mean(mean(Y.HRVFu(1:30:end,:,:),3),2)/Y.u_tau,...
    Y.HRVFz(1:30:end,:)./Y.z0,'LineStyle','--','LineWidth',2.5,'color',...
    [1.00,0.50,0.50],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[1.00,0.00,0.00],...
    'MarkerFaceColor','none')

semilogy(mean(mean(VF_GenWT10.HRVFu(1:30:end,:,:),3),2)/VF_GenWT10.u_tau,...
    VF_GenWT10.HRVFz(1:30:end,:)./VF_GenWT10.z0,'LineStyle','none','LineWidth',2.5,'color',...
    [1.00,0.00,0.00],'Marker','O','MarkerSize',10,'MarkerEdgeColor',[1.00,0.00,0.00],...
    'MarkerFaceColor','none')


semilogy(mean(mean(VF_SLPIVASL.u(1:4:end,:,:),3),2)/VF_SLPIVASL.u_tau,...
    VF_SLPIVASL.z(1:4:end,:)./VF_SLPIVASL.z0,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,1.00,0.00],'Marker','d','MarkerSize',8,'MarkerEdgeColor',[0.00,0.00,0.00],...
    'MarkerFaceColor',[0.00,1.00,0.00])

semilogy(mean(mean(Z.HRVFu(1:35:end,:,:),3),2)/Z.u_tau,...
    Z.HRVFz(1:35:end,:)./Z.z0,'LineStyle','-.','LineWidth',2.5,'color',...
    [0.50,1.00,0.50],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[0.00,1.00,0.00],...
    'MarkerFaceColor','none')

semilogy(mean(mean(VF_GenASL.HRVFu(1:35:end,:,:),3),2)/VF_GenASL.u_tau,...
    VF_GenASL.HRVFz(1:35:end,:)./VF_GenASL.z0,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,1.00,0.00],'Marker','d','MarkerSize',10,'MarkerEdgeColor',[0.00,1.00,0.00],...
    'MarkerFaceColor','none')

% scatter(mean(mean(VF_GenWT7.HRVFu(1:10:end,:,:),3),2)/VF_GenWT7.u_tau,...
%     VF_GenWT7.HRVFz(1:10:end,:)./VF_GenWT7.z0,64, [0.17, 1.00, 0.72], 'filled', '^', ...
%     'MarkerFaceAlpha', 0.5, 'MarkerEdgeAlpha', 0.5)
xlim([4 20])
ylim([0.5e1 5e5])
set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
    'XGrid','on','YGrid','on')
ylabel('z/z$_{0}$','Interpreter','latex','FontSize',15)
xlabel('$\overline{\mathrm{U}}/u_{\tau}$','Interpreter','latex','FontSize',15)
legend('','PIV(m1)','LR-Gen(m1)','HR+VorX-Gen(m1)','PIV(m2)','LR-Gen(m2)','HR+VorX-Gen(m2)',...
    'SLPIV(ASL)','LR-Gen(ASL)','HR+VorX-Gen(ASL)',... 
   'Interpreter','latex','FontSize',12,'Position',...
    [0.504670694345381,0.199004329908093,0.462708057103135,0.142999998092651],...
    'Numcolumns',3,'Orientation','vertical','color',[0.94,0.94,0.94]);

axes('Position',[0.170639899623586,0.633333333333335,0.624843161856962,0.317550644567226])
semilogx(VF_PIVWT7.z(1:10:end,1)./VF_PIVWT7.z0,mean(mean(VF_PIVWT7.w(1:10:end,:,:),3),2)/VF_PIVWT7.u_tau,...
    'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,0.00,1.00],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
    'MarkerFaceColor',[0.00,0.00,1.00])

hold on
semilogx(VF_GenWT7.HRVFz(1:10:end,1)./VF_GenWT7.z0,mean(mean(VF_GenWT7.HRVFw(1:10:end,:,:),3),2)/VF_GenWT7.u_tau,...
    'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,0.00,1.00],'Marker','^','MarkerSize',10,'MarkerEdgeColor',[0.00,0.00,1.00],...
    'MarkerFaceColor','none')

semilogx(VF_PIVWT10.z(1:15:end,:)./VF_PIVWT10.z0,mean(mean(VF_PIVWT10.w(1:15:end,:,:),3),2)/VF_PIVWT10.u_tau,...
    'LineStyle','none','LineWidth',1.5,'color',...
    [1.00,0.00,0.00],'Marker','O','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
    'MarkerFaceColor',[1.00,0.00,0.00])

semilogx(VF_GenWT10.HRVFz(1:30:end,:)./VF_GenWT10.z0,mean(mean(VF_GenWT10.HRVFw(1:30:end,:,:),3),2)/VF_GenWT10.u_tau,...
    'LineStyle','none','LineWidth',2.5,'color',...
    [1.00,0.00,0.00],'Marker','O','MarkerSize',10,'MarkerEdgeColor',[1.00,0.00,0.00],...
    'MarkerFaceColor','none')


semilogx(VF_SLPIVASL.z(1:4:end,:)./VF_SLPIVASL.z0,mean(mean(VF_SLPIVASL.w(1:4:end,:,:),3),2)/VF_SLPIVASL.u_tau,...
    'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,1.00,0.00],'Marker','d','MarkerSize',8,'MarkerEdgeColor',[0.00,0.00,0.00],...
    'MarkerFaceColor',[0.00,1.00,0.00])

semilogx(VF_GenASL.HRVFz(1:35:end,:)./VF_GenASL.z0,mean(mean(VF_GenASL.HRVFw(1:35:end,:,:),3),2)/VF_GenASL.u_tau,...
    'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,1.00,0.00],'Marker','d','MarkerSize',10,'MarkerEdgeColor',[0.00,1.00,0.00],...
    'MarkerFaceColor','none')

% scatter(mean(mean(VF_GenWT7.HRVFu(1:10:end,:,:),3),2)/VF_GenWT7.u_tau,...
%     VF_GenWT7.HRVFz(1:10:end,:)./VF_GenWT7.z0,64, [0.17, 1.00, 0.72], 'filled', '^', ...
%     'MarkerFaceAlpha', 0.5, 'MarkerEdgeAlpha', 0.5)
ylim([-0.2 0.2])
xlim([0.5e1 1e4])
set(gca,'TickLabelInterpreter','latex','FontSize',14,'Box','on',...
    'XGrid','on','YGrid','on')
xlabel('z/z$_{0}$','Interpreter','latex','FontSize',14)
ylabel('$\overline{\mathrm{W}}/u_{\tau}$','Interpreter','latex','FontSize',14)
% legend('PIV(m1)','Gen(m1)','PIV(m2)','Gen(m2)','SLPIV(ASL)','Gen(ASL)',... 
%    'Interpreter','latex','FontSize',9,'Position',...
%     [0.817423406779439,0.226941218914142,0.14951924412557,0.309666659990946],...
%     'Numcolumns',1,'Orientation','Horizontal');

%% Statistics Mean streamwise 
kappa = 0.39;
numPoints = 15; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_PIVWT7.z, 1)), numPoints));
figure
set(gcf,'Position',[768,789,797,300])
axes('Position',[0.079427083333333,0.186666666666667,0.899739583333334,0.803333333333333])
semilogy(1/kappa*log(linspace(6,10000,100)),...
    linspace(6,10000,100),'LineStyle','-','LineWidth',2,'color',...
    [1.00,0.74,0.17])
hold on
semilogy(mean(mean(VF_PIVWT7.u(1:10:end,:,:),3),2)/VF_PIVWT7.u_tau,...
    VF_PIVWT7.z(1:10:end,1)./VF_PIVWT7.z0,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,0.00,1.00],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
    'MarkerFaceColor',[0.00,0.00,1.00])

semilogy(mean(mean(X.HRVFu(1:10:end,:,:),3),2)/X.u_tau,...
    X.HRVFz(1:10:end,1)./X.z0,'LineStyle','-','LineWidth',2,'color',...
    [0.50,0.50,1.00],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[0.00,0.00,1.00],...
    'MarkerFaceColor','none')

semilogy(mean(mean(VF_GenWT7.HRVFu(1:10:end,:,:),3),2)/VF_GenWT7.u_tau,...
    VF_GenWT7.HRVFz(1:10:end,1)./VF_GenWT7.z0,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,0.00,1.00],'Marker','^','MarkerSize',10,'MarkerEdgeColor',[0.00,0.00,1.00],...
    'MarkerFaceColor','none')

semilogy(mean(mean(VF_PIVWT10.u(1:15:end,:,:),3),2)/VF_PIVWT10.u_tau,...
    VF_PIVWT10.z(1:15:end,:)./VF_PIVWT10.z0,'LineStyle','none','LineWidth',1.5,'color',...
    [1.00,0.00,0.00],'Marker','O','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
    'MarkerFaceColor',[1.00,0.00,0.00])

semilogy(mean(mean(Y.HRVFu(1:30:end,:,:),3),2)/Y.u_tau,...
    Y.HRVFz(1:30:end,:)./Y.z0,'LineStyle','--','LineWidth',2.5,'color',...
    [1.00,0.50,0.50],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[1.00,0.00,0.00],...
    'MarkerFaceColor','none')

semilogy(mean(mean(VF_GenWT10.HRVFu(1:30:end,:,:),3),2)/VF_GenWT10.u_tau,...
    VF_GenWT10.HRVFz(1:30:end,:)./VF_GenWT10.z0,'LineStyle','none','LineWidth',2.5,'color',...
    [1.00,0.00,0.00],'Marker','O','MarkerSize',10,'MarkerEdgeColor',[1.00,0.00,0.00],...
    'MarkerFaceColor','none')


semilogy(mean(mean(VF_SLPIVASL.u(1:4:end,:,:),3),2)/VF_SLPIVASL.u_tau,...
    VF_SLPIVASL.z(1:4:end,:)./VF_SLPIVASL.z0,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,1.00,0.00],'Marker','d','MarkerSize',8,'MarkerEdgeColor',[0.00,0.00,0.00],...
    'MarkerFaceColor',[0.00,1.00,0.00])

semilogy(mean(mean(Z.HRVFu(1:35:end,:,:),3),2)/Z.u_tau,...
    Z.HRVFz(1:35:end,:)./Z.z0,'LineStyle','-.','LineWidth',2.5,'color',...
    [0.00,0.60,0.00],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[0.00,1.00,0.00],...
    'MarkerFaceColor','none')

semilogy(mean(mean(VF_GenASL.HRVFu(1:35:end,:,:),3),2)/VF_GenASL.u_tau,...
    VF_GenASL.HRVFz(1:35:end,:)./VF_GenASL.z0,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,1.00,0.00],'Marker','d','MarkerSize',10,'MarkerEdgeColor',[0.00,1.00,0.00],...
    'MarkerFaceColor','none')

% scatter(mean(mean(VF_GenWT7.HRVFu(1:10:end,:,:),3),2)/VF_GenWT7.u_tau,...
%     VF_GenWT7.HRVFz(1:10:end,:)./VF_GenWT7.z0,64, [0.17, 1.00, 0.72], 'filled', '^', ...
%     'MarkerFaceAlpha', 0.5, 'MarkerEdgeAlpha', 0.5)
xlim([4 20])
ylim([0.5e1 2e4])
set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
    'XGrid','on','YGrid','on')
ylabel('z/z$_{0}$','Interpreter','latex','FontSize',15)
xlabel('$\overline{\mathrm{U}}/u_{\tau}$','Interpreter','latex','FontSize',15)
legend('','PIV(m1)','LR-Gen(m1)','HR+VorX-Gen(m1)','PIV(m2)','LR-Gen(m2)','HR+VorX-Gen(m2)',...
    'SLPIV(ASL)','LR-Gen(ASL)','HR+VorX-Gen(ASL)',... 
   'Interpreter','latex','FontSize',12,'Position',...
    [0.100502120703601,0.752837663718266,0.734031402630106,0.208666663805644],...
    'Numcolumns',3,'Orientation','vertical','color',[0.94,0.94,0.94]);


%% u'u', w'w',u'w'(Active)
figure
set(gcf,'Position',[801,262,797,830])
axes('Position',[0.081936493621915,0.66343286449302,0.899739583333334,0.247162673392175])

semilogx(VF_PIVWT7.z(1:10:end,:)./VF_PIVWT7.z0,...
    mean(rms(VF_PIVWT7.uprime(1:10:end,:,:),3),2).^2/VF_PIVWT7.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,0.00,1.00],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
    'MarkerFaceColor',[0.00,0.00,1.00])
hold on

semilogx(X.HRVFz(1:10:end,:)./X.z0,...
    mean(rms(X.HRVFuprime(1:10:end,:,:),3),2).^2/X.u_tau^2,'LineStyle','-','LineWidth',1.5,'color',...
    [0.5,0.5,1.00],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[0.06,1.00,1.00],...
    'MarkerFaceColor',[0.00,0.00,1.00])

semilogx(VF_GenWT7.HRVFz(1:10:end,:)./VF_GenWT7.z0,...
    mean(rms(VF_GenWT7.HRVFuprime(1:10:end,:,:),3),2).^2/VF_GenWT7.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,0.00,1.00],'Marker','^','MarkerSize',10,'MarkerEdgeColor',[0,0,1.00],...
    'MarkerFaceColor','none')

semilogx(VF_PIVWT10.z(1:15:end,:)./VF_PIVWT10.z0,...
    mean(rms(VF_PIVWT10.uprime(1:15:end,:,:),3),2).^2/VF_PIVWT10.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [1.00,0.00,0.00],'Marker','O','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
    'MarkerFaceColor',[1.00,0.00,0.00])

semilogx(Y.HRVFz(1:30:end,:)./Y.z0,...
    mean(rms(Y.HRVFuprime(1:30:end,:,:),3),2).^2/Y.u_tau^2,'LineStyle','--','LineWidth',2.5,'color',...
    [1.00,0.50,0.50],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[0.00,0.00,1.00],...
    'MarkerFaceColor',[1.00,0.00,0.00])

semilogx(VF_GenWT10.HRVFz(1:30:end,:)./VF_GenWT10.z0,...
    mean(rms(VF_GenWT10.HRVFuprime(1:30:end,:,:),3),2).^2/VF_GenWT10.u_tau^2,'LineStyle','none','LineWidth',2.5,'color',...
    [1.00,0.00,0.00],'Marker','O','MarkerSize',10,'MarkerEdgeColor',[1.00, 0.00,0.00],...
    'MarkerFaceColor','none')

semilogx(VF_SLPIVASL.z(1:4:end,:)./VF_SLPIVASL.z0,...
    mean(rms(VF_SLPIVASL.uprime(1:4:end,:,:),3),2).^2/VF_SLPIVASL.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,1.00,0.00],'Marker','d','MarkerSize',8,'MarkerEdgeColor',[0.00,0.00,0.00],...
    'MarkerFaceColor',[0.00,1.00,0.00])

semilogx(Z.HRVFz(1:35:end,:)./Z.z0,...
    mean(rms(Z.HRVFuprime(1:35:end,:,:),3),2).^2/Z.u_tau^2,'LineStyle','-.','LineWidth',2,'color',...
    [0.00,0.60,0.00],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[1.00,0.00,0.00],...
    'MarkerFaceColor',[0.00,1.00,0.00])

semilogx(VF_GenASL.HRVFz(1:35:end,:)./VF_GenASL.z0,...
    mean(rms(VF_GenASL.HRVFuprime(1:35:end,:,:),3),2).^2/VF_GenASL.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,1.00,0.00],'Marker','d','MarkerSize',10,'MarkerEdgeColor',[0.00,1.00,0.00],...
    'MarkerFaceColor','none')
text(0.00976290097629,0.907317073170732,0,'(a)',...
    'Units','Normalized','Interpreter','LaTex','FontSize',15);
set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
    'XGrid','on','YGrid','on')
ylim([2 10])
xlim([1e1 3e3])
set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
    'XGrid','on','YGrid','on')
% xlabel('z/z$_{0}$','Interpreter','latex','FontSize',15)
ylabel('$\overline{\mathrm{u^{\prime^{2}}}}/u_{\tau}^{2}$','Interpreter','latex','FontSize',15)
legend('PIV(m1)','LR-Gen(m1)','HR+VorX-Gen(m1)','PIV(m2)','LR-Gen(m2)','HR+VorX-Gen(m2)','SLPIV(ASL)','LR-Gen(ASL)','HR+VorX-Gen(ASL)',... 
   'Interpreter','latex','FontSize',12,'Position',...
    [0.150872030787637,0.919419992122079,0.712283148868407,0.075421685712883],...
    'Numcolumns',3,'Orientation','vertical','color',[1,1,1]);


axes('Position',[0.081936493621915,0.362158625411219,0.899739583333334,0.247162673392176])
semilogx(VF_PIVWT7.z(1:10:end,:)./VF_PIVWT7.z0,...
    mean(rms(VF_PIVWT7.w(1:10:end,:,:),3),2).^2/VF_PIVWT7.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,0.00,1.00],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
    'MarkerFaceColor',[0.00,0.00,1.00])
hold on

semilogx(X.HRVFz(1:10:end,:)./X.z0,...
    mean(rms(X.HRVFw(1:10:end,:,:),3),2).^2/X.u_tau^2,'LineStyle','-','LineWidth',1.5,'color',...
    [0.5,0.5,1.00],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[0.06,1.00,1.00],...
    'MarkerFaceColor',[0.00,0.00,1.00])

semilogx(VF_GenWT7.HRVFz(1:10:end,:)./VF_GenWT7.z0,...
    mean(rms(VF_GenWT7.HRVFw(1:10:end,:,:),3),2).^2/VF_GenWT7.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,0.00,1.00],'Marker','^','MarkerSize',10,'MarkerEdgeColor',[0.00,0.00,1.00],...
    'MarkerFaceColor','none')

semilogx(VF_PIVWT10.z(1:15:end,:)./VF_PIVWT10.z0,...
    mean(rms(VF_PIVWT10.w(1:15:end,:,:),3),2).^2/VF_PIVWT10.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [1.00,0.00,0.00],'Marker','O','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
    'MarkerFaceColor',[1.00,0.00,0.00])

semilogx(Y.HRVFz(1:30:end,:)./Y.z0,...
    mean(rms(Y.HRVFw(1:30:end,:,:),3),2).^2/Y.u_tau^2,'LineStyle','--','LineWidth',2.5,'color',...
    [1.00,0.50,0.50],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[0.00,0.00,1.00],...
    'MarkerFaceColor',[1.00,0.00,0.00])

semilogx(VF_GenWT10.HRVFz(1:30:end,:)./VF_GenWT10.z0,...
    mean(rms(VF_GenWT10.HRVFw(1:30:end,:,:),3),2).^2/VF_GenWT10.u_tau^2,'LineStyle','none','LineWidth',2.5,'color',...
    [1.00,0.00,0.00],'Marker','O','MarkerSize',10,'MarkerEdgeColor',[1.00,0.00,0.00],...
    'MarkerFaceColor','none')

semilogx(VF_SLPIVASL.z(1:4:end,:)./VF_SLPIVASL.z0,...
    mean(rms(VF_SLPIVASL.w(1:4:end,:,:),3),2).^2/VF_SLPIVASL.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,1.00,0.00],'Marker','d','MarkerSize',8,'MarkerEdgeColor',[0.00,0.00,0.00],...
    'MarkerFaceColor',[0.00,1.00,0.00])

semilogx(Z.HRVFz(1:35:end,:)./Z.z0,...
    mean(rms(Z.HRVFw(1:35:end,:,:),3),2).^2/Z.u_tau^2,'LineStyle','-.','LineWidth',2,'color',...
    [0.00,0.60,0.00],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[1.00,0.00,0.00],...
    'MarkerFaceColor',[0.00,1.00,0.00])

semilogx(VF_GenASL.HRVFz(1:35:end,:)./VF_GenASL.z0,...
    mean(rms(VF_GenASL.HRVFw(1:35:end,:,:),3),2).^2/VF_GenASL.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,1.00,0.00],'Marker','d','MarkerSize',10,'MarkerEdgeColor',[0.00,1.00,0.00],...
    'MarkerFaceColor','none')
text(0.00976290097629,0.907317073170732,0,'(b)',...
    'Units','Normalized','Interpreter','LaTex','FontSize',15);
set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
    'XGrid','on','YGrid','on')
ylim([0 3])
xlim([1e1 3e3])
set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
    'XGrid','on','YGrid','on')
% xlabel('z/z$_{0}$','Interpreter','latex','FontSize',15)
ylabel('$\overline{\mathrm{w^{\prime^{2}}}}/u_{\tau}^{2}$','Interpreter','latex','FontSize',15)



axes('Position',[0.081936493621915,0.064650025068749,0.899739583333334,0.247162673392178])
semilogx(VF_PIVWT7.z(1:10:end,:)./VF_PIVWT7.z0,...
    -mean(mean(VF_PIVWT7.w(1:10:end,:,:).*VF_PIVWT7.uprime(1:10:end,:,:),3),2)...
    /VF_PIVWT7.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,0.00,1.00],'Marker','^','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
    'MarkerFaceColor',[0.00,0.00,1.00])
hold on

semilogx(X.HRVFz(1:10:end,:)./X.z0,...
    -mean(mean(X.HRVFw(1:10:end,:).*X.HRVFuprime(1:10:end,:),3),2)...
    /X.u_tau^2,'LineStyle','-','LineWidth',1.5,'color',...
    [0.5,0.5,1.00],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[0.06,1.00,1.00],...
    'MarkerFaceColor',[0.00,0.00,1.00])

semilogx(VF_GenWT7.HRVFz(1:10:end,:)./VF_GenWT7.z0,...
    -mean(mean(VF_GenWT7.HRVFw(1:10:end,:).*VF_GenWT7.HRVFuprime(1:10:end,:),3),2)...
    /VF_GenWT7.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,0.00,1.00],'Marker','^','MarkerSize',10,'MarkerEdgeColor',[0.00,0.00,1.00],...
    'MarkerFaceColor','none')

semilogx(VF_PIVWT10.z(1:15:end,:)./VF_PIVWT10.z0,...
    -mean(mean(VF_PIVWT10.w(1:15:end,:,:).*VF_PIVWT10.uprime(1:15:end,:,:),3),2)...
    /VF_PIVWT10.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [1.00,0.00,0.00],'Marker','O','MarkerSize',8,'MarkerEdgeColor',[0,0,0],...
    'MarkerFaceColor',[1.00,0.00,0.00])

semilogx(Y.HRVFz(1:30:end,:)./Y.z0,...
    -mean(mean(Y.HRVFw(1:30:end,:,:).*Y.HRVFuprime(1:30:end,:,:),3),2)...
    /Y.u_tau^2,'LineStyle','--','LineWidth',2.5,'color',...
    [1.00,0.50,0.50],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[0.00,0.00,1.00],...
    'MarkerFaceColor',[1.00,0.00,0.00])

semilogx(VF_GenWT10.HRVFz(1:30:end,:)./VF_GenWT10.z0,...
    -mean(mean(VF_GenWT10.HRVFw(1:30:end,:,:).*VF_GenWT10.HRVFuprime(1:30:end,:,:),3),2)...
    /VF_GenWT10.u_tau^2,'LineStyle','none','LineWidth',2.5,'color',...
    [1.00,0.00,0.00],'Marker','O','MarkerSize',10,'MarkerEdgeColor',[1.00,0.00,0.00],...
    'MarkerFaceColor','none')


semilogx(VF_SLPIVASL.z(1:4:end,:)./VF_SLPIVASL.z0,...
    -mean(mean(VF_SLPIVASL.w(1:4:end,:,:).*VF_SLPIVASL.uprime(1:4:end,:,:),3),2)...
    /VF_SLPIVASL.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,1.00,0.00],'Marker','d','MarkerSize',8,'MarkerEdgeColor',[0.00,0.00,0.00],...
    'MarkerFaceColor',[0.00,1.00,0.00])

semilogx(Z.HRVFz(1:35:end,:)./Z.z0,...
    -mean(mean(Z.HRVFw(1:35:end,:,:).*Z.HRVFuprime(1:35:end,:,:),3),2)...
    /Z.u_tau^2,'LineStyle','-.','LineWidth',2,'color',...
    [0.00,0.60,0.00],'Marker','none','MarkerSize',10,'MarkerEdgeColor',[1.00,0.00,0.00],...
    'MarkerFaceColor',[0.00,1.00,0.00])

semilogx(VF_GenASL.HRVFz(1:35:end,:)./VF_GenASL.z0,...
    -mean(mean(VF_GenASL.HRVFw(1:35:end,:,:).*VF_GenASL.HRVFuprime(1:35:end,:,:),3),2)...
    /VF_GenASL.u_tau^2,'LineStyle','none','LineWidth',1.5,'color',...
    [0.00,1.00,0.00],'Marker','d','MarkerSize',10,'MarkerEdgeColor',[0.00,1.00,0.00],...
    'MarkerFaceColor','none')
text(0.00976290097629,0.907317073170732,0,'(c)',...
    'Units','Normalized','Interpreter','LaTex','FontSize',15);
ylim([0.25 1.5])
xlim([1e1 3e3])
set(gca,'TickLabelInterpreter','latex','FontSize',15,'Box','on',...
    'XGrid','on','YGrid','on')
xlabel('z/z$_{0}$','Interpreter','latex','FontSize',15)
ylabel('$-\overline{\mathrm{u^{\prime}w^{\prime}}}/u_{\tau}^{2}$','Interpreter','latex','FontSize',15)
%% Velocity signal
Snshot = 10;
fac = 20;
ind_Gen_WT7_4 = 4;
figure
set(gcf,'Position',[831,412,806,366])
axes('Position',[0.071960297766749,0.120218579234973,0.485111662531017,0.851209992193598])
plot(VF_GenWT7.HRVFx/VF_GenWT7.Delx,VF_GenWT7.HRVFuprime(ind_Gen_WT7_4 ,:,Snshot),'-r')
set(gca,'TickLabelInterpreter','latex','FontSize',13)
xlabel('$\mathrm{x}/\Delta \mathrm{x}_{\mathrm{LR}}$','Interpreter','Latex','FontSize',14);
ylabel('$\mathrm{u}^{\prime}$','Interpreter','Latex','FontSize',14);
legend(sprintf('HR-Gen(m1) z$/\\delta$ = %.2f',VF_GenWT7.z(ind_Gen_WT7_4)/VF_GenWT7.delta),...
    'Interpreter','latex','FontSize',10,'Position',...
    [0.307779669126213,0.208056875971248,0.240241298655034,0.054644807440336],...
    'Numcolumns',1,'Orientation','vertical','color','none');
set(gca,'TickLabelInterpreter','latex','FontSize',13)
% xlim([0.01 0.02])

figure
set(gcf,'Position',[609,521,926,420])
axes('Position',[0.058315334773218,0.11,0.920592853812391,0.861428571428571])
plot(VF_GenWT7.HRVFx,VF_GenWT7.HRVFu(203,:,Snshot),'-r')
set(gca,'TickLabelInterpreter','latex','FontSize',13)
xlabel('x','Interpreter','Latex','FontSize',14);
ylabel('u','Interpreter','Latex','FontSize',14);
xlim([0.01 0.02])

figure
set(gcf,'Position',[609,521,926,420])
axes('Position',[0.058315334773218,0.11,0.920592853812391,0.861428571428571])
plot(VF_GenWT10.HRVFx(9*fac:16*fac)/(VF_GenWT10.Delx),VF_GenWT10.HRVFu(15,9*fac:16*fac,Snshot),'-b')
set(gca,'TickLabelInterpreter','latex','FontSize',13)
xlabel('x/$\lambda_{T}$','Interpreter','Latex','FontSize',14);
ylabel('u','Interpreter','Latex','FontSize',14);
xlim([9 16])

fac = 10;
figure
set(gcf,'Position',[609,521,926,420])
axes('Position',[0.058315334773218,0.11,0.920592853812391,0.861428571428571])
plot(VF_GenASL.HRVFx,VF_GenASL.HRVFu(64,:,Snshot),'-k')
set(gca,'TickLabelInterpreter','latex','FontSize',13)
xlabel('x','Interpreter','Latex','FontSize',14);
ylabel('u','Interpreter','Latex','FontSize',14);
% xlim([9 16])

%% Generated spectra and Experimental

ind_Gen_WT7_4 = 4;%VF_GenWT7.z(4)/VF_GenWT7.delta
ind_exp_WT7_1 = 1;%VF_HotWT7.z(1)/VF_HotWT7.delta

ind_Gen_WT10_21 = 21;%VF_GenWT10.z(21)/VF_GenWT10.delta
ind_exp_WT10_2 = 2;%VF_HotWT10.z(2)/VF_HotWT10.delta

figure
set(gcf,'Position',[973,562,797,383])
axes('Position',[0.092848180677541,0.130548302872063,0.404015056461731,0.840731070496083])
loglog((3e-4:1e-5:1),(3e-4:1e-5:1).^(-5/3),'linewidth',2,'color',[1.00,0.74,0.17],'lineStyle',':')
hold on
loglog(linspace(5e-7,5,size(VF_GenWT7.wavenumb,1)),ones(size(VF_GenWT7.wavenumb)),'k--','linewidth',1.5)
loglog(ones(size(VF_GenWT7.wavenumb)),linspace(1e-8,10,size(VF_GenWT7.wavenumb,1)),'k--','linewidth',1.5)

numPoints = 25; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_HotWT7.wavenumb{ind_exp_WT7_1,1}, 1)), numPoints));

loglog(VF_HotWT7.wavenumb{ind_exp_WT7_1,1}(logIndices,1)*mean([VF_HotWT7.eta_str{ind_exp_WT7_1,1}{:}],2),...
    VF_HotWT7.PowSpecDen_k{ind_exp_WT7_1,1}(logIndices,1)/(mean([VF_HotWT7.epsilon_str{ind_exp_WT7_1,1}{:}],2)*VF_HotWT7.nu^5)^(1/4),...
    'linewidth',2,'color',[0.2549, 0.4118, 0.8824],'LineStyle','-')
% VF_HotWT7.epsilon_spec(ind_exp_WT7_1,1)
numPoints = 30; % Adjust as needed
logIndices = round(logspace(0, log10(size(X.wavenumb, 1)), numPoints));

% loglog(X.wavenumb(logIndices,1)*mean(X.eta_str(ind_Gen_WT7_4,:),2),X.PowSpecDen_k(ind_Gen_WT7_4,logIndices)/...
%     (mean(X.epsilon_str(ind_Gen_WT7_4,:),2)*X.nu^5)^(1/4),'--',...
%     'linewidth',2.5,'color',[0.5294, 0.8078, 0.9216])

loglog(X.wavenumb(logIndices,1)*mean(X.eta_str(ind_Gen_WT7_4,:),2),X.PowSpecDen_k(ind_Gen_WT7_4,logIndices)/...
    (X.epsilon_spec(1,ind_Gen_WT7_4)*X.nu^5)^(1/4),'--',...
    'linewidth',2.5,'color',[0.5294, 0.8078, 0.9216])

numPoints = 30; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_GenWT7.wavenumb, 1)), numPoints));

% loglog(VF_GenWT7.wavenumb(logIndices,1)*mean(VF_GenWT7.eta_str(ind_Gen_WT7_4,:),2),VF_GenWT7.PowSpecDen_k(ind_Gen_WT7_4,logIndices)/...
%     (mean(VF_GenWT7.epsilon_str(ind_Gen_WT7_4,:),2)*VF_GenWT7.nu^5)^(1/4),'-.',...
%     'linewidth',2,'color',[0.0, 0.5020, 0.5020])

loglog(VF_GenWT7.wavenumb(logIndices,1)*mean(VF_GenWT7.eta_str(ind_Gen_WT7_4,:),2),VF_GenWT7.PowSpecDen_k(ind_Gen_WT7_4,logIndices)/...
    (VF_GenWT7.epsilon_spec(1,ind_Gen_WT7_4)*VF_GenWT7.nu^5)^(1/4),'-.',...
    'linewidth',2,'color',[0.0, 0.5020, 0.5020])
%0.4157, 0.3529, 0.8039

xlabel('$\mathrm{k}_{1}\eta$','Interpreter','latex')
ylabel('$\mathrm{E}_{11}(\mathrm{k}_{1})/(\varepsilon \nu^5)^{1/4}$','Interpreter','latex')
text(-0.207404701010839,0.973903287697961,0,'(a)',...
    'Units','Normalized','Interpreter','LaTex','FontSize',15);
set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on',...
    'YTick', [1e-6,1e0,1e6])
xlim([1e-4 10])
ylim([1e-6 1e6])
annotation(gcf,'textbox',...
    [0.18295659504391,0.877502175805047,0.093078536700127,0.069160798122066],...
    'String',{'$(\mathrm{k}_{1}\eta)^{-5/3}$'},...
    'Interpreter','latex',...
    'FontSize',13,...
    'FitBoxToText','off',...
    'EdgeColor','none');
legend('','','',...
    sprintf('H-W(m1) z$/\\delta$ = %.2f',VF_HotWT7.z(ind_exp_WT7_1)/VF_HotWT7.delta),...
    sprintf('LR-Gen(m1) z$/\\delta$ = %.2f',X.z(ind_Gen_WT7_4)/X.delta),...
    sprintf('HR+VorX-Gen(m1) z$/\\delta$ = %.2f',VF_GenWT7.z(ind_Gen_WT7_4)/VF_GenWT7.delta),...
    'Interpreter','latex','FontSize',10,'Position',...
    [0.098570263547366,0.202463733035891,0.294583073232871,0.138381197309368],...
    'Numcolumns',1,'Orientation','vertical','color','none');
set(gca,'TickLabelInterpreter','latex','FontSize',13)
axis square


axes('Position',[0.590966122961095,0.130548302872063,0.404015056461725,0.840731070496083])
loglog((3e-4:1e-5:1),(3e-4:1e-5:1).^(-5/3),'linewidth',2,'color',[1.00,0.74,0.17],'lineStyle',':')
hold on
loglog(linspace(5e-7,5,size(VF_GenWT7.wavenumb,1)),ones(size(VF_GenWT7.wavenumb)),'k--','linewidth',1.5)
loglog(ones(size(VF_GenWT7.wavenumb)),linspace(1e-6,10,size(VF_GenWT7.wavenumb,1)),'k--','linewidth',1.5)

numPoints = 100; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_HotWT10.wavenumb{ind_exp_WT10_2,1}, 1)), numPoints));

loglog(VF_HotWT10.wavenumb{ind_exp_WT10_2,1}(logIndices,1)*mean([VF_HotWT10.eta_str{ind_exp_WT10_2,1}{:}],2),...
    VF_HotWT10.PowSpecDen_k{ind_exp_WT10_2,1}(logIndices,1)/(mean([VF_HotWT10.epsilon_str{ind_exp_WT10_2,1}{:}],2)*VF_HotWT10.nu^5)^(1/4),...
    'linewidth',2,'color',[0.8627, 0.0784, 0.2353],'LineStyle','-')
% VF_HotWT10.epsilon_spec(ind_exp_WT10_2,1)
numPoints = 30; % Adjust as needed
logIndices = round(logspace(0, log10(size(Y.wavenumb, 1)), numPoints));

% loglog(Y.wavenumb(logIndices,1)*mean(Y.eta_str(ind_Gen_WT10_21,:),2),Y.PowSpecDen_k(ind_Gen_WT10_21,logIndices)/...
%     (mean(Y.epsilon_str(ind_Gen_WT10_21,:),2)*Y.nu^5)^(1/4),'--',...
%     'linewidth',2.5,'color',[1.0, 0.3882, 0.2784])

loglog(Y.wavenumb(logIndices,1)*mean(Y.eta_str(ind_Gen_WT10_21,:),2),Y.PowSpecDen_k(ind_Gen_WT10_21,logIndices)/...
    ( Y.epsilon_spec(1,ind_Gen_WT10_21)*Y.nu^5)^(1/4),'--',...
    'linewidth',2.5,'color',[1.0, 0.3882, 0.2784])

numPoints = 50; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_GenWT10.wavenumb, 1)), numPoints));
loglog(VF_GenWT10.wavenumb(logIndices,1)*mean(VF_GenWT10.eta_str(ind_Gen_WT10_21,:),2),VF_GenWT10.PowSpecDen_k(ind_Gen_WT10_21,logIndices)/...
    (mean(VF_GenWT10.epsilon_str(ind_Gen_WT10_21,:),2)*VF_GenWT10.nu^5)^(1/4),'-.',...
    'linewidth',2,'color',[0.8039, 0.3608, 0.3608])
% 
loglog(VF_GenWT10.wavenumb(logIndices,1)*mean(VF_GenWT10.eta_str(ind_Gen_WT10_21,:),2),VF_GenWT10.PowSpecDen_k(ind_Gen_WT10_21,logIndices)/...
    (VF_GenWT10.epsilon_spec(1,ind_Gen_WT10_21)*VF_GenWT10.nu^5)^(1/4),'-.',...
    'linewidth',2,'color',[0.8039, 0.3608, 0.3608])
%1.0, 0.4118, 0.7059

xlabel('$\mathrm{k}_{1}\eta$','Interpreter','latex')
ylabel('$\mathrm{E}_{11}(\mathrm{k}_{1})/(\varepsilon \nu^5)^{1/4}$','Interpreter','latex')
text(-0.210510291072951,0.970797697635849,0,'(b)',...
    'Units','Normalized','Interpreter','LaTex','FontSize',15);
set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on',...
    'YTick', [1e-6,1e0,1e6])
xlim([1e-4 10])
ylim([1e-6 1e6])
annotation(gcf,'textbox',...
    [0.682329242471742,0.877502175805047,0.093078536700127,0.069160798122066],...
    'String',{'$(\mathrm{k}_{1}\eta)^{-5/3}$'},...
    'Interpreter','latex',...
    'FontSize',13,...
    'FitBoxToText','off',...
    'EdgeColor','none');
legend('','','',...
    sprintf('H-W(m2) z$/\\delta$ = %.2f',VF_HotWT10.z(ind_exp_WT10_2)/VF_HotWT10.delta),...
    sprintf('LR-Gen(m2) z$/\\delta$ = %.2f',Y.z(ind_Gen_WT10_21)/Y.delta),...
    sprintf('HR+VorX-Gen(m2) z$/\\delta$ = %.2f',VF_GenWT10.z(ind_Gen_WT10_21)/VF_GenWT10.delta),...
    'Interpreter','latex','FontSize',10,'Position',...
    [0.597942910975208,0.202463733035891,0.294583073232871,0.138381197309368],...
    'Numcolumns',1,'Orientation','vertical','color','none');
set(gca,'TickLabelInterpreter','latex','FontSize',13)
axis square

ind_Gen_WT7_203 = 203;%VF_GenWT7.z(203)/VF_GenWT7.delta
ind_exp_WT7_9 = 9;%VF_HotWT7.z(9)/VF_HotWT7.delta

ind_Gen_WT10_200 = 200;%VF_GenWT10.z(200)/VF_GenWT10.delta
ind_exp_WT10_9 = 9;%VF_HotWT10.z(9)/VF_HotWT10.delta


figure
set(gcf,'Position',[973,562,797,383])
axes('Position',[0.092848180677541,0.130548302872063,0.404015056461731,0.840731070496083])
loglog((3e-4:1e-5:1),(3e-4:1e-5:1).^(-5/3),'linewidth',2,'color',[1.00,0.74,0.17],'lineStyle',':')
hold on
loglog(linspace(5e-7,5,size(VF_GenWT7.wavenumb,1)),ones(size(VF_GenWT7.wavenumb)),'k--','linewidth',1.5)
loglog(ones(size(VF_GenWT7.wavenumb)),linspace(1e-6,10,size(VF_GenWT7.wavenumb,1)),'k--','linewidth',1.5)

numPoints = 200; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_HotWT7.wavenumb{ind_exp_WT7_9,1}, 1)), numPoints));

loglog(VF_HotWT7.wavenumb{ind_exp_WT7_9,1}(logIndices,1)*mean([VF_HotWT7.eta_str{ind_exp_WT7_9,1}{:}],2),...
    VF_HotWT7.PowSpecDen_k{ind_exp_WT7_9,1}(logIndices,1)/(mean([VF_HotWT7.epsilon_str{ind_exp_WT7_9,1}{:}],2)*VF_HotWT7.nu^5)^(1/4),...
    'linewidth',2,'color',[0.2549, 0.4118, 0.8824],'LineStyle','-')

numPoints = 30; % Adjust as needed
logIndices = round(logspace(0, log10(size(X.wavenumb, 1)), numPoints));

loglog(X.wavenumb(logIndices,1)*mean(X.eta_str(ind_Gen_WT7_203,:),2),X.PowSpecDen_k(ind_Gen_WT7_203,logIndices)/...
    (mean(X.epsilon_str(ind_Gen_WT7_203,:),2)*X.nu^5)^(1/4),'--',...
    'linewidth',2.5,'color',[0.5294, 0.8078, 0.9216])

numPoints = 30; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_GenWT7.wavenumb, 1)), numPoints));

loglog(VF_GenWT7.wavenumb(logIndices,1)*mean(VF_GenWT7.eta_str(ind_Gen_WT7_203,:),2),VF_GenWT7.PowSpecDen_k(ind_Gen_WT7_203,logIndices)/...
    (mean(VF_GenWT7.epsilon_str(ind_Gen_WT7_203,:),2)*VF_GenWT7.nu^5)^(1/4),'-.',...
    'linewidth',2,'color',[0.0, 0.5020, 0.5020])

%0.4157, 0.3529, 0.8039

xlabel('$\mathrm{k}_{1}\eta$','Interpreter','latex')
ylabel('$\mathrm{E}_{11}(\mathrm{k}_{1})/(\varepsilon \nu^5)^{1/4}$','Interpreter','latex')
text(-0.207404701010839,0.973903287697961,0,'(a)',...
    'Units','Normalized','Interpreter','LaTex','FontSize',15);
set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on',...
    'YTick', [1e-6,1e0,1e6])
xlim([1e-4 10])
ylim([1e-6 1e6])
annotation(gcf,'textbox',...
    [0.18295659504391,0.877502175805047,0.093078536700127,0.069160798122066],...
    'String',{'$(\mathrm{k}_{1}\eta)^{-5/3}$'},...
    'Interpreter','latex',...
    'FontSize',13,...
    'FitBoxToText','off',...
    'EdgeColor','none');
legend('','','',...
    sprintf('H-W(m1) z$/\\delta$ = %.2f',VF_HotWT7.z(ind_exp_WT7_9)/VF_HotWT7.delta),...
    sprintf('LR-Gen(m1) z$/\\delta$ = %.2f',X.z(ind_Gen_WT7_203)/X.delta),...
    sprintf('HR+VorX-Gen(m1) z$/\\delta$ = %.2f',VF_GenWT7.z(ind_Gen_WT7_203)/VF_GenWT7.delta),...
    'Interpreter','latex','FontSize',10,'Position',...
    [0.098570263547366,0.202463733035891,0.294583073232871,0.138381197309368],...
    'Numcolumns',1,'Orientation','vertical','color','none');
set(gca,'TickLabelInterpreter','latex','FontSize',13)
axis square


axes('Position',[0.590966122961095,0.130548302872063,0.404015056461725,0.840731070496083])
loglog((3e-4:1e-5:1),(3e-4:1e-5:1).^(-5/3),'linewidth',2,'color',[1.00,0.74,0.17],'lineStyle',':')
hold on
loglog(linspace(5e-7,5,size(VF_GenWT7.wavenumb,1)),ones(size(VF_GenWT7.wavenumb)),'k--','linewidth',1.5)
loglog(ones(size(VF_GenWT7.wavenumb)),linspace(1e-6,10,size(VF_GenWT7.wavenumb,1)),'k--','linewidth',1.5)

numPoints = 50; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_HotWT10.wavenumb{ind_exp_WT10_9,1}, 1)), numPoints));

loglog(VF_HotWT10.wavenumb{ind_exp_WT10_9,1}(logIndices,1)*mean([VF_HotWT10.eta_str{ind_exp_WT10_9,1}{:}],2),...
    VF_HotWT10.PowSpecDen_k{ind_exp_WT10_9,1}(logIndices,1)/(mean([VF_HotWT10.epsilon_str{ind_exp_WT10_9,1}{:}],2)*VF_HotWT10.nu^5)^(1/4),...
    'linewidth',2,'color',[0.8627, 0.0784, 0.2353],'LineStyle','-')

numPoints = 30; % Adjust as needed
logIndices = round(logspace(0, log10(size(Y.wavenumb, 1)), numPoints));

loglog(Y.wavenumb(logIndices,1)*mean(Y.eta_str(ind_Gen_WT10_200,:),2),Y.PowSpecDen_k(ind_Gen_WT10_200,logIndices)/...
    (mean(Y.epsilon_str(ind_Gen_WT10_200,:),2)*Y.nu^5)^(1/4),'--',...
    'linewidth',2.5,'color',[1.0, 0.3882, 0.2784])

numPoints = 30; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_GenWT10.wavenumb, 1)), numPoints));
loglog(VF_GenWT10.wavenumb(logIndices,1)*mean(VF_GenWT10.eta_str(ind_Gen_WT10_200,:),2),VF_GenWT10.PowSpecDen_k(ind_Gen_WT10_200,logIndices)/...
    (mean(VF_GenWT10.epsilon_str(ind_Gen_WT10_200,:),2)*VF_GenWT10.nu^5)^(1/4),'-.',...
    'linewidth',2,'color',[0.8039, 0.3608, 0.3608])

%1.0, 0.4118, 0.7059

xlabel('$\mathrm{k}_{1}\eta$','Interpreter','latex')
ylabel('$\mathrm{E}_{11}(\mathrm{k}_{1})/(\varepsilon \nu^5)^{1/4}$','Interpreter','latex')
text(-0.210510291072951,0.970797697635849,0,'(b)',...
    'Units','Normalized','Interpreter','LaTex','FontSize',15);
set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on',...
    'YTick', [1e-6,1e0,1e6])
xlim([1e-4 10])
ylim([1e-6 1e6])
annotation(gcf,'textbox',...
    [0.682329242471742,0.877502175805047,0.093078536700127,0.069160798122066],...
    'String',{'$(\mathrm{k}_{1}\eta)^{-5/3}$'},...
    'Interpreter','latex',...
    'FontSize',13,...
    'FitBoxToText','off',...
    'EdgeColor','none');
legend('','','',...
    sprintf('H-W(m2) z$/\\delta$ = %.2f',VF_HotWT10.z(ind_exp_WT10_9)/VF_HotWT10.delta),...
    sprintf('LR-Gen(m2) z$/\\delta$ = %.2f',Y.z(ind_Gen_WT10_200)/Y.delta),...
    sprintf('HR+VorX-Gen(m2) z$/\\delta$ = %.2f',VF_GenWT10.z(ind_Gen_WT10_200)/VF_GenWT10.delta),...
    'Interpreter','latex','FontSize',10,'Position',...
    [0.597942910975208,0.202463733035891,0.294583073232871,0.138381197309368],...
    'Numcolumns',1,'Orientation','vertical','color','none');
set(gca,'TickLabelInterpreter','latex','FontSize',13)
axis square
%% ASL
ind_Gen_ASL_6 = 6;%VF_GenASL.z(6)/VF_GenASL.delta
ind_exp_ASL_1 = 1;%VF_SonicASL.z(1)/VF_SonicASL.delta
%VF_SLPIVASL.z(7)/VF_SLPIVASL.delta
figure
set(gcf,'Position',[816,477,797,383])
axes('Position',[0.092848180677541,0.130548302872063,0.404015056461731,0.840731070496083])
loglog((1e-5:1e-5:1),(1e-5:1e-5:1).^(-5/3),'linewidth',2,'color',[1.00,0.74,0.17],'LineStyle',':')
hold on
loglog(linspace(5e-7,5,size(VF_GenWT7.wavenumb,1)),ones(size(VF_GenWT7.wavenumb)),'k--','linewidth',1.5)
loglog(ones(size(VF_GenWT7.wavenumb)),linspace(1e-6,10,size(VF_GenWT7.wavenumb,1)),'k--','linewidth',1.5)

numPoints = 25; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_SonicASL.PowSpecDen_k{1,1}, 1)), numPoints));

loglog(VF_SonicASL.wavenumb{1,1}(logIndices,1)*mean([VF_SonicASL.eta_str{1,1}{:}],2),...
    VF_SonicASL.PowSpecDen_k{1,1}(logIndices,1)/(mean([VF_SonicASL.epsilon_str{1,1}{:}],2)*VF_SonicASL.nu^5)^(1/4),...
    'linewidth',2,'color',[0,0,0],'LineStyle','-')

numPoints = 25; % Adjust as needed
logIndices = round(logspace(0, log10(size(Z.wavenumb, 1)), numPoints));

loglog(Z.wavenumb(logIndices,1)*mean(Z.eta_str(ind_Gen_ASL_6,:),2),Z.PowSpecDen_k(ind_Gen_ASL_6,logIndices)/...
    (mean(Z.epsilon_str(ind_Gen_ASL_6,:),2)*Z.nu^5)^(1/4),'--',...
    'linewidth',2.5,'color',[0.1804, 0.5451, 0.3412],'Marker','|',...
    'MarkerSize',10,'Markeredgecolor',[1,0,0])

numPoints = 25; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_GenASL.wavenumb, 1)), numPoints));

loglog(VF_GenASL.wavenumb(logIndices,1)*mean(VF_GenASL.eta_str(ind_Gen_ASL_6,:),2),...
    VF_GenASL.PowSpecDen_k(ind_Gen_ASL_6,logIndices)/...
    (mean(VF_GenASL.epsilon_str(ind_Gen_ASL_6,:),2)*VF_GenASL.nu^5)^(1/4),'-.',...
    'linewidth',2,'color',[0,1,0])

% loglog(VF_GenASL.wavenumb(logIndices,1)*VF_GenASL.eta_spec(1,ind_Gen_ASL_6),...
%     VF_GenASL.PowSpecDen_k(ind_Gen_ASL_6,logIndices)/...
%     (VF_GenASL.epsilon_spec(1,ind_Gen_ASL_6)*VF_GenASL.nu^5)^(1/4),'-.',...
%     'linewidth',2,'color',[0,1,0])


numPoints = 30; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_HotWT7.wavenumb{ind_exp_WT7_1,1}, 1)), numPoints));

loglog(VF_HotWT7.wavenumb{ind_exp_WT7_1,1}(logIndices,1)*mean([VF_HotWT7.eta_str{ind_exp_WT7_1,1}{:}],2),...
    VF_HotWT7.PowSpecDen_k{ind_exp_WT7_1,1}(logIndices,1)/(mean([VF_HotWT7.epsilon_str{ind_exp_WT7_1,1}{:}],2)*VF_HotWT7.nu^5)^(1/4),...
    'linewidth',2,'color',[0.2549, 0.4118, 0.8824],'LineStyle','-')

xlabel('$\mathrm{k}_{1}\eta$','Interpreter','latex')
ylabel('$\mathrm{E}_{11}(\mathrm{k}_{1})/(\varepsilon \nu^5)^{1/4}$','Interpreter','latex')

set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on',...
    'YTick', [1e-6,1e0,1e6])
xlim([1e-6 10])
ylim([1e-6 1e10])
annotation(gcf,'textbox',...
    [0.65048173596415,0.873971932114878,0.093078536700127,0.069160798122066],...
    'String',{'$(\mathrm{k}_{1}\eta)^{-5/3}$'},...
    'Interpreter','latex',...
    'FontSize',13,...
    'FitBoxToText','off',...
    'EdgeColor','none');
legend('','','',...
    sprintf('Sonic(ASL) z$/\\delta$ = %.2f',VF_SonicASL.z(1)/VF_SonicASL.delta),...
    sprintf('LR-Gen(ASL) z$/\\delta$ = %.2f',VF_GenASL.z(ind_Gen_ASL_6)/VF_GenASL.delta),...
    sprintf('HR+VorX-Gen(ASL) z$/\\delta$ = %.2f',VF_GenASL.z(ind_Gen_ASL_6)/VF_GenASL.delta),...
    sprintf('H-W(m1) z$/\\delta$ = %.2f',VF_HotWT7.z(ind_exp_WT7_1)/VF_HotWT7.delta),...
    'Interpreter','latex','FontSize',10,'Position',...
    [0.102271767732206,0.154268178404886,0.304574267637411,0.181462136012145],...
    'Numcolumns',1,'Orientation','vertical');
set(gca,'TickLabelInterpreter','latex','FontSize',13)
axis square

ind_Gen_ASL_64 = 64;%VF_GenASL.z(64)/VF_GenASL.delta
axes('Position',[0.590966122961095,0.130548302872063,0.404015056461725,0.840731070496083])
loglog((1e-5:1e-5:1),(1e-5:1e-5:1).^(-5/3),'linewidth',2,'color',[1.00,0.74,0.17],'LineStyle',':')
hold on
loglog(linspace(5e-7,5,size(VF_GenWT7.wavenumb,1)),ones(size(VF_GenWT7.wavenumb)),'k--','linewidth',1.5)
loglog(ones(size(VF_GenWT7.wavenumb)),linspace(1e-6,10,size(VF_GenWT7.wavenumb,1)),'k--','linewidth',1.5)

numPoints = 25; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_SonicASL.PowSpecDen_k{1,1}, 1)), numPoints));

loglog(VF_SonicASL.wavenumb{1,1}(logIndices,1)*mean([VF_SonicASL.eta_str{1,1}{:}],2),...
    VF_SonicASL.PowSpecDen_k{1,1}(logIndices,1)/(mean([VF_SonicASL.epsilon_str{1,1}{:}],2)*VF_SonicASL.nu^5)^(1/4),...
    'linewidth',2,'color',[0,0,0],'LineStyle','-')

numPoints = 25; % Adjust as needed
logIndices = round(logspace(0, log10(size(Z.wavenumb, 1)), numPoints));

loglog(Z.wavenumb(logIndices,1)*mean(Z.eta_str(ind_Gen_ASL_64,:),2),Z.PowSpecDen_k(ind_Gen_ASL_64,logIndices)/...
    (mean(Z.epsilon_str(ind_Gen_ASL_64,:),2)*Z.nu^5)^(1/4),'--',...
    'linewidth',2.5,'color',[0.1804, 0.5451, 0.3412],'Marker','|',...
    'MarkerSize',10,'Markeredgecolor',[1,0,0])

numPoints = 25; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_GenASL.wavenumb, 1)), numPoints));

loglog(VF_GenASL.wavenumb(logIndices,1)*mean(VF_GenASL.eta_str(ind_Gen_ASL_64,:),2),...
    VF_GenASL.PowSpecDen_k(ind_Gen_ASL_64,logIndices)/...
    (mean(VF_GenASL.epsilon_str(ind_Gen_ASL_64,:),2)*VF_GenASL.nu^5)^(1/4),'-.',...
    'linewidth',2,'color',[0,1,0])

% loglog(VF_GenASL.wavenumb(logIndices,1)*VF_GenASL.eta_spec(1,ind_Gen_ASL_64),...
%     VF_GenASL.PowSpecDen_k(ind_Gen_ASL_64,logIndices)/...
%     (VF_GenASL.epsilon_spec(1,ind_Gen_ASL_64)*VF_GenASL.nu^5)^(1/4),'-.',...
%     'linewidth',2,'color',[0,1,0])


numPoints = 30; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_HotWT7.wavenumb{ind_exp_WT7_1,1}, 1)), numPoints));

loglog(VF_HotWT7.wavenumb{ind_exp_WT7_1,1}(logIndices,1)*mean([VF_HotWT7.eta_str{ind_exp_WT7_1,1}{:}],2),...
    VF_HotWT7.PowSpecDen_k{ind_exp_WT7_1,1}(logIndices,1)/(mean([VF_HotWT7.epsilon_str{ind_exp_WT7_1,1}{:}],2)*VF_HotWT7.nu^5)^(1/4),...
    'linewidth',2,'color',[0.2549, 0.4118, 0.8824],'LineStyle','-')

xlabel('$\mathrm{k}_{1}\eta$','Interpreter','latex')
ylabel('$\mathrm{E}_{11}(\mathrm{k}_{1})/(\varepsilon \nu^5)^{1/4}$','Interpreter','latex')

set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on',...
    'YTick', [1e-6,1e0,1e6])
xlim([1e-6 10])
ylim([1e-6 1e10])
annotation(gcf,'textbox',...
    [0.15236379368059,0.873971932114878,0.093078536700127,0.069160798122066],...
    'String',{'$(\mathrm{k}_{1}\eta)^{-5/3}$'},...
    'Interpreter','latex',...
    'FontSize',13,...
    'FitBoxToText','off',...
    'EdgeColor','none');
legend('','','',...
    sprintf('Sonic(ASL) z$/\\delta$ = %.2f',VF_SonicASL.z(1)/VF_SonicASL.delta),...
    sprintf('LR-Gen(ASL) z$/\\delta$ = %.2f',VF_GenASL.z(ind_Gen_ASL_64)/VF_GenASL.delta),...
    sprintf('HR+VorX-Gen(ASL) z$/\\delta$ = %.2f',VF_GenASL.z(ind_Gen_ASL_64)/VF_GenASL.delta),...
    sprintf('H-W(m1) z$/\\delta$ = %.2f',VF_HotWT7.z(ind_exp_WT7_1)/VF_HotWT7.delta),...
    'Interpreter','latex','FontSize',10,'Position',...
    [0.601273257791316,0.154850047241849,0.304574267637406,0.181462136012144],...
    'Numcolumns',1,'Orientation','vertical');
set(gca,'TickLabelInterpreter','latex','FontSize',13)
axis square


%% ASL dimensional
ind_Gen_ASL_64 = 64;%VF_GenASL.z(64)/VF_GenASL.delta
ind_exp_ASL_1 = 1;%VF_SonicASL.z(1)/VF_SonicASL.delta
%VF_SLPIVASL.z(7)/VF_SLPIVASL.delta
figure
set(gcf,'Position',[877,554,536,480])
axes('Position',[0.149253731343284,0.104166666666667,0.789179104477612,0.88125])
loglog((1e-5:1e-5:1),(1e-5:1e-5:1).^(-5/3),'linewidth',2,'color',[1.00,0.74,0.17],'LineStyle',':')
hold on
loglog(linspace(5e-7,5,size(VF_GenWT7.wavenumb,1)),ones(size(VF_GenWT7.wavenumb)),'k--','linewidth',1.5)
loglog(ones(size(VF_GenWT7.wavenumb)),linspace(1e-6,10,size(VF_GenWT7.wavenumb,1)),'k--','linewidth',1.5)

numPoints = 25; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_SonicASL.PowSpecDen_k{1,1}, 1)), numPoints));

loglog(VF_SonicASL.wavenumb{1,1}(logIndices,1),...
    VF_SonicASL.PowSpecDen_k{1,1}(logIndices,1)/(mean([VF_SonicASL.epsilon_str{1,1}{:}],2)*VF_SonicASL.nu^5)^(1/4),...
    'linewidth',2,'color',[0,0,0],'LineStyle','-')

numPoints = 25; % Adjust as needed
logIndices = round(logspace(0, log10(size(Z.wavenumb, 1)), numPoints));

loglog(Z.wavenumb(logIndices,1),Z.PowSpecDen_k(ind_Gen_ASL_64,logIndices)/...
    (mean(Z.epsilon_str(ind_Gen_ASL_64,:),2)*Z.nu^5)^(1/4),'--',...
    'linewidth',2.5,'color',[0.1804, 0.5451, 0.3412])

numPoints = 25; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_GenASL.wavenumb, 1)), numPoints));

loglog(VF_GenASL.wavenumb(logIndices,1),VF_GenASL.PowSpecDen_k(ind_Gen_ASL_64,logIndices)/...
    (mean(VF_GenASL.epsilon_str(ind_Gen_ASL_64,:),2)*VF_GenASL.nu^5)^(1/4),'-.',...
    'linewidth',2,'color',[0,1,0])


numPoints = 30; % Adjust as needed
logIndices = round(logspace(0, log10(size(VF_HotWT7.wavenumb{ind_exp_WT7_1,1}, 1)), numPoints));

loglog(VF_HotWT7.wavenumb{ind_exp_WT7_1,1}(logIndices,1),...
    VF_HotWT7.PowSpecDen_k{ind_exp_WT7_1,1}(logIndices,1)/(mean([VF_HotWT7.epsilon_str{ind_exp_WT7_1,1}{:}],2)*VF_HotWT7.nu^5)^(1/4),...
    'linewidth',2,'color',[0.2549, 0.4118, 0.8824],'LineStyle','-')

xlabel('$\mathrm{k}_{1}\eta$','Interpreter','latex')
ylabel('$\mathrm{E}_{11}(\mathrm{k}_{1})/(\varepsilon \nu^5)^{1/4}$','Interpreter','latex')

set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on',...
    'YTick', [1e-6,1e0,1e6])
xlim([1e-6 10])
ylim([1e-6 1e10])
annotation(gcf,'textbox',...
    [0.261523141233915,0.868749999999996,0.093078536700127,0.069160798122066],...
    'String',{'$(\mathrm{k}_{1}\eta)^{-5/3}$'},...
    'Interpreter','latex',...
    'FontSize',13,...
    'FitBoxToText','off',...
    'EdgeColor','none');
legend('','','',...
    sprintf('Sonic(ASL) z$/\\delta$ = %.2f',VF_SonicASL.z(1)/VF_SonicASL.delta),...
    sprintf('LR-Gen(ASL) z$/\\delta$ = %.2f',VF_GenASL.z(ind_Gen_ASL_64)/VF_GenASL.delta),...
    sprintf('HR+VorX-Gen(ASL) z$/\\delta$ = %.2f',VF_GenASL.z(ind_Gen_ASL_64)/VF_GenASL.delta),...
    sprintf('H-W(m1) z$/\\delta$ = %.2f',VF_HotWT7.z(ind_exp_WT7_1)/VF_HotWT7.delta),...
    'Interpreter','latex','FontSize',10,'Position',...
    [0.470685843123653,0.823681912006378,0.452883752438465,0.144791662693024],...
    'Numcolumns',1,'Orientation','vertical');
set(gca,'TickLabelInterpreter','latex','FontSize',13)
axis square
%% Generated spectra and Experimental (in active)

% ind_Gen_WT7_4 = 4;%VF_GenWT7.z(4)/VF_GenWT7.delta
% ind_exp_WT7_1 = 1;%VF_HotWT7.z(1)/VF_HotWT7.delta
% 
% ind_Gen_WT10_21 = 21;%VF_GenWT10.z(21)/VF_GenWT10.delta
% ind_exp_WT10_2 = 2;%VF_HotWT10.z(2)/VF_HotWT10.delta
% 
% ind_Gen_ASL_64 = 64;%VF_GenASL.z(64)/VF_GenASL.delta
% ind_exp_ASL_1 = 1;%VF_SonicASL.z(1)/VF_SonicASL.delta
% %VF_SLPIVASL.z(7)/VF_SLPIVASL.delta
% 
% figure
% set(gcf,'Position',[785,346,797,480])
% axes('Position',[0.087829360100376,0.591666666666665,0.896356127143451,0.397476525821595])
% loglog((5e-6:1e-5:1),(5e-6:1e-5:1).^(-5/3),'linewidth',2,'color',[1.00,0.74,0.17])
% hold on
% loglog(linspace(5e-7,5,size(VF_GenWT7.wavenumb,1)),ones(size(VF_GenWT7.wavenumb)),'r--','linewidth',1.5)
% loglog(ones(size(VF_GenWT7.wavenumb)),linspace(1e-6,10,size(VF_GenWT7.wavenumb,1)),'r--','linewidth',1.5)
% 
% loglog(VF_HotWT7.wavenumb{ind_exp_WT7_1,1}*mean([VF_HotWT7.eta_str{ind_exp_WT7_1,1}{:}],2),...
%     VF_HotWT7.PowSpecDen_k{ind_exp_WT7_1,1}/(mean([VF_HotWT7.epsilon_str{ind_exp_WT7_1,1}{:}],2)*VF_HotWT7.nu^5)^(1/4),...
%     'linewidth',2,'color',[0.17,0.72,1.00],'LineStyle','-')
% 
% 
% loglog(VF_GenWT7.wavenumb*mean(VF_GenWT7.eta_str(ind_Gen_WT7_4,:),2),VF_GenWT7.PowSpecDen_k(ind_Gen_WT7_4,:)/...
%     (mean(VF_GenWT7.epsilon_str(ind_Gen_WT7_4,:),2)*VF_GenWT7.nu^5)^(1/4),'-',...
%     'linewidth',2,'color',[1.00,0.40,0.00])
% 
% loglog(VF_HotWT10.wavenumb{ind_exp_WT10_2,1}*mean([VF_HotWT10.eta_str{ind_exp_WT10_2,1}{:}],2),...
%     VF_HotWT10.PowSpecDen_k{ind_exp_WT10_2,1}/(mean([VF_HotWT10.epsilon_str{ind_exp_WT10_2,1}{:}],2)*VF_HotWT10.nu^5)^(1/4),...
%     'linewidth',2,'color',[1.00,0.06,0.94],'LineStyle','--')
% 
% 
% loglog(VF_GenWT10.wavenumb*mean(VF_GenWT10.eta_str(ind_Gen_WT10_21,:),2),VF_GenWT10.PowSpecDen_k(ind_Gen_WT10_21,:)/...
%     (mean(VF_GenWT10.epsilon_str(ind_Gen_WT10_21,:),2)*VF_GenWT10.nu^5)^(1/4),'--',...
%     'linewidth',2,'color',[0.00,0.49,0.02])
% 
% 
% loglog(VF_SonicASL.wavenumb{1,1}*mean([VF_SonicASL.eta_str{1,1}{:}],2),...
%     VF_SonicASL.PowSpecDen_k{1,1}/(mean([VF_SonicASL.epsilon_str{1,1}{:}],2)*VF_SonicASL.nu^5)^(1/4),...
%     'linewidth',2,'color',[0,0,0],'LineStyle','-.')
% 
% loglog(VF_GenASL.wavenumb*mean(VF_GenASL.eta_str(ind_Gen_ASL_64,:),2),VF_GenASL.PowSpecDen_k(ind_Gen_ASL_64,:)/...
%     (mean(VF_GenASL.epsilon_str(ind_Gen_ASL_64,:),2)*VF_GenASL.nu^5)^(1/4),'-.',...
%     'linewidth',2,'color',[0.22,1.00,0.08])
% 
% 
% % xlabel('$k_{1}\eta$','Interpreter','latex')
% ylabel('$\mathrm{E}_{11}(\mathrm{k}_{1})/(\varepsilon \nu^5)^{1/4}$','Interpreter','latex')
% text(0.950980392156863,0.890052356020942,0,'(a)',...
%     'Units','Normalized','Interpreter','LaTex','FontSize',15);
% set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on',...
%     'YTick', [1e-6,1e0,1e6])
% xlim([1e-6 10])
% ylim([1e-6 1e10])
% annotation(gcf,'textbox',...
%     [0.278314186010035,0.916666666666666,0.093078536700127,0.069160798122066],...
%     'String',{'$(\mathrm{k}_{1}\eta)^{-5/3}$'},...
%     'Interpreter','latex',...
%     'FontSize',13,...
%     'FitBoxToText','off',...
%     'EdgeColor','none');
% legend('','','',sprintf('H-W(m1) z$/\\delta$ = %.2f',VF_HotWT7.z(ind_exp_WT7_1)/VF_HotWT7.delta),...
%     sprintf('Gen(m1) z$/\\delta$ = %.2f',VF_GenWT7.z(ind_Gen_WT7_4)/VF_GenWT7.delta),...
%     sprintf('H-W(m2) z$/\\delta$ = %.2f',VF_HotWT10.z(ind_exp_WT10_2)/VF_HotWT10.delta),...
%     sprintf('Gen(m2) z$/\\delta$ = %.2f',VF_GenWT10.z(ind_Gen_WT10_21)/VF_GenWT10.delta),...
%     sprintf('Sonic(ASL) z$/\\delta$ = %.2f',VF_SonicASL.z(1)/VF_SonicASL.delta),...
%     sprintf('Gen(ASL) z$/\\delta$ = %.2f',VF_GenASL.z(ind_Gen_ASL_64)/VF_GenASL.delta),...
%     'Interpreter','latex','FontSize',10,'Position',...
%     [0.09901921184191,0.612223577679635,0.687608538972837,0.076041664679845],...
%     'Numcolumns',3,'Orientation','vertical');
% set(gca,'TickLabelInterpreter','latex','FontSize',13)
% 
% ind_Gen_WT7_203 = 203;%VF_GenWT7.z(203)/VF_GenWT7.delta
% ind_exp_WT7_9 = 9;%VF_HotWT7.z(9)/VF_HotWT7.delta
% 
% ind_Gen_WT10_200 = 200;%VF_GenWT10.z(200)/VF_GenWT10.delta
% ind_exp_WT10_9 = 9;%VF_HotWT10.z(9)/VF_HotWT10.delta
% 
% ind_Gen_ASL_194 = 194;%VF_GenASL.z(194)/VF_GenASL.delta
% % ind_exp_ASL = 9;%VF_SonicASL.z(1)/VF_SonicASL.delta
% %VF_SLPIVASL.z(19)/VF_SLPIVASL.delta
% 
% 
% axes('Position',[0.087829360100376,0.102083333333331,0.896356127143451,0.397476525821594])
% loglog((5e-6:1e-5:1),(5e-6:1e-5:1).^(-5/3),'linewidth',2,'color',[1.00,0.74,0.17])
% hold on
% loglog(linspace(5e-7,5,size(VF_GenWT7.wavenumb,1)),ones(size(VF_GenWT7.wavenumb)),'r--','linewidth',1.5)
% loglog(ones(size(VF_GenWT7.wavenumb)),linspace(1e-6,10,size(VF_GenWT7.wavenumb,1)),'r--','linewidth',1.5)
% 
% 
% loglog(VF_HotWT7.wavenumb{ind_exp_WT7_9,1}*mean([VF_HotWT7.eta_str{ind_exp_WT7_9,1}{:}],2),...
%     VF_HotWT7.PowSpecDen_k{ind_exp_WT7_9,1}/(mean([VF_HotWT7.epsilon_str{ind_exp_WT7_9,1}{:}],2)*VF_HotWT7.nu^5)^(1/4),...
%     'linewidth',2,'color',[0.17,0.72,1.00],'LineStyle','-')
% 
% 
% loglog(VF_GenWT7.wavenumb*mean(VF_GenWT7.eta_str(ind_Gen_WT7_203,:),2),VF_GenWT7.PowSpecDen_k(ind_Gen_WT7_203,:)/...
%     (mean(VF_GenWT7.epsilon_str(ind_Gen_WT7_203,:),2)*VF_GenWT7.nu^5)^(1/4),'-',...
%     'linewidth',2,'color',[1.00,0.40,0.00])
% 
% loglog(VF_HotWT10.wavenumb{ind_exp_WT10_9,1}*mean([VF_HotWT10.eta_str{ind_exp_WT10_9,1}{:}],2),...
%     VF_HotWT10.PowSpecDen_k{ind_exp_WT10_9,1}/(mean([VF_HotWT10.epsilon_str{ind_exp_WT10_9,1}{:}],2)*VF_HotWT10.nu^5)^(1/4),...
%     'linewidth',2,'color',[1.00,0.06,0.94],'LineStyle','--')
% 
% 
% loglog(VF_GenWT10.wavenumb*mean(VF_GenWT10.eta_str(ind_Gen_WT10_200,:),2),VF_GenWT10.PowSpecDen_k(ind_Gen_WT10_200,:)/...
%     (mean(VF_GenWT10.epsilon_str(ind_Gen_WT10_200,:),2)*VF_GenWT10.nu^5)^(1/4),'--',...
%     'linewidth',2,'color',[0.00,0.49,0.02])
% 
% loglog(VF_GenASL.wavenumb*mean(VF_GenASL.eta_str(ind_Gen_ASL_194,:),2),VF_GenASL.PowSpecDen_k(ind_Gen_ASL_194,:)/...
%     (mean(VF_GenASL.epsilon_str(ind_Gen_ASL_194,:),2)*VF_GenASL.nu^5)^(1/4),'-.',...
%     'linewidth',2,'color',[0.22,1.00,0.08])
% 
% 
% 
% 
% xlabel('$\mathrm{k}_{1}\eta$','Interpreter','latex')
% ylabel('$\mathrm{E}_{11}(\mathrm{k}_{1})/(\varepsilon \nu^5)^{1/4}$','Interpreter','latex')
% xlim([1e-6 10])
% ylim([1e-6 1e10])
% text(0.950980392156863,0.895287958115183,0,'(b)',...
%     'Units','Normalized','Interpreter','LaTex','FontSize',15);
% set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on',...
%     'YTick', [1e-6,1e0,1e6])
% annotation(gcf,'textbox',...
%     [0.278314186010034,0.427083333333332,0.096842652133,0.067077464788732],...
%     'String',{'$(\mathrm{k}_{1}\eta)^{-5/3}$'},...
%     'Interpreter','latex',...
%     'FontSize',13,...
%     'FitBoxToText','off',...
%     'EdgeColor','none');
% 
% legend('','','',sprintf('H-W(m1) z$/\\delta$ = %.2f',VF_HotWT7.z(ind_exp_WT7_9)/VF_HotWT7.delta),...
%     sprintf('Gen(m1) z$/\\delta$ = %.2f',VF_GenWT7.z(ind_Gen_WT7_203)/VF_GenWT7.delta),...
%     sprintf('H-W(m2) z$/\\delta$ = %.2f',VF_HotWT10.z(ind_exp_WT10_9)/VF_HotWT10.delta),...
%     sprintf('Gen(m2) z$/\\delta$ = %.2f',VF_GenWT10.z(ind_Gen_WT10_200)/VF_GenWT10.delta),...
%     sprintf('Gen(ASL) z$/\\delta$ = %.2f',VF_GenASL.z(ind_Gen_ASL_194)/VF_GenASL.delta),...
%     'Interpreter','latex','FontSize',10,'Position',...
%     [0.100157928571399,0.125299102428438,0.678430540360158,0.076041664679845],...
%     'Numcolumns',3,'Orientation','vertical');
% set(gca,'TickLabelInterpreter','latex','FontSize',13)
% % legend boxoff

% %% Generated spectra and Experimental
% 
% ind_Gen_WT7_4 = 4;%VF_GenWT7.z(4)/VF_GenWT7.delta
% ind_exp_WT7_1 = 1;%VF_HotWT7.z(1)/VF_HotWT7.delta
% 
% ind_Gen_WT10_21 = 21;%VF_GenWT10.z(21)/VF_GenWT10.delta
% ind_exp_WT10_2 = 2;%VF_HotWT10.z(2)/VF_HotWT10.delta
% 
% ind_Gen_ASL_64 = 64;%VF_GenASL.z(64)/VF_GenASL.delta
% ind_exp_ASL_1 = 1;%VF_SonicASL.z(1)/VF_SonicASL.delta
% %VF_SLPIVASL.z(7)/VF_SLPIVASL.delta
% 
% figure
% set(gcf,'Position',[973,562,797,383])
% axes('Position',[0.092848180677541,0.130548302872063,0.404015056461731,0.840731070496083])
% loglog((5e-6:1e-5:1),(5e-6:1e-5:1).^(-5/3),'linewidth',2,'color',[1.00,0.00,1.00],'lineStyle',':')
% hold on
% loglog(linspace(5e-7,5,size(VF_GenWT7.wavenumb,1)),ones(size(VF_GenWT7.wavenumb)),'k--','linewidth',1.5)
% loglog(ones(size(VF_GenWT7.wavenumb)),linspace(1e-6,10,size(VF_GenWT7.wavenumb,1)),'k--','linewidth',1.5)
% 
% numPoints = 30; % Adjust as needed
% logIndices = round(logspace(0, log10(size(VF_GenWT7.wavenumb, 1)), numPoints));
% 
% loglog(VF_GenWT7.wavenumb(logIndices,1)*mean(VF_GenWT7.eta_str(ind_Gen_WT7_4,:),2),VF_GenWT7.PowSpecDen_k(ind_Gen_WT7_4,logIndices)/...
%     (mean(VF_GenWT7.epsilon_str(ind_Gen_WT7_4,:),2)*VF_GenWT7.nu^5)^(1/4),'-',...
%     'linewidth',2,'color',[0.00,0.00,1.00])
% 
% numPoints = 30; % Adjust as needed
% logIndices = round(logspace(0, log10(size(VF_GenWT10.wavenumb, 1)), numPoints));
% 
% loglog(VF_GenWT10.wavenumb(logIndices,1)*mean(VF_GenWT10.eta_str(ind_Gen_WT10_21,:),2),VF_GenWT10.PowSpecDen_k(ind_Gen_WT10_21,logIndices)/...
%     (mean(VF_GenWT10.epsilon_str(ind_Gen_WT10_21,:),2)*VF_GenWT10.nu^5)^(1/4),'--',...
%     'linewidth',2,'color',[1.00,0.00,0.00])
% 
% numPoints = 30; % Adjust as needed
% logIndices = round(logspace(0, log10(size(VF_GenASL.wavenumb, 1)), numPoints));
% 
% loglog(VF_GenASL.wavenumb(logIndices,1)*mean(VF_GenASL.eta_str(ind_Gen_ASL_64,:),2),VF_GenASL.PowSpecDen_k(ind_Gen_ASL_64,logIndices)/...
%     (mean(VF_GenASL.epsilon_str(ind_Gen_ASL_64,:),2)*VF_GenASL.nu^5)^(1/4),'-.',...
%     'linewidth',2,'color',[0.00,1.00,0.00])
% 
% 
% xlabel('$\mathrm{k}_{1}\eta$','Interpreter','latex')
% ylabel('$\mathrm{E}_{11}(\mathrm{k}_{1})/(\varepsilon \nu^5)^{1/4}$','Interpreter','latex')
% text(-0.207404701010839,0.973903287697961,0,'(a)',...
%     'Units','Normalized','Interpreter','LaTex','FontSize',15);
% set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on',...
%     'YTick', [1e-6,1e0,1e6])
% xlim([1e-6 10])
% ylim([1e-6 1e10])
% annotation(gcf,'textbox',...
%     [0.144060735570887,0.88272410791993,0.093078536700127,0.069160798122066],...
%     'String',{'$(\mathrm{k}_{1}\eta)^{-5/3}$'},...
%     'Interpreter','latex',...
%     'FontSize',13,...
%     'FitBoxToText','off',...
%     'EdgeColor','none');
% legend('','','',...
%     sprintf('Gen(m1) z$/\\delta$ = %.2f',VF_GenWT7.z(ind_Gen_WT7_4)/VF_GenWT7.delta),...
%     sprintf('Gen(m2) z$/\\delta$ = %.2f',VF_GenWT10.z(ind_Gen_WT10_21)/VF_GenWT10.delta),...
%     sprintf('Gen(ASL) z$/\\delta$ = %.2f',VF_GenASL.z(ind_Gen_ASL_64)/VF_GenASL.delta),...
%     'Interpreter','latex','FontSize',10,'Position',...
%     [0.26886168926241,0.821262688649468,0.22250712268108,0.138381197309369],...
%     'Numcolumns',1,'Orientation','vertical');
% set(gca,'TickLabelInterpreter','latex','FontSize',13)
% axis square
% 
% axes('Position',[0.590966122961095,0.130548302872063,0.404015056461725,0.840731070496083])
% loglog((5e-6:1e-5:1),(5e-6:1e-5:1).^(-5/3),'linewidth',2,'color',[1.00,0.00,1.00],'lineStyle',':')
% hold on
% loglog(linspace(5e-7,5,size(VF_GenWT7.wavenumb,1)),ones(size(VF_GenWT7.wavenumb)),'k--','linewidth',1.5)
% loglog(ones(size(VF_GenWT7.wavenumb)),linspace(1e-6,10,size(VF_GenWT7.wavenumb,1)),'k--','linewidth',1.5)
% 
% numPoints = 25; % Adjust as needed
% logIndices = round(logspace(0, log10(size(VF_HotWT7.wavenumb{ind_exp_WT7_1,1}, 1)), numPoints));
% 
% loglog(VF_HotWT7.wavenumb{ind_exp_WT7_1,1}(logIndices,1)*mean([VF_HotWT7.eta_str{ind_exp_WT7_1,1}{:}],2),...
%     VF_HotWT7.PowSpecDen_k{ind_exp_WT7_1,1}(logIndices,1)/(mean([VF_HotWT7.epsilon_str{ind_exp_WT7_1,1}{:}],2)*VF_HotWT7.nu^5)^(1/4),...
%     'linewidth',2,'color',[0.00,0.00,1.00],'LineStyle','-')
% 
% numPoints = 25; % Adjust as needed
% logIndices = round(logspace(0, log10(size(VF_HotWT10.wavenumb{ind_exp_WT10_2,1}, 1)), numPoints));
% 
% loglog(VF_HotWT10.wavenumb{ind_exp_WT10_2,1}(logIndices,1)*mean([VF_HotWT10.eta_str{ind_exp_WT10_2,1}{:}],2),...
%     VF_HotWT10.PowSpecDen_k{ind_exp_WT10_2,1}(logIndices,1)/(mean([VF_HotWT10.epsilon_str{ind_exp_WT10_2,1}{:}],2)*VF_HotWT10.nu^5)^(1/4),...
%     'linewidth',2,'color',[1.00,0.00,0.00],'LineStyle','--')
% 
% numPoints = 25; % Adjust as needed
% logIndices = round(logspace(0, log10(size(VF_SonicASL.wavenumb{1,1}, 1)), numPoints));
% 
% loglog(VF_SonicASL.wavenumb{1,1}(logIndices,1)*mean([VF_SonicASL.eta_str{1,1}{:}],2),...
%     VF_SonicASL.PowSpecDen_k{1,1}(logIndices,1)/(mean([VF_SonicASL.epsilon_str{1,1}{:}],2)*VF_SonicASL.nu^5)^(1/4),...
%     'linewidth',2,'color',[0.00,1.00,0.00],'LineStyle','-.')
% 
% 
% xlabel('$\mathrm{k}_{1}\eta$','Interpreter','latex')
% ylabel('$\mathrm{E}_{11}(\mathrm{k}_{1})/(\varepsilon \nu^5)^{1/4}$','Interpreter','latex')
% text(-0.210510291072951,0.970797697635849,0,'(b)',...
%     'Units','Normalized','Interpreter','LaTex','FontSize',15);
% set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on',...
%     'YTick', [1e-6,1e0,1e6])
% xlim([1e-6 10])
% ylim([1e-6 1e10])
% annotation(gcf,'textbox',...
%     [0.64217867785444,0.88272410791993,0.093078536700127,0.069160798122066],...
%     'String',{'$(\mathrm{k}_{1}\eta)^{-5/3}$'},...
%     'Interpreter','latex',...
%     'FontSize',13,...
%     'FitBoxToText','off',...
%     'EdgeColor','none');
% legend('','','',sprintf('H-W(m1) z$/\\delta$ = %.2f',VF_HotWT7.z(ind_exp_WT7_1)/VF_HotWT7.delta),...
%     sprintf('H-W(m2) z$/\\delta$ = %.2f',VF_HotWT10.z(ind_exp_WT10_2)/VF_HotWT10.delta),...
%     sprintf('Sonic(ASL) z$/\\delta$ = %.2f',VF_SonicASL.z(1)/VF_SonicASL.delta),...
%     'Interpreter','latex','FontSize',10,'Position',...
%     [0.75552147671438,0.821262688649468,0.231685121293759,0.138381197309369],...
%     'Numcolumns',1,'Orientation','vertical');
% set(gca,'TickLabelInterpreter','latex','FontSize',13)
% axis square
% 
% ind_Gen_WT7_203 = 203;%VF_GenWT7.z(203)/VF_GenWT7.delta
% ind_exp_WT7_9 = 9;%VF_HotWT7.z(9)/VF_HotWT7.delta
% 
% ind_Gen_WT10_200 = 200;%VF_GenWT10.z(200)/VF_GenWT10.delta
% ind_exp_WT10_9 = 9;%VF_HotWT10.z(9)/VF_HotWT10.delta
% 
% ind_Gen_ASL_194 = 194;%VF_GenASL.z(194)/VF_GenASL.delta
% % ind_exp_ASL = 9;%VF_SonicASL.z(1)/VF_SonicASL.delta
% %VF_SLPIVASL.z(19)/VF_SLPIVASL.delta
% 
% figure
% set(gcf,'Position',[973,562,797,383])
% axes('Position',[0.092848180677541,0.130548302872063,0.404015056461731,0.840731070496083])
% loglog((5e-6:1e-5:1),(5e-6:1e-5:1).^(-5/3),'linewidth',2,'color',[1.00,0.00,1.00],'linestyle',':')
% hold on
% loglog(linspace(5e-7,5,size(VF_GenWT7.wavenumb,1)),ones(size(VF_GenWT7.wavenumb)),'k--','linewidth',1.5)
% loglog(ones(size(VF_GenWT7.wavenumb)),linspace(1e-6,10,size(VF_GenWT7.wavenumb,1)),'k--','linewidth',1.5)
% 
% numPoints = 30; % Adjust as needed
% logIndices = round(logspace(0, log10(size(VF_GenWT7.wavenumb, 1)), numPoints));
% 
% loglog(VF_GenWT7.wavenumb(logIndices,1)*mean(VF_GenWT7.eta_str(ind_Gen_WT7_203,:),2),VF_GenWT7.PowSpecDen_k(ind_Gen_WT7_203,logIndices)/...
%     (mean(VF_GenWT7.epsilon_str(ind_Gen_WT7_203,:),2)*VF_GenWT7.nu^5)^(1/4),'-',...
%     'linewidth',2,'color',[0.00,0.00,1.00])
% 
% numPoints = 30; % Adjust as needed
% logIndices = round(logspace(0, log10(size(VF_GenWT10.wavenumb, 1)), numPoints));
% 
% loglog(VF_GenWT10.wavenumb(logIndices,1)*mean(VF_GenWT10.eta_str(ind_Gen_WT10_200,:),2),VF_GenWT10.PowSpecDen_k(ind_Gen_WT10_200,logIndices)/...
%     (mean(VF_GenWT10.epsilon_str(ind_Gen_WT10_200,:),2)*VF_GenWT10.nu^5)^(1/4),'--',...
%     'linewidth',2,'color',[1.00,0.00,0.00])
% 
% numPoints = 30; % Adjust as needed
% logIndices = round(logspace(0, log10(size(VF_GenASL.wavenumb, 1)), numPoints));
% 
% loglog(VF_GenASL.wavenumb(logIndices,1)*mean(VF_GenASL.eta_str(ind_Gen_ASL_194,:),2),VF_GenASL.PowSpecDen_k(ind_Gen_ASL_194,logIndices)/...
%     (mean(VF_GenASL.epsilon_str(ind_Gen_ASL_194,:),2)*VF_GenASL.nu^5)^(1/4),'-.',...
%     'linewidth',2,'color',[0.00,1.00,0.00])
% 
% 
% xlabel('$\mathrm{k}_{1}\eta$','Interpreter','latex')
% ylabel('$\mathrm{E}_{11}(\mathrm{k}_{1})/(\varepsilon \nu^5)^{1/4}$','Interpreter','latex')
% text(-0.207404701010839,0.973903287697961,0,'(a)',...
%     'Units','Normalized','Interpreter','LaTex','FontSize',15);
% set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on',...
%     'YTick', [1e-6,1e0,1e6])
% xlim([1e-6 10])
% ylim([1e-6 1e10])
% annotation(gcf,'textbox',...
%     [0.144060735570887,0.88272410791993,0.093078536700127,0.069160798122066],...
%     'String',{'$(\mathrm{k}_{1}\eta)^{-5/3}$'},...
%     'Interpreter','latex',...
%     'FontSize',13,...
%     'FitBoxToText','off',...
%     'EdgeColor','none');
% legend('','','',...
%     sprintf('Gen(m1) z$/\\delta$ = %.2f',VF_GenWT7.z(ind_Gen_WT7_203)/VF_GenWT7.delta),...
%     sprintf('Gen(m2) z$/\\delta$ = %.2f',VF_GenWT10.z(ind_Gen_WT10_200)/VF_GenWT10.delta),...
%     sprintf('Gen(ASL) z$/\\delta$ = %.2f',VF_GenASL.z(ind_Gen_ASL_194)/VF_GenASL.delta),...
%     'Interpreter','latex','FontSize',10,'Position',...
%     [0.26886168926241,0.821262688649468,0.22250712268108,0.138381197309369],...
%     'Numcolumns',1,'Orientation','vertical');
% set(gca,'TickLabelInterpreter','latex','FontSize',13)
% axis square
% 
% axes('Position',[0.590966122961095,0.130548302872063,0.404015056461725,0.840731070496083])
% loglog((5e-6:1e-5:1),(5e-6:1e-5:1).^(-5/3),'linewidth',2,'color',[1.00,0.00,1.00],'lineStyle',':')
% hold on
% loglog(linspace(5e-7,5,size(VF_GenWT7.wavenumb,1)),ones(size(VF_GenWT7.wavenumb)),'k--','linewidth',1.5)
% loglog(ones(size(VF_GenWT7.wavenumb)),linspace(1e-6,10,size(VF_GenWT7.wavenumb,1)),'k--','linewidth',1.5)
% 
% numPoints = 25; % Adjust as needed
% logIndices = round(logspace(0, log10(size(VF_HotWT7.wavenumb{ind_exp_WT7_9,1}, 1)), numPoints));
% 
% loglog(VF_HotWT7.wavenumb{ind_exp_WT7_9,1}(logIndices,1)*mean([VF_HotWT7.eta_str{ind_exp_WT7_9,1}{:}],2),...
%     VF_HotWT7.PowSpecDen_k{ind_exp_WT7_9,1}(logIndices,1)/(mean([VF_HotWT7.epsilon_str{ind_exp_WT7_9,1}{:}],2)*VF_HotWT7.nu^5)^(1/4),...
%     'linewidth',2,'color',[0.00,0.00,1.00],'LineStyle','-')
% 
% numPoints = 25; % Adjust as needed
% logIndices = round(logspace(0, log10(size(VF_HotWT10.wavenumb{ind_exp_WT10_9,1}, 1)), numPoints));
% 
% loglog(VF_HotWT10.wavenumb{ind_exp_WT10_9,1}(logIndices,1)*mean([VF_HotWT10.eta_str{ind_exp_WT10_9,1}{:}],2),...
%     VF_HotWT10.PowSpecDen_k{ind_exp_WT10_9,1}(logIndices,1)/(mean([VF_HotWT10.epsilon_str{ind_exp_WT10_9,1}{:}],2)*VF_HotWT10.nu^5)^(1/4),...
%     'linewidth',2,'color',[1.00,0.00,0.00],'LineStyle','--')
% 
% 
% 
% xlabel('$\mathrm{k}_{1}\eta$','Interpreter','latex')
% ylabel('$\mathrm{E}_{11}(\mathrm{k}_{1})/(\varepsilon \nu^5)^{1/4}$','Interpreter','latex')
% text(-0.210510291072951,0.970797697635849,0,'(b)',...
%     'Units','Normalized','Interpreter','LaTex','FontSize',15);
% set(gca,'TickLabelInterpreter','latex','FontSize',13,'XGrid','on','YGrid','on',...
%     'YTick', [1e-6,1e0,1e6])
% xlim([1e-6 10])
% ylim([1e-6 1e10])
% annotation(gcf,'textbox',...
%     [0.64217867785444,0.88272410791993,0.093078536700127,0.069160798122066],...
%     'String',{'$(\mathrm{k}_{1}\eta)^{-5/3}$'},...
%     'Interpreter','latex',...
%     'FontSize',13,...
%     'FitBoxToText','off',...
%     'EdgeColor','none');
% legend('','','',sprintf('H-W(m1) z$/\\delta$ = %.2f',VF_HotWT7.z(ind_exp_WT7_9)/VF_HotWT7.delta),...
%     sprintf('H-W(m2) z$/\\delta$ = %.2f',VF_HotWT10.z(ind_exp_WT10_9)/VF_HotWT10.delta),...
%     'Interpreter','latex','FontSize',10,'Position',...
%     [0.771016938927671,0.864868632700554,0.217976248446527,0.095300258606595],...
%     'Numcolumns',1,'Orientation','vertical');
% set(gca,'TickLabelInterpreter','latex','FontSize',13)
% axis square

%%

[pdf_uprime,uprime] = ksdensity(VF_HotWT7.uprime(1,:),...
        'NumPoints',200);
trapz(uprime,pdf_uprime)
figure
plot(uprime,pdf_uprime,'b-');
set(gca,'TickLabelInterpreter','latex','FontSize',13)
xlabel('$u^{\prime}$','Interpreter','Latex','FontSize',14);
ylabel('p.d.f.','Interpreter','Latex','FontSize',14);
set(gca,'YScale','log')

[pdf_uprime,uprime] = ksdensity(reshape(VF_GenWT7.HRVFuprime(4,:,:),1,[]),...
        'NumPoints',200);
trapz(uprime,pdf_uprime)
figure
plot(uprime,pdf_uprime,'r-');
set(gca,'TickLabelInterpreter','latex','FontSize',13)
xlabel('$u^{\prime}$','Interpreter','Latex','FontSize',14);
ylabel('p.d.f.','Interpreter','Latex','FontSize',14);
set(gca,'YScale','log')
%% Animation
concat_u = reshape(VF_GenWT7.HRVFu,size(VF_GenWT7.HRVFu, 1), []);
concat_w = reshape(VF_GenWT7.HRVFw,size(VF_GenWT7.HRVFw, 1), []);

%%
index = find(VF_GenWT7.HRVFx/VF_GenWT7.delta >= 0.3, 1);

figure
set(gcf,'Position',[537,599,930,388])
axes('Position',[0.070405139466523,0.126242255632001,0.879057226124875,0.866025785605113])

% Initialize video writer
v = VideoWriter('WT7(Gen)(stochasticfluc_addvortex).mp4', 'MPEG-4');
v.FrameRate = 24;
v.Quality = 100;
open(v);
Nsn = 2000;
Convvel = 3;
% Animation loop
for t = 1:Nsn-1 % time_steps
    % Clear the previous frame
    clf;
    set(gcf,'Position',[537,599,930,388])
    axes('Position',[0.070405139466523,0.126242255632001,0.879057226124875,0.866025785605113])
    % Plot contour and quiver
    contourf(VF_GenWT7.HRVFx(1:index)/VF_GenWT7.delta, ...
        VF_GenWT7.z/VF_GenWT7.delta, ...
        (concat_u(:,Nsn-t:index+Nsn-t-1)), ...
        50, 'LineStyle', 'none', ...
        'LineColor', 'none', 'EdgeColor', 'none');
    hold on
    quiver(VF_GenWT7.HRVFx(1:7:index)/VF_GenWT7.delta, ...
        VF_GenWT7.z(1:7:end)/VF_GenWT7.delta, ...
        (concat_u(1:7:end,Nsn-t:7:index+Nsn-t-1)-Convvel), ...
        (concat_w(1:7:end,Nsn-t:7:index+Nsn-t-1)), 3, 'color', [1.00,0.00,0.00], ...
        'MaxHeadSize', 0.2, 'LineWidth', 1.5);
    
    % Configure color map and colorbar
    cmap2 = crameri('turku', 100);
    cmap2 = flip(cmap2);
    colormap(gca, cmap2)
    caxis([1 6])
    hcb2 = colorbar;
    hcb2.Position = [0.956312362101529, 0.128865979381443, 0.022015823873409, 0.801546391752577];
    title(hcb2, 'u$_{m}$', 'Interpreter', 'Latex', 'FontSize', 15)
    hcb2.TickLabelInterpreter = 'latex';
    hcb2.TickLength = 0;
    hcb2.Label.Interpreter = 'latex';
    hcb2.AxisLocation = 'out';
    set(gca, 'TickLabelInterpreter', 'latex', 'FontSize', 13)
    xlabel('x/$\delta$', 'Interpreter', 'Latex', 'FontSize', 14);
    ylabel('z/$\delta$', 'Interpreter', 'Latex', 'FontSize', 14);
    axis equal
    xlim([0.0 0.3])
    ylim([VF_GenWT7.z(1)/VF_GenWT7.delta VF_GenWT7.z(end)/VF_GenWT7.delta])

    % Save frame at 1000 DPI as a temporary high-resolution image
    tempFileName = sprintf('temp_frame_%d.png', t);
    print(gcf, tempFileName, '-dpng', '-r400');

    % Read high-resolution frame and add it to the video
    highResFrame = imread(tempFileName);
    writeVideo(v, highResFrame);

    % Delete temporary file
    delete(tempFileName);
end

% Close video writer
close(v);

%% Animation
concat_u = reshape(VF_GenASL.HRVFu,size(VF_GenASL.HRVFu, 1), []);
concat_w = reshape(VF_GenASL.HRVFw,size(VF_GenASL.HRVFw, 1), []);

%%
index = find(VF_GenASL.HRVFx/VF_GenASL.delta >= 0.05, 1);

figure
set(gcf,'Position',[918,581,645,388])
axes('Position',[0.070405139466523,0.126242255632001,0.879057226124875,0.866025785605113])

% Initialize video writer
v = VideoWriter('ASL(Gen)(stochasticfluc_addvortex).mp4', 'MPEG-4');
v.FrameRate = 24;
v.Quality = 100;
open(v);
Nsn = 2000;
Convvel = 8;
% Animation loop
for t = 1:Nsn-1 % time_steps
    % Clear the previous frame
    clf;
    set(gcf,'Position',[918,581,645,388])
    axes('Position',[0.070405139466523,0.126242255632001,0.879057226124875,0.866025785605113])
    % Plot contour and quiver
    contourf(VF_GenASL.HRVFx(1:index)/VF_GenASL.delta, ...
        VF_GenASL.z/VF_GenASL.delta, ...
        (concat_u(:,Nsn-t:index+Nsn-t-1)), ...
        50, 'LineStyle', 'none', ...
        'LineColor', 'none', 'EdgeColor', 'none');
    hold on
    quiver(VF_GenASL.HRVFx(1:8:index)/VF_GenASL.delta, ...
        VF_GenASL.z(1:8:end)/VF_GenASL.delta, ...
        (concat_u(1:8:end,Nsn-t:8:index+Nsn-t-1)-Convvel), ...
        (concat_w(1:8:end,Nsn-t:8:index+Nsn-t-1)), 3, 'color', [1.00,0.00,0.00], ...
        'MaxHeadSize', 0.2, 'LineWidth', 1.5);
    
    % Configure color map and colorbar
    cmap2 = crameri('grayC', 100);
%     cmap2 = flip(cmap2);
    colormap(gca, cmap2)
    caxis([4 12])
    hcb2 = colorbar;
    hcb2.Position = [0.910077519379845,0.126288659793814,0.031041364269512,0.804123711340205];
    title(hcb2, 'u$_{m}$', 'Interpreter', 'Latex', 'FontSize', 15)
    hcb2.TickLabelInterpreter = 'latex';
    hcb2.TickLength = 0;
    hcb2.Label.Interpreter = 'latex';
    hcb2.AxisLocation = 'out';
    set(gca, 'TickLabelInterpreter', 'latex', 'FontSize', 14)
    xlabel('x/$\delta$', 'Interpreter', 'Latex', 'FontSize', 14);
    ylabel('z/$\delta$', 'Interpreter', 'Latex', 'FontSize', 14);
    axis equal
    xlim([0.0 0.05])
    ylim([VF_GenASL.z(1)/VF_GenASL.delta VF_GenASL.z(end)/VF_GenASL.delta])

    % Save frame at 1000 DPI as a temporary high-resolution image
    tempFileName = sprintf('temp_frame_%d.png', t);
    print(gcf, tempFileName, '-dpng', '-r400');

    % Read high-resolution frame and add it to the video
    highResFrame = imread(tempFileName);
    writeVideo(v, highResFrame);

    % Delete temporary file
    delete(tempFileName);
end

% Close video writer
close(v);


%% Pro-ret-Grade vortices Near the wall(histogram)

WT7VorX = load('G:\My Drive\Research\DATABASE\Vortex statistics\data\mesh_07ms_vortex_properties.mat');
WT7VorX_scales = load('G:\My Drive\Research\DATABASE\Vortex statistics\data\mesh_07ms_scales.mat');
R1 = corrcoef(WT7VorX.d_pro,WT7VorX.dU_pro);
%                 R2 = corrcoef(WT7VorX.d_ret,WT7VorX.dU_ret);

% Find Near-wall vortices
m = 2;
Near_wall_d_pro = WT7VorX.d_pro (WT7VorX.z_pro>=0 & WT7VorX.z_pro <= m*30*VF_GenWT7.z0);
Near_wall_dU_pro = WT7VorX.dU_pro (WT7VorX.z_pro>=0 & WT7VorX.z_pro <= m*30*VF_GenWT7.z0);
Near_wall_d_ret = WT7VorX.d_ret (WT7VorX.z_ret>=0 & WT7VorX.z_ret <= m*30*VF_GenWT7.z0);
Near_wall_dU_ret = WT7VorX.dU_ret (WT7VorX.z_ret>=0 & WT7VorX.z_ret <= m*30*VF_GenWT7.z0);

Near_wall_diffpro = abs(WT7VorX.z_pro(WT7VorX.z_pro>=0 & WT7VorX.z_pro <= m*30*VF_GenWT7.z0)...
    - WT7VorX_scales.z.');
[~, result_Near_wall_pro] = min(Near_wall_diffpro, [], 2);

Near_wall_diffret = abs(WT7VorX.z_ret(WT7VorX.z_ret>=0 & WT7VorX.z_ret <= m*30*VF_GenWT7.z0)...
    - WT7VorX_scales.z.');
[~, result_Near_wall_ret] = min(Near_wall_diffret, [], 2);

[counts_Near_wall_d_pro, edges_Near_wall_d_pro] = histcounts(0.5*Near_wall_d_pro...
    ./WT7VorX_scales.lambda(result_Near_wall_pro)...
    , 50); 
binCenters_Near_wall_d_pro = edges_Near_wall_d_pro(1:end-1) + diff(edges_Near_wall_d_pro)/2;

[counts_Near_wall_dU_pro, edges_Near_wall_dU_pro] = histcounts(-Near_wall_dU_pro...
    ./VF_GenWT7.u_tau...
    , 50); 
binCenters_Near_wall_dU_pro = edges_Near_wall_dU_pro(1:end-1) + diff(edges_Near_wall_dU_pro)/2;

[counts_Near_wall_d_ret, edges_Near_wall_ret] = histcounts(0.5*Near_wall_d_ret...
    ./WT7VorX_scales.lambda(result_Near_wall_ret)...
    , 50);
binCenters_Near_wall_d_ret = edges_Near_wall_ret(1:end-1) + diff(edges_Near_wall_ret)/2;

[counts_Near_wall_dU_ret, edges_Near_wall_dU_ret] = histcounts(Near_wall_dU_ret...
    ./VF_GenWT7.u_tau...
    , 50);
binCenters_Near_wall_dU_ret = edges_Near_wall_dU_ret(1:end-1) + diff(edges_Near_wall_dU_ret)/2;



% Find Farfrom-wall vortices

Farfrom_wall_d_pro = WT7VorX.d_pro (WT7VorX.z_pro > m*30*VF_GenWT7.z0);
Farfrom_wall_dU_pro = WT7VorX.dU_pro (WT7VorX.z_pro > m*30*VF_GenWT7.z0);
Farfrom_wall_d_ret = WT7VorX.d_ret (WT7VorX.z_ret > m*30*VF_GenWT7.z0);
Farfrom_wall_dU_ret = WT7VorX.dU_ret (WT7VorX.z_ret > m*30*VF_GenWT7.z0);

Farfrom_wall_diffpro = abs(WT7VorX.z_pro(WT7VorX.z_pro > m*30*VF_GenWT7.z0)...
    - WT7VorX_scales.z.');
[~, result_Farfrom_wall_pro] = min(Farfrom_wall_diffpro, [], 2);

Farfrom_wall_diffret = abs(WT7VorX.z_ret(WT7VorX.z_ret > m*30*VF_GenWT7.z0)...
    - WT7VorX_scales.z.');
[~, result_Farfrom_wall_ret] = min(Farfrom_wall_diffret, [], 2);


[counts_Farfrom_wall_d_pro, edges_Farfrom_wall_d_pro] = histcounts(0.5*Farfrom_wall_d_pro...
    ./WT7VorX_scales.lambda(result_Farfrom_wall_pro)...
    , 50); 
binCenters_Farfrom_wall_d_pro = edges_Farfrom_wall_d_pro(1:end-1) + diff(edges_Farfrom_wall_d_pro)/2;

[counts_Farfrom_wall_dU_pro, edges_Farfrom_wall_dU_pro] = histcounts(-Farfrom_wall_dU_pro...
    ./VF_GenWT7.u_tau...
    , 50); 
binCenters_Farfrom_wall_dU_pro = edges_Farfrom_wall_dU_pro(1:end-1) + diff(edges_Farfrom_wall_dU_pro)/2;

[counts_Farfrom_wall_d_ret, edges_Farfrom_wall_d_ret] = histcounts(0.5*Farfrom_wall_d_ret...
    ./WT7VorX_scales.lambda(result_Farfrom_wall_ret)...
    , 50);
binCenters_Farfrom_wall_d_ret = edges_Farfrom_wall_d_ret(1:end-1) + diff(edges_Farfrom_wall_d_ret)/2;

[counts_Farfrom_wall_dU_ret, edges_Farfrom_wall_dU_ret] = histcounts(Farfrom_wall_dU_ret...
    ./VF_GenWT7.u_tau...
    , 50);
binCenters_Farfrom_wall_dU_ret = edges_Farfrom_wall_dU_ret(1:end-1) + diff(edges_Farfrom_wall_dU_ret)/2;



figure
set(gcf,'Position',[696,524,768,453])
axes('Position',[0.076822916666661,0.111471667082719,0.411458333333339,0.7715305404228])
plot(binCenters_Near_wall_d_pro,counts_Near_wall_d_pro,...
    'LineStyle','none','color','b','Marker','h','markersize',7);
hold on
plot(binCenters_Farfrom_wall_d_pro,counts_Farfrom_wall_d_pro,...
    'LineStyle','none','color','b','Marker','^','markersize',7);
plot(binCenters_Near_wall_d_ret,counts_Near_wall_d_ret,...
    'LineStyle','none','color','r','Marker','*','markersize',7);
plot(binCenters_Farfrom_wall_d_ret,counts_Farfrom_wall_d_ret,...
    'LineStyle','none','color','r','Marker','O','markersize',7);
set(gca,'YScale','log','XScale','log','TickLabelInterpreter','latex','FontSize',13)
xlabel('$r_{\omega}/\lambda_{T}$','Interpreter','Latex','FontSize',14);
ylabel('Histcount','Interpreter','Latex','FontSize',14);
% legend(sprintf('PIV(m1) prograde $z/z_{0} \\le$ %.2f',m*30),...
%     sprintf('PIV(m1) prograde $z/z_{0} >$ %.2f',m*30),...
%     sprintf('PIV(m1) retrograde $z/z_{0} \\le$ %.2f',m*30),...
%     sprintf('PIV(m1) retrograde $z/z_{0} >$ %.2f',m*30),...
%     'Interpreter','latex','FontSize',9)
ylim([1e1 1e5])
xlim([0.5e-1 1e0])


axes('Position',[0.578124999999988,0.111471667082719,0.411458333333334,0.7715305404228])
plot(binCenters_Near_wall_dU_pro,counts_Near_wall_dU_pro,...
    'LineStyle','none','color','b','Marker','h','markersize',7);
hold on
plot(binCenters_Farfrom_wall_dU_pro,counts_Farfrom_wall_dU_pro,...
    'LineStyle','none','color','b','Marker','^','markersize',7);
plot(binCenters_Near_wall_dU_ret,counts_Near_wall_dU_ret,...
    'LineStyle','none','color','r','Marker','*','markersize',7);
plot(binCenters_Farfrom_wall_dU_ret,counts_Farfrom_wall_dU_ret,...
    'LineStyle','none','color','r','Marker','O','markersize',7);
set(gca,'YScale','log','TickLabelInterpreter','latex','FontSize',13)
xlabel('$u_{\omega}/u_{\tau}$','Interpreter','Latex','FontSize',14);
ylabel('Histcount','Interpreter','Latex','FontSize',14);
legend(sprintf('PIV(m1) prograde $z/z_{0} \\le$ %.2f',m*30),...
    sprintf('PIV(m1) prograde $z/z_{0} >$ %.2f',m*30),...
    sprintf('PIV(m1) retrograde $z/z_{0} \\le$ %.2f',m*30),...
    sprintf('PIV(m1) retrograde $z/z_{0} >$ %.2f',m*30),...
    'Interpreter','latex','FontSize',9,'NumColumns',2,'position',...
    [0.236356218713274,0.918395880796701,0.57918197573117,0.073509932301165])
ylim([1e1 1e5])


%% Pro-retro-Grade vortices Near the wall(p.d.f.)

WT7VorX = load('G:\My Drive\Research\DATABASE\Vortex statistics\data\mesh_07ms_vortex_properties.mat');
WT7VorX_scales = load('G:\My Drive\Research\DATABASE\Vortex statistics\data\mesh_07ms_scales.mat');
R1 = corrcoef(WT7VorX.d_pro,-WT7VorX.dU_pro);
%                 R2 = corrcoef(WT7VorX.d_ret,WT7VorX.dU_ret);

% Find Near-wall vortices
m = 2;
Near_wall_d_pro = WT7VorX.d_pro (WT7VorX.z_pro>=0 & WT7VorX.z_pro <= m*30*VF_GenWT7.z0);
Near_wall_dU_pro = WT7VorX.dU_pro (WT7VorX.z_pro>=0 & WT7VorX.z_pro <= m*30*VF_GenWT7.z0);
Near_wall_d_ret = WT7VorX.d_ret (WT7VorX.z_ret>=0 & WT7VorX.z_ret <= m*30*VF_GenWT7.z0);
Near_wall_dU_ret = WT7VorX.dU_ret (WT7VorX.z_ret>=0 & WT7VorX.z_ret <= m*30*VF_GenWT7.z0);

Near_wall_diffpro = abs(WT7VorX.z_pro(WT7VorX.z_pro>=0 & WT7VorX.z_pro <= m*30*VF_GenWT7.z0)...
    - WT7VorX_scales.z.');
[~, result_Near_wall_pro] = min(Near_wall_diffpro, [], 2);

Near_wall_diffret = abs(WT7VorX.z_ret(WT7VorX.z_ret>=0 & WT7VorX.z_ret <= m*30*VF_GenWT7.z0)...
    - WT7VorX_scales.z.');
[~, result_Near_wall_ret] = min(Near_wall_diffret, [], 2);

[pdfd_proOlam_Near_wall,d_proOlamp_Near_wall] = ksdensity(0.5*Near_wall_d_pro./...
        WT7VorX_scales.lambda(result_Near_wall_pro),...
        'NumPoints',50);
[pdfd_retOlam_Near_wall,d_retOlamp_Near_wall] = ksdensity(0.5*Near_wall_d_ret./...
        WT7VorX_scales.lambda(result_Near_wall_ret),...
        'NumPoints',50);

% [cdfd_proOlam_Near_wall,d_proOlamc_Near_wall] = ksdensity(0.5*Near_wall_d_pro./...
%         WT7VorX_scales.lambda(result_Near_wall_pro),...
%         'Function', 'cdf','NumPoints',50);
% [cdfd_retOlam_Near_wall,d_retOlamc_Near_wall] = ksdensity(0.5*Near_wall_d_ret./...
%         WT7VorX_scales.lambda(result_Near_wall_ret),...
%         'Function', 'cdf','NumPoints',50);


[pdfdU_proOutau_Near_wall,dU_proOutaup_Near_wall] = ksdensity(-Near_wall_dU_pro/VF_GenWT7.u_tau,...
        'NumPoints',50);
[pdfdU_retOutau_Near_wall,dU_retOutaup_Near_wall] = ksdensity(Near_wall_dU_ret/VF_GenWT7.u_tau,...
        'NumPoints',50);

% [cdfdU_proOutau_Near_wall,dU_proOutauc_Near_wall] = ksdensity(-2*Near_wall_dU_pro/VF_GenWT7.u_tau,...
%         'Function', 'cdf','NumPoints',50);
% [cdfdU_retOutau_Near_wall,dU_retOutauc_Near_wall] = ksdensity(2*Near_wall_dU_ret/VF_GenWT7.u_tau,...
%         'Function', 'cdf','NumPoints',50);

% Find Farfrom-wall vortices

Farfrom_wall_d_pro = WT7VorX.d_pro (WT7VorX.z_pro > m*30*VF_GenWT7.z0);
Farfrom_wall_dU_pro = WT7VorX.dU_pro (WT7VorX.z_pro > m*30*VF_GenWT7.z0);
Farfrom_wall_d_ret = WT7VorX.d_ret (WT7VorX.z_ret > m*30*VF_GenWT7.z0);
Farfrom_wall_dU_ret = WT7VorX.dU_ret (WT7VorX.z_ret > m*30*VF_GenWT7.z0);

Farfrom_wall_diffpro = abs(WT7VorX.z_pro(WT7VorX.z_pro > m*30*VF_GenWT7.z0)...
    - WT7VorX_scales.z.');
[~, result_Farfrom_wall_pro] = min(Farfrom_wall_diffpro, [], 2);

Farfrom_wall_diffret = abs(WT7VorX.z_ret(WT7VorX.z_ret > m*30*VF_GenWT7.z0)...
    - WT7VorX_scales.z.');
[~, result_Farfrom_wall_ret] = min(Farfrom_wall_diffret, [], 2);



[pdfd_proOlam_Far_wall,d_proOlamp_Far_wall] = ksdensity(0.5*Farfrom_wall_d_pro./...
        WT7VorX_scales.lambda(result_Farfrom_wall_pro),...
        'NumPoints',50);
[pdfd_retOlam_Far_wall,d_retOlamp_Far_wall] = ksdensity(0.5*Farfrom_wall_d_ret./...
        WT7VorX_scales.lambda(result_Farfrom_wall_ret),...
        'NumPoints',50);

% [cdfd_proOlam_Far_wall,d_proOlamc_Far_wall] = ksdensity(Farfrom_wall_d_pro./...
%         WT7VorX_scales.lambda(result_Farfrom_wall_pro),...
%         'Function', 'cdf','NumPoints',50);
% [cdfd_retOlam_Far_wall,d_retOlamc_Far_wall] = ksdensity(Farfrom_wall_d_ret./...
%         WT7VorX_scales.lambda(result_Farfrom_wall_ret),...
%         'Function', 'cdf','NumPoints',50);


[pdfdU_proOutau_Far_wall,dU_proOutaup_Far_wall] = ksdensity(-Farfrom_wall_dU_pro/VF_GenWT7.u_tau,...
        'NumPoints',50);
[pdfdU_retOutau_Far_wall,dU_retOutaup_Far_wall] = ksdensity(Farfrom_wall_dU_ret/VF_GenWT7.u_tau,...
        'NumPoints',50);

% [cdfdU_proOutau_Far_wall,dU_proOutauc_Far_wall] = ksdensity(-2*Farfrom_wall_dU_pro/VF_GenWT7.u_tau,...
%         'Function', 'cdf','NumPoints',50);
% [cdfdU_retOutau_Far_wall,dU_retOutauc_Far_wall] = ksdensity(2*Farfrom_wall_dU_ret/VF_GenWT7.u_tau,...
%         'Function', 'cdf','NumPoints',50);


differencespro_Near = abs(WT7VorX.z_pro(WT7VorX.z_pro>=0 & WT7VorX.z_pro <= m*30*VF_GenWT7.z0)...
    - WT7VorX_scales.z.');
[~, resultpro_Near] = min(differencespro_Near, [], 2);

data_Near = double(0.5*WT7VorX.d_pro(WT7VorX.z_pro>=0 & WT7VorX.z_pro <= m*30*VF_GenWT7.z0)...
    ./WT7VorX_scales.lambda(resultpro_Near));
data_Near = data_Near(data_Near>0.05);



% Log-Pareto PDF
log_pareto_pdf = @(x, mu, sigma, alpha, x_t) ...
    (x <= x_t) .* (1 ./ (x * sigma * sqrt(2 * pi)) .* exp(-((log(x) - mu).^2) ./ (2 * sigma^2))) + ...
    (x > x_t) .* (x_t^alpha ./ (x.^(alpha + 1)) .* ...
    (1 / (sigma * sqrt(2 * pi)) * exp(-((log(x_t) - mu)^2) / (2 * sigma^2))));

% Objective function (negative log-likelihood)
objective_log_pareto = @(params) -sum(log(log_pareto_pdf(data_Near, params(1), params(2), params(3), params(4))));

% Initial guess for parameters [mu, sigma, alpha, x_t]
initial_params = [mean(log(data_Near)), std(log(data_Near)),...
    5.5, 0.25];

% Bounds for the parameters [mu, sigma, alpha, x_t]
lb = [mean(log(data_Near)), 0.0, 5, prctile(data_Near, 75)];
ub = [0, Inf, 6, prctile(data_Near, 90)];

% Optimize using fmincon
options = optimoptions('fmincon', 'Display', 'iter', 'Algorithm', 'interior-point');
[opt_params, ~] = fmincon(objective_log_pareto, initial_params, [], [], [], [], lb, ub, [], options);

% Extract optimized parameters
mu_opt_Near = opt_params(1);
sigma_opt_Near = opt_params(2);
alpha_opt_Near = opt_params(3);
x_t_opt_Near = opt_params(4);

% Display the results
%             disp(['Optimized mu: ', num2str(mu_opt)]);
%             disp(['Optimized sigma: ', num2str(sigma_opt)]);
%             disp(['Optimized alpha: ', num2str(alpha_opt)]);
%             disp(['Optimized x_t: ', num2str(x_t_opt)]);

x_values_Near = linspace(min(data_Near), max(data_Near), 100);
fitted_pdf_Near = log_pareto_pdf(x_values_Near, mu_opt_Near, sigma_opt_Near,...
    alpha_opt_Near,x_t_opt_Near);





differencespro_Far = abs(WT7VorX.z_pro(WT7VorX.z_pro > m*30*VF_GenWT7.z0)...
    - WT7VorX_scales.z.');
[~, resultpro_Far] = min(differencespro_Far, [], 2);

data_Far = double(0.5*WT7VorX.d_pro(WT7VorX.z_pro > m*30*VF_GenWT7.z0)...
    ./WT7VorX_scales.lambda(resultpro_Far));
data_Far = data_Far(data_Far>0.05);


% Objective function (negative log-likelihood)
objective_log_pareto = @(params) -sum(log(log_pareto_pdf(data_Far, params(1), params(2), params(3), params(4))));

% Initial guess for parameters [mu, sigma, alpha, x_t]
initial_params = [mean(log(data_Far)), std(log(data_Far)),...
    5.5, 0.25];

% Bounds for the parameters [mu, sigma, alpha, x_t]
lb = [mean(log(data_Far)), 0.0, 4.5, prctile(data_Far, 75)];
ub = [0, Inf, 6, prctile(data_Far, 90)];

% Optimize using fmincon
options = optimoptions('fmincon', 'Display', 'iter', 'Algorithm', 'interior-point');
[opt_params, ~] = fmincon(objective_log_pareto, initial_params, [], [], [], [], lb, ub, [], options);

% Extract optimized parameters
mu_opt_Far = opt_params(1);
sigma_opt_Far = opt_params(2);
alpha_opt_Far = opt_params(3);
x_t_opt_Far = opt_params(4);

% Display the results
%             disp(['Optimized mu: ', num2str(mu_opt)]);
%             disp(['Optimized sigma: ', num2str(sigma_opt)]);
%             disp(['Optimized alpha: ', num2str(alpha_opt)]);
%             disp(['Optimized x_t: ', num2str(x_t_opt)]);

x_values_Far = linspace(min(data_Far), max(data_Far), 100);
fitted_pdf_Far = log_pareto_pdf(x_values_Far, mu_opt_Far, sigma_opt_Far,...
    alpha_opt_Far,x_t_opt_Far);


    
k1 = 0.5;
C1 = trapz((0.5:0.1:4.5),exp(-(0.5:0.1:4.5)./(k1)));
k2 = 0.37;
C2 = trapz((0.5:0.1:4.5),exp(-(0.5:0.1:4.5)./(k2)));
figure
subplot(1,2,1)
plot(dU_proOutaup_Near_wall,pdfdU_proOutau_Near_wall,...
    'LineStyle','none','color','b','Marker','^');
hold on
plot(dU_retOutaup_Near_wall,pdfdU_retOutau_Near_wall,...
    'LineStyle','none','color','r','Marker','*');
semilogy((0.5:0.1:4.5),1/C1*exp(-(0.5:0.1:4.5)./(k1)),'k','LineWidth',1.5)
set(gca,'YScale','log','TickLabelInterpreter','latex','FontSize',13)
xlabel('$u_{\omega}/u_{\tau}$','Interpreter','Latex','FontSize',14);
ylabel('p.d.f.','Interpreter','Latex','FontSize',14);
legend('Near wall Prograge','Near wall Retrograde','Gen','Interpreter','latex','FontSize',9)
ylim([1e-5 1e1])
subplot(1,2,2)
plot(dU_proOutaup_Far_wall,pdfdU_proOutau_Far_wall,...
    'LineStyle','none','color','b','Marker','^');
hold on
plot(dU_retOutaup_Far_wall,pdfdU_retOutau_Far_wall,...
    'LineStyle','none','color','r','Marker','*');
semilogy((0.5:0.1:4.5),1/C2*exp(-(0.5:0.1:4.5)./(k2)),'k','LineWidth',1.5)
set(gca,'YScale','log','TickLabelInterpreter','latex','FontSize',13)
xlabel('$u_{\omega}/u_{\tau}$','Interpreter','Latex','FontSize',14);
ylabel('p.d.f.','Interpreter','Latex','FontSize',14);
legend('Far wall Prograge','Far wall Retrograde','Gen','Interpreter','latex','FontSize',9)
ylim([1e-5 1e1])

figure
subplot(1,2,1)
plot(d_proOlamp_Near_wall,pdfd_proOlam_Near_wall,...
    'LineStyle','none','color','b','Marker','^');
hold on
plot(d_retOlamp_Near_wall,pdfd_retOlam_Near_wall,...
    'LineStyle','none','color','r','Marker','*');
loglog(x_values_Near,fitted_pdf_Near,'k','LineWidth',1.5)
set(gca,'Xscale','log','YScale','log','TickLabelInterpreter','latex','FontSize',13)
xlabel('$r_{\omega}/\lambda_{T}$','Interpreter','Latex','FontSize',14);
ylabel('p.d.f.','Interpreter','Latex','FontSize',14);
legend('Near wall Prograge','Near wall Retrograde','Gen','Interpreter','latex','FontSize',9)
ylim([1e-5 1e1])

subplot(1,2,2)
plot(d_proOlamp_Far_wall,pdfd_proOlam_Far_wall,...
    'LineStyle','none','color','b','Marker','^');
hold on
plot(d_retOlamp_Far_wall,pdfd_retOlam_Far_wall,...
    'LineStyle','none','color','r','Marker','*');
loglog(x_values_Far,fitted_pdf_Far,'k','LineWidth',1.5)
set(gca,'Xscale','log','YScale','log','TickLabelInterpreter','latex','FontSize',13)
xlabel('$r_{\omega}/\lambda_{T}$','Interpreter','Latex','FontSize',14);
ylabel('p.d.f.','Interpreter','Latex','FontSize',14);
legend('Far wall Prograge','Far wall Retrograde','Gen','Interpreter','latex','FontSize',9)
ylim([1e-5 1e1])